"use strict";!function(){var ge="undefined"!=typeof chrome&&chrome||{},v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B="BCDFGHJKLMNPQRSTVWXZbcdfghjklmnpqrstvwxz",fe="thread-",Ae="msg-",ve="thread-msg-";function Be(e){if(/^\s*$/.test(e))return e;e=e.replace(fe,"");var a=btoa(e).replace(/=/g,""),n=v,c=B;if(!c)throw new Error("rd");for(var i=n.length,t=c.length,l=!0,o=0;o<a.length;o++)if(a.charAt(o)!==n.charAt(0)){l=!1;break}if(l)return c.charAt(0);var r={};for(o=0;o<i;o++)r[n.charAt(o)]=o;var s=[];for(o=a.length-1;0<=o;o--){var d=a.charAt(o);if(void 0===r[d])throw new Error("sd`"+a+"`"+n+"`"+d);s.push(r[d])}var m=[];for(o=s.length-1;0<=o;o--){for(var _=0,u=0;u<m.length;u++){var b,p=m[u]*i+_;t<=p?(_=(p-(b=p%t))/t,p=b):_=0,m[u]=p}for(;_;){var h=_%t;m.push(h),_=(_-h)/t}for(_=s[o],u=0;_;u++){m.length<=u&&m.push(0);var j,g=m[u]+_;t<=g?(_=(g-(j=g%t))/t,g=j):_=0,m[u]=g}}var f=[];for(o=m.length-1;0<=o;o--){var A=m[o];if(A>=c.length||A<0)throw new Error("td`"+m+"`"+A);f.push(c.charAt(A))}return f.join("")}cjce.registerTemplate("bm-p-mail",function(i,d){i.classList.add("bm-p-mail");var c,a,n,t,l,o,r,s,P,m,_,u,b,p,h,j,g,f="inbox"===(d.instanceParameters.productId||"mail"),x=(cjce.applyTemplate(i,"bm-loading"),f&&i.classList.add("bm-p-mail--bigtop"),i.classList.add("bm-p-mail--inboxview"),["https://www.googleapis.com/auth/gmail.labels"]),H="https://content.googleapis.com/gmail/v1/",O="https://accounts.google.com",A="https://mail.google.com",v=A+"/mail/",B=v+"u/"+d.account.authuser+"/",D=v+"mu/mp/",I=B+"#",F=I+"label/",W=f?"inbox":"gmail",q=f?cjBasics.lang.i18n("cj_i18n_00421","Inbox"):cjBasics.lang.i18n("cj_i18n_00416","Gmail"),S=d.darkMode?"#669df6":"#1a73e8",X="bm_cache_v33__mail__sessionid",T=f?"tl/priority/":"",z="INBOX",N=!1,y=!1,G=["SMARTLABEL_TRAVEL","SV_I","SMARTLABEL_RECEIPT","SMARTLABEL_FINANCE","SMARTLABEL_SOCIAL","SMARTLABEL_PURE_NOTIF","SMARTLABEL_GROUP","SMARTLABEL_PROMO","IO_UNIM"],V=G.concat(["SNOOZED","DONE","REMINDERS","CHAT","ALL"]),Z=f?["INBOX","SNOOZED","DONE","DRAFT","SENT","REMINDERS","TRASH","SPAM"]:["INBOX","STARRED","SNOOZED","IMPORTANT","CHAT","SENT","DRAFT","ALL","SPAM","TRASH"],e='div[style*="translate3d"] div[role="button"]',E=d.darkMode?"dark":"light",L="bm_mail_"+(f?"bigtop":"gmail")+"__theme_"+E+"__"+d.account.authuser+"_"+window.btoa(d.account.obfuscatedId).replace(/=+/,""),J="GMAIL_AT",w="",E=v+"mu/*mui="+L+"*",K=["^smartlabel_personal","^smartlabel_social","^smartlabel_promo","^smartlabel_notification","^smartlabel_group"],Q={"^smartlabel_personal":{label:cjBasics.lang.i18n("cj_i18n_00178","Primary"),color:"#ea4335"},"^smartlabel_social":{label:cjBasics.lang.i18n("cj_i18n_00312","Social"),color:"#4285f4"},"^smartlabel_promo":{label:cjBasics.lang.i18n("cj_i18n_00315","Promos"),color:"#1e8e3e"},"^smartlabel_notification":{label:cjBasics.lang.i18n("cj_i18n_00313","Updates"),color:"#fa7b17"},"^smartlabel_group":{label:cjBasics.lang.i18n("cj_i18n_00182","Forums"),color:"#a142f4"},"^io_im,PI":{label:cjBasics.lang.i18n("cj_i18n_00184","Important")},"^u,PI":{label:cjBasics.lang.i18n("cj_i18n_01559","Unread")},"^t,PI":{label:cjBasics.lang.i18n("cj_i18n_00004","Starred")},"^io_im,^u,PI":{label:cjBasics.lang.i18n("cj_i18n_01560","Important & unread")},"^all,^f,PI":{label:cjBasics.lang.i18n("cj_i18n_00303","Sent")},"^all,^r,PI":{label:cjBasics.lang.i18n("cj_i18n_00187","Drafts")},",PI":{label:cjBasics.lang.i18n("cj_i18n_00331","Everything")}},Y={"^all":"ALL","^f":"SENT","^i":"INBOX","^io_im":"IMPORTANT","^k":"TRASH","^r":"DRAFT","^s":"SPAM","^t":"STARRED"},k={INBOX:{label:cjBasics.lang.i18n("cj_i18n_00299","Inbox"),newTabUrl:I,superpuduHash:f?"tl/priority/":"tl/please_redirect_me_google",iconName:"__mdi:inbox",color:S,colorIcon:f},PINNED:{superpuduHash:"tl/search/label%3Apinned",color:S},STARRED:{label:cjBasics.lang.i18n("cj_i18n_00004","Starred"),newTabUrl:I+"starred",superpuduHash:"tl/Starred",iconName:"__mdi:star_outline"},SNOOZED:{label:cjBasics.lang.i18n("cj_i18n_00300","Snoozed"),newTabUrl:I+"snoozed",superpuduHash:"tl/search/in%3Asnoozed",iconName:f?"__mdi:schedule":"__mdi:watch_later",color:f?"#ef6c00":S,colorIcon:f},DONE:{label:cjBasics.lang.i18n("cj_i18n_00301","Done"),newTabUrl:I+"done",superpuduHash:"tl/search/label%3Adone",iconName:"__mdi:bigtop_done",color:"#34a853",colorIcon:!0,divider:f},IMPORTANT:{label:cjBasics.lang.i18n("cj_i18n_00184","Important"),newTabUrl:I+"imp",superpuduHash:"tl/Important",iconName:"__mdi:label_important_outline",color:S},CHAT:{label:cjBasics.lang.i18n("cj_i18n_00185","Chats"),newTabUrl:I+"chats",superpuduHash:"tl/Chats",iconName:"__mdi:--hangout",color:S},SENT:{label:cjBasics.lang.i18n("cj_i18n_00303","Sent"),newTabUrl:I+"sent",superpuduHash:"tl/Sent%20Mail",iconName:"__mdi:send",color:S},REMINDERS:{label:cjBasics.lang.i18n("cj_i18n_00081","Reminders"),newTabUrl:I+"reminders",superpuduHash:"tl/Reminders",iconName:"__mdi:reminder",color:S},DRAFT:{label:cjBasics.lang.i18n("cj_i18n_00187","Drafts"),newTabUrl:I+"drafts",superpuduHash:"tl/Drafts",iconName:f?"__mdi:drafts":"__mdi:insert_drive_file",color:S},ALL:{label:cjBasics.lang.i18n("cj_i18n_00188","All mail"),newTabUrl:I+"all",superpuduHash:"tl/All%20Mail",iconName:"__mdi:stacked_email",color:S},SPAM:{label:cjBasics.lang.i18n("cj_i18n_00306","Spam"),newTabUrl:I+"spam",superpuduHash:"tl/Spam",iconName:"__mdi:report",divider:f,color:S},TRASH:{label:cjBasics.lang.i18n("cj_i18n_00005","Bin"),newTabUrl:I+"trash",superpuduHash:"tl/Trash",iconName:"__mdi:delete",color:S},SMARTLABEL_TRAVEL:{label:cjBasics.lang.i18n("cj_i18n_00308","Travel"),iconName:"__mdi:travel",newTabUrl:I+"trips",superpuduHash:"tl/search/category%3Atravel",color:"#9c27b0",colorIcon:!0},SV_I:{label:cjBasics.lang.i18n("cj_i18n_00309","Saved"),iconName:"__mdi:bookmark_border",superpuduHash:"tl/search/label%3Asaved",color:"#4285f4",colorIcon:!0},SMARTLABEL_RECEIPT:{label:cjBasics.lang.i18n("cj_i18n_00310","Purchases"),iconName:"__mdi:shopping_cart",superpuduHash:"tl/search/category%3Apurchases",color:"#795548",colorIcon:!0},SMARTLABEL_FINANCE:{label:cjBasics.lang.i18n("cj_i18n_00311","Finance"),iconName:"__mdi:trending_up",gmailPath:"search/category%3Afinance",superpuduHash:"tl/search/category%3Afinance",color:"#689f38",colorIcon:!0},SMARTLABEL_SOCIAL:{label:cjBasics.lang.i18n("cj_i18n_00312","Social"),iconName:"__mdi:people",superpuduHash:"tl/search/category%3Asocial",color:"#ea4335",colorIcon:!0},SMARTLABEL_PURE_NOTIF:{label:cjBasics.lang.i18n("cj_i18n_00313","Updates"),iconName:"__mdi:flag",superpuduHash:"tl/search/category%3Aupdates",color:"#ff6839",colorIcon:!0},SMARTLABEL_GROUP:{label:cjBasics.lang.i18n("cj_i18n_00182","Forums"),iconName:"__mdi:question_answer",superpuduHash:"tl/search/category%3Aforums",color:"#3f51b5",colorIcon:!0},SMARTLABEL_PROMO:{label:cjBasics.lang.i18n("cj_i18n_00315","Promos"),iconName:"__mdi:local_offer",superpuduHash:"tl/search/category%3Apromotions",color:"#00bcd4",colorIcon:!0},IO_UNIM:{label:cjBasics.lang.i18n("cj_i18n_00316","Low Priority"),iconName:"__mdi:low_priority",superpuduHash:"tl/search/label%3Alowpriority"}},$={apply:cjBasics.lang.i18n("cj_i18n_01567","Apply"),archive:f?cjBasics.lang.i18n("cj_i18n_01734","Mark done"):cjBasics.lang.i18n("cj_i18n_01579","Archive"),delete:cjBasics.lang.i18n("cj_i18n_01563","Delete"),deleteForever:cjBasics.lang.i18n("cj_i18n_01577","Delete forever"),label:cjBasics.lang.i18n("cj_i18n_01571","Label…"),markUnread:cjBasics.lang.i18n("cj_i18n_01573","Mark as unread"),more:cjBasics.lang.i18n("cj_i18n_00047","More"),move:cjBasics.lang.i18n("cj_i18n_01570","Move…"),moveToInbox:cjBasics.lang.i18n("cj_i18n_01575","Move to inbox"),notSpam:cjBasics.lang.i18n("cj_i18n_01576","Not spam"),reportSpam:cjBasics.lang.i18n("cj_i18n_01572","Report spam"),openInNew:cjBasics.lang.i18n("cj_i18n_01545","Open in a new tab"),send:cjBasics.lang.i18n("cj_i18n_01565","Send")},ee={archive:f?"__mdi:bigtop_done":"__mdi:archive",openInNew:"__mdi:open_in_new",delete:"__mdi:delete",deleteForever:"__mdi:delete_forever",label:"__mdi:label",markUnread:"__mdi:email",more:"__mdi:more_vert",move:"__mdi:drive_file_move",moveToInbox:"__mdi:move_to_inbox",notSpam:"__mdi:report_off",reportSpam:"__mdi:report",send:"__mdi:send"};function ae(){var e=T.split("/"),e=e[e.length-1],e=cjBasics.numbers.hex2dec(e),e=(a=[],(e={threadId:e,messageId:e}).threadId&&a.push(fe+"f:"+e.threadId),e.messageId&&a.push(Ae+"f:"+e.messageId),e.mergeId&&a.push(ve+"f:"+e.mergeId),Be(a.join("|"))),a="all",a=(T.startsWith("cv/Draft")?a="drafts":T.startsWith("cv/Trash")?a="trash":T.startsWith("cv/Spam")&&(a="spam"),I+a+"/"+e);d.openTab(a)}function ne(){d.openTab(B+"?view=cm&fs=1&tf=1")}var R=null,ce={ad:{onBackAction:['#adstopbar [role="button"]'],label:cjBasics.lang.i18n("cj_i18n_01564","Ad"),mainActions:[["button","delete",['#adstopbar [role="button"]',1]]]},co:{onBackAction:['#cvtbt [role="button"]'],label:cjBasics.lang.i18n("cj_i18n_00317","Compose"),mainActions:[["fillbutton","send",['#cvtbt [role="button"]',1]]]},"lb-label":{onBackAction:['#lbttb [role="button"]'],label:cjBasics.lang.i18n("cj_i18n_01566","Label"),mainActions:[["fillbutton","apply",['#lbttb [role="button"]',1]]]},"lb-move":{onBackAction:['#lbttb [role="button"]'],label:cjBasics.lang.i18n("cj_i18n_01568","Move")},cv:{onBackAction:['#cv__cntbt [role="button"]'],label:cjBasics.lang.i18n("cj_i18n_01569","Thread"),mainActions:[["iconbutton","archive",[e]],["iconbutton","delete",[e,1]],["iconbutton","openInNew",ae]],secondaryActions:{move:[e,3,2],label:[e,4,2],reportSpam:[e,6,2],markUnread:[e,8,2]}},"cv-draft":{onBackAction:['#cv__cntbt [role="button"]'],label:cjBasics.lang.i18n("cj_i18n_01574","Draft"),mainActions:[["iconbutton","archive",[e]],["iconbutton","delete",[e,1]],["iconbutton","openInNew",ae]],secondaryActions:{moveToInbox:[e,3,2],label:[e,4,2],markUnread:[e,6,2]}},"cv-spam":{onBackAction:['#cv__cntbt [role="button"]'],label:cjBasics.lang.i18n("cj_i18n_01569","Thread"),mainActions:[["button","notSpam",[e]],["iconbutton","openInNew",ae]],secondaryActions:{deleteForever:[e,2,1],label:[e,3,1],markUnread:[e,5,1]}},"cv-trash":{onBackAction:['#cv__cntbt [role="button"]'],label:cjBasics.lang.i18n("cj_i18n_01569","Thread"),mainActions:[["button","deleteForever",[e]],["iconbutton","openInNew",ae]],secondaryActions:{moveToInbox:[e,2,1],label:[e,3,1],reportSpam:[e,4,1],markUnread:[e,6,1]}},"tl-selection":{onBackAction:[e,-1],label:cjBasics.lang.i18n("cj_i18n_01578","Selection"),mainActions:[["iconbutton","archive",[e]],["iconbutton","delete",[e,1]]],secondaryActions:{move:[e,3,2],label:[e,4,2],reportSpam:[e,6,2],markUnread:[e,7,2]}},"tl-selection-all":{onBackAction:[e,-1],label:cjBasics.lang.i18n("cj_i18n_01578","Selection"),mainActions:[["button","moveToInbox",[e]]],secondaryActions:{archive:[e,2,1],delete:[e,3,1],label:[e,4,1],reportSpam:[e,5,1],markUnread:[e,6,1]}},"tl-selection-draft":{onBackAction:[e,-1],label:cjBasics.lang.i18n("cj_i18n_01578","Selection"),mainActions:[["iconbutton","archive",[e,0]],["iconbutton","delete",[e,1]]],secondaryActions:{moveToInbox:[e,3,2],label:[e,4,2],markUnread:[e,5,2]}},"tl-selection-spam":{onBackAction:[e,-1],label:cjBasics.lang.i18n("cj_i18n_01578","Selection"),mainActions:[["button","notSpam",[e]]],secondaryActions:{deleteForever:[e,2,1],label:[e,3,1],markUnread:[e,4,1]}},"tl-selection-trash":{onBackAction:[e,-1],label:cjBasics.lang.i18n("cj_i18n_01578","Selection"),mainActions:[["button","deleteForever",[e]]],secondaryActions:{moveToInbox:[e,2,1],label:[e,3,1],reportSpam:[e,4,1],markUnread:[e,5,1]}}};function ie(a){var e=a.onBack,l=(Array.isArray(a.onBackAction)&&(e=function(){he(a.onBackAction)}),cjce.createElement("bm-ogb",{displayBack:!0,floating:!0,serviceLabel:q,pageLabel:a.label,onBack:e}));if(Array.isArray(a.mainActions)&&a.mainActions.forEach(function(e){a=e[0],n=e[1],c=e[2],e=ee[n],i={label:$[n],onClick:function(e){"move"===n?y=!0:"label"===n&&(y=!1),"function"==typeof c?c(e):he(c)}},t="ccbm-button","iconbutton"===a?(t="ccbm-iconbutton",i.iconName=e):(i.color=!0,i.outline="fillbutton"!==a,i.fill="fillbutton"===a);var a,n,c,i,t,e=cjce.createElement(t,i);l.cjceAppendChild(e)}),a.secondaryActions){var n,c={};for(n in a.secondaryActions)Array.isArray(a.secondaryActions[n])&&(c[n]={label:$[n],iconName:ee[n]});e=cjce.createElement("ccbm-iconbuttonmenu",{open:"end",label:cjBasics.lang.i18n("cj_i18n_06294","More actions"),items:c,onClick:function(e){"move"===e?y=!0:"label"===e&&(y=!1),he(a.secondaryActions[e])}});l.cjceAppendChild(e)}return a.additionalFragment&&l.cjceAppendChild(a.additionalFragment),l}function C(e){R&&ce[R]&&ce[R].toolbar&&(ce[R].toolbar.hidden=!0),(R=e)&&((e=ce[e]).toolbar?e.toolbar.hidden=!1:(e.toolbar=ie(e),i.appendChild(e.toolbar)))}function te(){var e=T.startsWith("tl")&&!c,a=!T||e&&("tl/"===T||"tl/Inbox"===T||T.startsWith("tl/priority")||"tl/search/label%3Apinned"===T);i.classList.toggle("bm-p-mail--inboxview",a),T.startsWith("mn")?(U("tl"),C()):T.startsWith("er")||T.startsWith("pr")?(C(),U("tl")):T.startsWith("co")?C("co"):T.startsWith("ad")?C("ad"):T.startsWith("cv/Draft")?C("cv-draft"):T.startsWith("cv/Spam")?C("cv-spam"):T.startsWith("cv/Trash")?C("cv-trash"):T.startsWith("cv")?C("cv"):T.startsWith("lb")?C(y?"lb-move":"lb-label"):C(),n&&(n.hidden=!e)}function le(e,a){a=a||{},a.prettyPrint="false",e=cjBasics.urlParams.attach(H+"users/me/"+e,a);return cjgApis.request(e,{fetchAs:"json"},{account:d.account,requiredScopes:x})}function oe(e){return-1===V.indexOf(e.id)}function re(){return le("labels",{fields:"labels(id,name,type)"}).then(function(e){var a=e&&e.labels||[],e=a.filter(oe).map(function(a){return le("labels/"+a.id,{fields:"threadsUnread"}).then(function(e){return e&&e.threadsUnread||null},function(){return null}).then(function(e){a.unreadCount=e})});return Promise.all(e).then(function(){return cjgApis.cache.setItem(d.account,"bm_cache_v33__mail__apilabels",a),a})},function(e){if(e&&"not_authorized"===e.cjg_error)return"not_authorized"})}function se(e,n){e.forEach(function(e){var a=k[e];a.id=e,n.push(a)})}function de(){var e=cjgShortcuts.getUrl("1188",d.account);d.openTab(e)}function me(c){var e="not_authorized"!==c,a=c,n=[];if(se(Z,n),Array.isArray(a)){n.forEach(function(e){for(var a=0;a<c.length;a++)if(c[a].id===e.id){var n="string"!=typeof(n=c[a].unreadCount)&&"number"!=typeof n||"0"===n.toString()?null:n;n&&(e.infoSuffix=n);break}});for(var i=[],t=f?"__mdi:stacked_email":"__mdi:label",l=(a.forEach(function(e){var a,n;"system"!==e.type&&(a=!f&&e.color&&e.color.backgroundColor,k.TRASH.divider=!f,n=e.name,i.push({id:e.id,theme:"solid",newTabUrl:f?null:F+n,label:n,iconName:t,infoSuffix:e.infoSuffix,color:a,colorIcon:Boolean(a),superpuduHash:"tl/"+n.toLowerCase().replace(/ |\//g,"-")}))}),i.sort(function(e,a){return e.label>a.label?1:-1}),"///////////"),o=0;o<i.length;o++){var r=i[o],s=r.label;s.startsWith(l)?(r.label=s.replace(l,""),r.indent=!0):l=s+"/"}0<i.length&&n.push({header:!0,color:!0,label:cjBasics.lang.i18n("cj_i18n_06318","Labels")}),n=n.concat(i)}return e||(k[f?"IO_UNIM":"TRASH"].divider=!0),f&&se(G,n),n[n.length-1].divider=!0,n.push({header:!0,color:!0,label:cjBasics.lang.i18n("cj_i18n_01539","Related apps")},{id:"tasks",iconName:"__mdi:tasks",label:cjBasics.lang.i18n("cj_i18n_00439","Tasks"),shortcutId:"140",external:!d.servicesDatabase.tasks},{id:"chat",iconName:"__mdi:chat_bubble_outline",label:cjBasics.lang.i18n("cj_i18n_00819","Chat"),shortcutId:"559",external:!d.servicesDatabase.chat},{id:"meet",iconName:"__mdi:meet",label:cjBasics.lang.i18n("cj_i18n_00809","Meet"),shortcutId:"545",external:!d.servicesDatabase.meet,additionalFragment:cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:video_call",label:cjBasics.lang.i18n("cj_i18n_06916","New meeting"),onClick:de})}),{labels:n,authorized:e}}function _e(e){return cjce.createElement("bm-navlist",{compact:!0,isSelector:!0,selectedId:z,items:e,onChange:function(e,a){"chat"===e||"meet"===e||"tasks"===e?(d.pageManager.navigate(e),o.cjceSelectedId=z):("REMINDERS"===(z=e)?u?u.hidden=!1:((u=cjce.createElement("cjmd-container")).classList.add("bm-p-mail-sheet","bm-p-mail-reminders"),cjce.applyTemplate(s,"bm-loadingbar"),i.appendChild(u),d.requirePage("reminderswithgapi").then(function(){var e=cjce.createElement("bm-p-reminderswithgapi__reminderslist",{bmApis:d,onLoadChange:function(e){s.cjceSetLoading(e)}});u.appendChild(e)})):(U(a.superpuduHash),u&&(u.hidden=!0)),s.cjceSetPageLabel(a.label),"INBOX"!==e&&i.classList.remove("bm-p-mail--inboxview"),f?(r.style.color=a.colorIcon?a.color:"",P.cjceChecked=!1):m&&(m.cjceSelectedId=p,h=p,be()),"INBOX"===e&&i.classList.add("bm-p-mail--inboxview"))},onNewTab:function(e,a){a=a.newTabUrl||cjgShortcuts.getUrl(a.shortcutId,d.account);d.openTab(a)}})}function ue(e){return"tl/priority/"+encodeURIComponent(e.replace(",PI",""))}function be(){var e=h&&a[h];e&&(e=e.color,m.style.setProperty("--ccc-accent-color",e))}function pe(e){!f&&_&&(e.length<2?(_.hidden=!0,_.textContent=""):(p=e[0],k.INBOX.superpuduHash=ue(p),a={},e.forEach(function(e){a[e]=Q[e]}),m=cjce.createElement("ccbm-tabs",{color:S,items:a,onChange:function(e){h=e,be(),U(ue(e))},selectedId:h||p}),_.textContent="",1<e.length&&(_.hidden=!1),_.appendChild(m),be()))}function M(e,a){var n,c,e=me(e);JSON.stringify(j)!==JSON.stringify(e.labels)&&(j=e.labels,n=l.contains(document.activeElement)&&l.classList.contains("cjmd-sheet--open"),c=o,o=_e(e.labels),cjce.replaceChild(l,o,c),n&&l.cjceToggleState(!0),a)&&!e.authorized&&(c=cjce.createElement("bm-inlinepermission",{description:cjBasics.lang.i18n("cj_i18n_01155","To list your labels and give you unread counts, please grant read-only access to your labels and unread count"),onClick:function(){cjgApis.auth.requestPermissions(d.account,x)}}),l.appendChild(c))}function U(e){t.src=g.split("#")[0]+"#"+e,T=e,te()}function he(e){t.cjceSendFrameCommand({method:"mailClickEle",value:e},A)}s=cjce.createElement("bm-ogb",{drawer:{color:"#212121"},serviceIcon:W,serviceLabel:q,pageLabel:cjBasics.lang.i18n("cj_i18n_00299","Inbox"),searchbox:{onClear:function(){c="",n.hidden=!1,i.classList.add("bm-p-mail--inboxview"),he(['#tltbt [role="button"]'])},onSubmit:function(e){c=e,u&&(u.hidden=!0),n.hidden=!0,i.classList.remove("bm-p-mail--inboxview"),U("tl/search/"+e)}},bmApis:d,onNewTab:function(){var a,n;c?d.openTab(I+"search/"+c):(a=!1,n=o&&o.cjceSelectedId,j&&n&&j.forEach(function(e){e.id===n&&(d.openTab(e.newTabUrl),a=!0)}),a||d.openTab(I))}}),i.appendChild(s),f?((je=cjce.createElement("ccbm-switch",{compact:!0,icon:"__mdi:push_pin",label:cjBasics.lang.i18n("cj_i18n_01580","Pinned"),onChange:function(){var e=je.cjceChecked;s.cjceSetPageLabel(e?cjBasics.lang.i18n("cj_i18n_01580","Pinned"):cjBasics.lang.i18n("cj_i18n_00299","Inbox")),U(k[e?"PINNED":"INBOX"].superpuduHash)}})).classList.add("bm-p-mail-pintoggle"),P=je,s.cjceAppendChild(P)):((_=cjce.createElement("cjmd-appbar",{secondary:!0})).classList.add("bm-p-mail-prioritytabs"),s.appendChild(_)),r=s.querySelector(".cjmd-navigator"),f&&r&&(r.style.color=S),(l=s.cjceDrawerEl).classList.add("bm-p-mail-drawer"),M([]),(e=s.cjceSearchboxEl).classList.add("bm-p-mail-searchbox"),d.setOnPageDisplayHandler(e.select),cjBasics.webRequest.handleIframeHeaders([E],{handleFirefoxInject:!0,handleSwCache:!0,useMobileUserAgent:!1}),cjBasics.webRequest.handleIframeHeaders([O+"/*"+E,O+"/*"+encodeURIComponent(E)]),ge.cookies.get({url:B,name:J},function(e){e&&!w&&(w=e.value)}),cjBasics.webRequest.addListener("onBeforeSendHeaders",function(e){for(var a=e.requestHeaders,n=0;n<a.length;n++){var c=a[n];if("cookie"===c.name.toLowerCase()){c=c.value;-1!==c.indexOf(J)&&(w=c.split(J+"=")[1].split(";")[0]);break}}},{urls:[A+"/*/s*at=*"],types:["xmlhttprequest"]},["requestHeaders","extraHeaders"]),cjBasics.webRequest.addListener("onBeforeRequest",function(e){return{redirectUrl:e.url.replace("at="+L,"at="+w).replace(v,B)}},{urls:[A+"/*/s*at="+L+"*"],types:["xmlhttprequest"]},["blocking"]),cjBasics.webRequest.addListener("onBeforeRequest",function(e){return{redirectUrl:e.url.replace("at="+L,"at="+w)}},{urls:[A+"/*/photos*at="+L+"*"],types:["image"]},["blocking"]),cjgApis.cache.getItem(d.account,X).then(function(e){var a=D+(e?e+"/":"");e&&ge.cookies.get({url:a,name:J},function(e){e&&(w=e.value)}),g=cjBasics.urlParams.attach(a,{mui:L,hl:"en",authuser:d.account.authuser}),t=cjce.createElement("bm-iframe",{sandbox:"allow-scripts allow-same-origin allow-popups",src:g+"#"+T,solid:!0,shadow:!0,onLoad:function(){i.cjceSetLoading(!1)},onMessage:function(e){var a,n,c=e.bm_method,e=e.bm_value;"mailContentBlocking"===c?cjBasics.navigator.firefox&&(b?b.hidden=!1:((b=cjce.createElement("cjmd-container")).classList.add("bm-p-mail-sheet","bm-p-mail-contentblocking"),n=cjce.createElement("bm-app",{pageId:"pagestateupdate",pageParameters:{contentBlocking:"gmail"},bmApis:d}),b.appendChild(n),i.appendChild(b))):"mailCachedLabels"===c?Array.isArray(e)&&2<e.length&&(n=function(e){for(var a=[],n=[],c={priority:a,other:n},i=!1,t=0;t<e.length;t++){var l=e[t],o=l.id,o=((i="^all"===o?!0:i)?(n.push(l),o.startsWith("^")&&(l.type="system")):o in Q&&a.push(o),Y[l.id]);o&&(l.id=o)}return cjgApis.cache.setItem(d.account,"bm_cache_v33__mail__sqllabels2",c),c}(e),N=!0,pe(n.priority),M(n.other)):"mailHashChange"===c?(T=e,te()):"mailPageUrl"===c?g=e:"mailSessionId"===c?e&&(cjgApis.cache.setItem(d.account,X,e),a=D+e+"/",cjBasics.webRequest.addListener("onBeforeRequest",function(e){return{redirectUrl:e.url.replace(a,B+"s/")}},{urls:[a+"?view=att&*"],types:["image"]},["blocking"])):"mailSelectionState"===c&&(e?T.startsWith("tl/Draft")?C("tl-selection-draft"):T.startsWith("tl/Spam")?C("tl-selection-spam"):T.startsWith("tl/Trash")?C("tl-selection-trash"):T.startsWith("tl/All")?C("tl-selection-all"):T.startsWith("tl")&&C("tl-selection"):C())}}),i.appendChild(t)});var je,e=[cjce.createElement("gmd-fab",{label:cjBasics.lang.i18n("cj_i18n_00317","Compose"),onClick:function(){U("co")},onMetaClick:ne}),cjce.createElement("ccbm-fab",{mini:!0,color:S,iconName:"__mdi:create",label:cjBasics.lang.i18n("cj_i18n_06325","Compose in new tab"),onClick:ne})];f||e.push(cjce.createElement("ccbm-fab",{mini:!0,color:"#00897b",iconName:"__mdi:video_call",label:cjBasics.lang.i18n("cj_i18n_06916","New meeting"),onClick:de})),n=cjce.createElement("ccbm-fabgroup",{items:e}),i.appendChild(n),"openDatabase"in window||(pe(K),cjgApis.cache.getItem(d.account,"bm_cache_v33__mail__apilabels").then(function(e){e&&Array.isArray(e)&&(N||M(e))}),re().then(function(e){N||M(e,!0)})),cjgApis.cache.getItem(d.account,"bm_cache_v33__mail__sqllabels2").then(function(e){return"object"==typeof e&&null!==e&&"priority"in e?e:null}).then(function(e){N||e&&(pe(e.priority),M(e.other))})})}();