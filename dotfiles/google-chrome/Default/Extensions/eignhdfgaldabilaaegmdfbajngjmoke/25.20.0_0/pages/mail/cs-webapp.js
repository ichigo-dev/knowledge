"use strict";!function(){var a,s,i,n,o,l=window,r=l.location,c=document,e="undefined"!=typeof chrome&&chrome||{};function m(e){e=(e.split("mail/mu/mp/")[1]||"").split("/")[0];e&&l.parent.postMessage({bm_method:"mailSessionId",bm_value:e},s)}function d(e,t){e=c.querySelectorAll(e);e[t=-1===t?e.length-1:t].click()}function u(e){for(var t=e+"/lb_data",a="sp/chrome/"+t,n=Object.keys(l.localStorage),i=0;i<n.length;i++){var o=n[i];if(o.endsWith(t)){a=o;break}}var r,e=l.localStorage[a];e&&(e=JSON.parse(e),r=function(e){for(var t={mainKey:"wa",nameKey:"name",idKey:"Y",unreadKey:"T",colorKey:"bgColor"},a={},n=0;n<e.length;n++){for(var i=e[n],o=Object.keys(i),r=void 0,s=void 0,l=0;l<o.length;l++){var c=o[l],m=i[c],d=m&&"object"==typeof m&&Object.keys(m);if(d&&4<d.length){t.mainKey=c;for(var u=m.name,p=0;p<d.length;p++){var f=d[p];"name"!==f&&"string"==typeof f&&m[f]===u&&(t.idKey=f)}}else"number"==typeof m&&(!r||m<=s)&&(r=c,s=m)}a[r]?a[r]+=1:a[r]=1}for(var h=Object.keys(a),b="T",v=0;v<h.length;v++){var g=h[v];0<a[g]&&(b=g)}return t.unreadKey=b,t}(e),e=e.map(function(e){var t={},e=(t.unreadCount=e[r.unreadKey],e[r.mainKey]),e=(t.name=e[r.nameKey],t.id=e[r.idKey],e[r.colorKey]);return e&&(t.color={backgroundColor:e}),t}),l.parent.postMessage({bm_method:"mailCachedLabels",bm_value:e},s))}function t(){var e=(c.head.textContent.split('USER_EMAIL = "')[1]||"").split('"')[0]||(c.cookie.split("GAUSR=")[1]||"").split(";")||(Object.keys(l.localStorage).join("").split("pref/")[1]||"").split("/")[0];if(e){var t,a=e;if(l.openDatabase){try{t=l.openDatabase(a,"","",0)}catch(e){return void u(a)}t.transaction(function(e){e.executeSql("SELECT labelId,unreadCount,metadata FROM cached_labels",[],function(e,t){for(var a=[],n=0;n<t.rows.length;n++){var i=t.rows[n],o={id:i.labelId,unreadCount:i.unreadCount},i=i.metadata.startsWith("[")&&JSON.parse(i.metadata),r=i[2],i=i[4];"string"==typeof r&&(o.name=r),"string"==typeof i&&(o.color={backgroundColor:i}),a.push(o)}l.parent.postMessage({bm_method:"mailCachedLabels",bm_value:a},s)},function(){u(a)})})}else u(a)}}function p(){var e=r.href;m(e),l.parent.postMessage({bm_method:"mailPageUrl",bm_value:e},s),t(),setTimeout(t,1e3),setTimeout(t,5e3)}l.top!==l.self&&"https://mail.google.com"===r.origin&&-1!==r.pathname.indexOf("/mu/")&&(s=e.runtime.getURL("PATH/").replace("/PATH/",""),"object"!=typeof(e=r.ancestorOrigins)||1===e.length&&e[0]===s)&&(i=s.startsWith("moz-extension://"),(n=c.createElement("script")).textContent='!function(r,n,t,c,o,i){"use strict";var p=i[t],s=(o.search.split("mui=")[1]||"").split("&")[0];Object.defineProperty(i,t,{get:function(){var t=p;if(-1===t.indexOf("GMAIL_AT=")&&(t+="; GMAIL_AT="+s),-1===t.indexOf(r)){var i=(s+"__").split("__")[1].split("_")[0]||"0",e=(o.pathname.split("/mp/")[1]||"").split("/")[0];t+="; "+r+c+"#"+window.USER_EMAIL+":"+e+":"+i}return t.startsWith(n)||-1!==t.indexOf(" "+n)||(t+="; SID=1"),t}}),i.currentScript&&i.currentScript.remove()}("WML=","SID=","cookie",Date.now(),location,document);',function e(){var t;(a=c.documentElement)?(a.insertBefore(n,a.firstChild),(t=a.getAttribute("manifest"))&&m(t),t=-1!==r.search.indexOf("bm_mail_bigtop"),-1!==r.search.indexOf("__theme_dark__")&&(a.dataset.bmCsMailDarkmode="1"),t&&(a.dataset.bmCsMailHideStars="1")):setTimeout(e,.001)}(),o=!1,function e(){var t;r.hash.startsWith("#tl")&&(t=(t=c.querySelector('div[style*="translate3d"] > div:first-child'))&&"none"!==t.style.display,o!==t)&&(o=t,l.parent.postMessage({bm_method:"mailSelectionState",bm_value:t},s)),setTimeout(e,100)}(),l.addEventListener("message",function(e){var t,a,n;e.origin===s&&(e.isTrusted||i)&&(a=(e=e.data||{}).bm_method,e=e.bm_value,"mailClickEle"===a)&&(t=e[0],a=e[2],n=e[1]||0,a?(d(t,a),setTimeout(function(){d(t,n)})):d(t,n))}),l.addEventListener("hashchange",function(){l.parent.postMessage({bm_method:"mailHashChange",bm_value:r.hash.replace("#","")},s)}),"complete"===c.readyState||"loaded"===c.readyState||"interactive"===c.readyState?p():l.addEventListener("DOMContentLoaded",p))}();