"use strict";!function(){var ee=document,ae="https://classroom.google.com",ce=["https://www.googleapis.com/auth/classroom.courses.readonly"],ne=cjBasics.lang.i18n("cj_i18n_00305","Classroom"),te=cjBasics.lang.i18n("cj_i18n_01255","Classes"),ie=cjBasics.lang.i18n("cj_i18n_06654","Add __link_url__ to a class");cjce.registerTemplate("bm-p-classroom",function(a,s){var r,m,u,p,_,c,t,l,n,i,o,d,h,b,g,j="/"+s.wizPath,e=!s.account.validSession,f=!e&&cjBasics.webRequest.wrifSupported&&!cjBasics.navigator.firefox,v=!e&&f,C=f&&!0,w=f&&!1,f=!w&&!e,D=!e&&!0,B=(a.classList.add("bm-p-classroom"),v&&s.darkMode&&a.classList.remove("cjmd--dark"),cjBasics.uniqueId.generate()),P=v,U={bm_cid:"classroomwithwebapp",bm_wiz:"1",bm_cst:"1",bm_iid:B,forcehl:"1",hl:cjBasics.lang.current},E=!1,S="h",k="h",z=new Promise(function(e){c=e}),T=cjBasics.lang.i18n("cj_i18n_06653","current url"),I={h:{iconName:"__mdi:home",label:te,newTabUrl:!0},calendar:{iconName:"__mdi:calendar_today",label:cjBasics.lang.i18n("cj_i18n_01256","Calendar"),newTabUrl:"calendar/this-week/course/all",divider:!0},teachingSubheader:{header:!0,label:cjBasics.lang.i18n("cj_i18n_06577","Teaching")},ta:{iconName:"__mdi:cjg_classroom_to_review",label:cjBasics.lang.i18n("cj_i18n_06622","To review"),newTabUrl:"ta/not-reviewed/all"},enrolledSubheader:{header:!0,label:cjBasics.lang.i18n("cj_i18n_06578","Enrolled")},a:{iconName:"__mdi:cjg_classroom_to_do",label:cjBasics.lang.i18n("cj_i18n_06233","To do"),newTabUrl:"a/not-turned-in/all"},archived:{iconName:"__mdi:archive",label:cjBasics.lang.i18n("cj_i18n_01257","Archived classes"),newTabUrl:"h/archived"},s:{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0}};function y(e){s.openTab(ae+j+e)}function N(e,a){var c,n;function t(){var e;n||(n=!0,e=cjBasics.urlParams.attach(j+c,U),h.cjceSendFrameCommand({method:"bmCstUpdateState",value:e},ae),E)||Y()}!a&&h&&C?(c=e,n=!1,z.then(t),setTimeout(t,5e3)):y(e)}function F(e){var a;e&&!P&&"not_authorized"===e.cjg_error&&(P=!0,g.remove(),a=cjce.createElement("bm-fulldialog",{inline:!0,lockup:{label:cjBasics.lang.i18n("cj_i18n_00305","Classroom")},iconName:"classroom",message:cjBasics.lang.i18n("cj_i18n_00237","To use Classroom, you need to give access to display your Classroom classes"),actionLabel:cjBasics.lang.i18n("cj_i18n_01916","Continue with Google"),actionG:!0,action:function(){cjgApis.auth.requestPermissions(s.account,e.cjg_missing_scopes)}}),b.appendChild(a),cjgApis.cache.remove(s.account,"bm_cache_v33__classroomwithgapi__classlist"))}function M(e){var n,a,c,t=["h","calendar","teachingSubheader","ta","enrolledSubheader","a","archived","s"],i=(I.ta.divider=!e,I.a.divider=!e,e&&(n=e.courseDatabase,i=e.allIds,a=e.archivedIds,c=e.enrolledIds,e=e.teachingIds,i.forEach(function(e){var a=n[e],c=a.themeColor,a=a.label;I["c/"+e]={color:c,label:a,newTabUrl:!0,colorIcon:!0,icon:{theme:"solid",name:"__mdi:class"}}}),t=["h","calendar"],0<e.length&&(t.push("teachingSubheader","ta"),e.forEach(function(e){t.push("c/"+e)}),i=e[e.length-1],I["c/"+i].divider=!0),0<c.length&&(t.push("enrolledSubheader","a"),c.forEach(function(e){t.push("c/"+e)}),e=c[c.length-1],I["c/"+e].divider=!0),0<a.length&&t.push("archived"),t.push("s")),t.map(function(e){var a=I[e];return a.id=e,v||"h"===e||(a.external=!0),a}));return cjce.createElement("bm-navlist",{selectedId:S,items:i,isSelector:!0,onChange:function(e,a){l.cjceSelectedId=S,N("string"==typeof a.newTabUrl&&a.newTabUrl||e)},onNewTab:function(e,a){y("string"==typeof a.newTabUrl&&a.newTabUrl||e)}})}function W(e){var a;n&&(e=M(e),a=n&&n.contains(ee.activeElement)&&n.classList.contains("cjmd-sheet--open"),cjce.replaceChild(n,e,l),a&&n.cjceToggleState(!0),l=e)}function H(e){if(-1===e.indexOf("hrq.crs"))throw new Error("Not a course request");var o,s,r,d,h,e='[["wrb.fr","gXtzob","[\\"hrq.crs'+e.split("hrq.crs")[1].split('"generic"]]')[0]+'"generic"]]',e=JSON.parse(e)[0][2],e=JSON.parse(e)[2];return 0===e.length?null:(o={},s=[],r=[],d=[],h=[],e.forEach(function(a){var e,c,n=Date.now().toString();try{n=a[0][0]}catch(e){"string"==typeof a[28]&&(n=a[28].replace("c:",""))}n.length<11?n+="ZZ":n.length<12&&(n+="Z"),n=window.btoa(n);try{e=a[9][2].replace("https://gstatic.com/","https://ssl.gstatic.com/")}catch(e){}try{c=a[9][1]}catch(e){}var t=2===a[20],i=(a[23],a[10],4===a[43]),l=a[5],a=a[8]||null;o[n]={id:n,enrolled:i,label:l,section:a,themeBackground:e,themeColor:c},(t?r:i?d:h).push(n),s.push(n)}),{courseDatabase:o,allIds:s,archivedIds:r,enrolledIds:d,teachingIds:h})}function R(e){e="https://drive.google.com/drive/"+s.wizPath+"folders/"+e;s.openTab(e)}function L(){m?(p=m,(e=r||u)&&(a=(o=m).allIds,c=o.courseDatabase,n=e.courseDatabase,a.forEach(function(e){var a=n[e];a&&(e=c[e],!r&&e.teacherFolder||(e.teacherFolder=a.teacherFolder))}))):r?(p=r,u&&(e=(o=r).allIds,t=o.courseDatabase,i=u.courseDatabase,e.forEach(function(e){var a=i[e];a&&((e=t[e]).themeColor=a.themeColor,e.themeBackground=a.themeBackground)}),["allIds","archivedIds","enrolledIds","teachingIds"].forEach(function(e){var a=r[e],c=u[e],a=a.sort(function(e,a){return c.indexOf(e)-c.indexOf(a)});r[e]=a}))):p=u;var c,n,t,i,d,e,l,h,a=p,o=JSON.stringify(a);o!==_&&(_=o,E||(b.hidden=!a),d=ee.createDocumentFragment(),(l=cjce.createElement("cjmd-appbar")).classList.add("bm-p-classroom-quicknav"),["a","ta","calendar"].forEach(function(e){var a=I[e],e=cjce.createElement("ccbm-iconbutton",{iconName:a.iconName,label:a.label,onClick:function(){N(a.newTabUrl)},onMetaClick:function(){y(a.newTabUrl)}});l.appendChild(e)}),e=l,d.appendChild(e),a&&(h=a.courseDatabase,a.allIds.forEach(function(e){var a,c,n,t,i,l,o,s,e=h[e],r=(c=(e=e).teacherFolder,n=e.enrolled,t=e.id,i=e.label,l=e.section,r=e.themeBackground,e=e.themeColor,o="c/"+t,(s=ee.createElement("div")).tabIndex=0,s.dataset.id=o,s.className="bm-p-classroom-card",(o=ee.createElement("header")).className="bm-p-classroom-card__top",e&&(o.style.backgroundColor=e),r&&(o.style.backgroundImage='url("'+r+'")'),s.appendChild(o),(e=ee.createElement("h3")).className="bm-p-classroom-card__title",e.textContent=i,o.appendChild(e),l&&((r=ee.createElement("div")).textContent=l,e.appendChild(r)),v&&((i=ee.createElement("p")).textContent=cjBasics.lang.i18n("cj_i18n_00325","Loading…"),i.className="bm-p-classroom-card__loading",s.appendChild(i)),(o=cjce.createElement("cjmd-appbar",{transparent:!0})).classList.add("bm-p-classroom-card__appbar"),s.appendChild(o),n||(a="c/".concat(t,"/gb/sort-name/all-classwork"),l=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:trending_up",label:cjBasics.lang.i18n("cj_i18n_07232","Open student record cards"),onClick:function(){N(a)},onMetaClick:function(){y(a)}}),o.appendChild(l)),c&&(e=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:folder",label:cjBasics.lang.i18n("cj_i18n_07231","Open folder"),onClick:function(){K(c.id,c.title)},onMetaClick:function(){R(c.id)}}),o.appendChild(e)),s);d.appendChild(r)})),g.textContent="",g.appendChild(d),W(a),cjgApis.cache.setItem(s.account,"bm_cache_v33__classroom__courses",a))}function V(){cjBasics.webRequest.addListener("onBeforeRequest",function(e){var a;"POST"===e.method&&"sub_frame"===e.frameType&&e.initiator.startsWith(ae)&&(c(),-1!==(a=e.requestBody.formData)["f.req"][0].indexOf('"[[1000,'))&&(e=e.url,cjBasics.ajax(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:cjBasics.urlParams.create(a)}).then(H).then(function(e){m=e,L()},function(){}))},{urls:[ae+"/*batchexecute*"],types:["xmlhttprequest"]},["requestBody"])}var G={add:"M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z",filter:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z",settings:"M13.85 22.25h-3.7c-.74 0-1.36-.54-1.45-1.27l-.27-1.89c-.27-.14-.53-.29-.79-.46l-1.8.72c-.7.26-1.47-.03-1.81-.65L2.2 15.53c-.35-.66-.2-1.44.36-1.88l1.53-1.19c-.01-.15-.02-.3-.02-.46 0-.15.01-.31.02-.46l-1.52-1.19c-.59-.45-.74-1.26-.37-1.88l1.85-3.19c.34-.62 1.11-.9 1.79-.63l1.81.73c.26-.17.52-.32.78-.46l.27-1.91c.09-.7.71-1.25 1.44-1.25h3.7c.74 0 1.36.54 1.45 1.27l.27 1.89c.27.14.53.29.79.46l1.8-.72c.71-.26 1.48.03 1.82.65l1.84 3.18c.36.66.2 1.44-.36 1.88l-1.52 1.19c.01.15.02.3.02.46s-.01.31-.02.46l1.52 1.19c.56.45.72 1.23.37 1.86l-1.86 3.22c-.34.62-1.11.9-1.8.63l-1.8-.72c-.26.17-.52.32-.78.46l-.27 1.91c-.1.68-.72 1.22-1.46 1.22zm-3.23-2h2.76l.37-2.55.53-.22c.44-.18.88-.44 1.34-.78l.45-.34 2.38.96 1.38-2.4-2.03-1.58.07-.56c.03-.26.06-.51.06-.78s-.03-.53-.06-.78l-.07-.56 2.03-1.58-1.39-2.4-2.39.96-.45-.35c-.42-.32-.87-.58-1.33-.77l-.52-.22-.37-2.55h-2.76l-.37 2.55-.53.21c-.44.19-.88.44-1.34.79l-.45.33-2.38-.95-1.39 2.39 2.03 1.58-.07.56a7 7 0 0 0-.06.79c0 .26.02.53.06.78l.07.56-2.03 1.58 1.38 2.4 2.39-.96.45.35c.43.33.86.58 1.33.77l.53.22.38 2.55z"};function A(e){e='body > nav div[soy-skip] button path[d*="'+G[e]+'"]';h.cjceSendFrameCommand({method:"bmCstClickParentElement",value:{selector:e,depth:3}},ae)}function J(){h.cjceSendFrameCommand({method:"bmCstClickParentElement",value:{selector:'path[d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"]',depth:2}},ae)}function Z(){h?h.cjceGetCleanUrl(ae).then(function(e){e?s.openTab(e):y("h")}):y("h")}var x,O,q=ae+j+S,X=cjBasics.urlParams.attach(q,U);function Y(){E||(E=!0,setTimeout(function(){b.remove()},500),t.cjceSetLoading(!1))}function K(e,a){s.servicesDatabase.drive?s.pageManager.navigate("drive",{folderParameters:{id:e,name:a}}):R(e)}function Q(){return cjce.createElement("bm-iframe",{src:X,shadow:!0,onMessage:function(e){var a,c,n=e.bm_method,e=e.bm_value;"classroomwithwebappOpenDriveFolder"===n?K(e):"classroomwithwebappViewData"===n?(k=e.pathname,j=e.mainServicePath,S="h/archived"===(c=k)?"archived":!c||"h"===c||c.startsWith("h/")?"h":"calendar"===c||c.startsWith("calendar/")?"calendar":"ta"===c||c.startsWith("ta/")?"ta":"a"===c||c.startsWith("a/")?"a":-1===c.indexOf("/a/")&&(c.startsWith("r/")||c.startsWith("w/")||c.startsWith("c/"))?"c/"+c.split("/")[1].split("/")[0]:c,w||(c=(l.cjceSelectedId=S)in I,t.cjceSetBackState(!c),i.hidden="h"!==S,d.hidden="calendar"!==S,a=(c=S.startsWith("c/")&&-1===k.indexOf("/a/"))||k.startsWith("ta/")||k.startsWith("a/"),h.classList.toggle("cjmd-shadow--thin",!a),o.hidden=!c,c=(a=I[S])&&a.color,t.style.setProperty("--ccc-accent-color",c||"")),(c=(a=I[S])&&a.label)||(c=e.title.split(" -")[0].split(" –")[0])&&c!==ne||(c=te),k.startsWith("share")&&(c=ie.replace("__link_url__",T)),t.cjceSetPageLabel(c)):"classroomwithwebappLoadingState"===n&&(t.cjceSetLoading(e),e||E||setTimeout(Y,50))}})}function $(){a.textContent="";var e=cjce.createElement("bm-fulldialog",{bmApis:s,onNewTab:function(){y("h")},lockup:{label:ne},iconName:"classroom",message:cjBasics.lang.i18n("cj_i18n_06625","You can't use __product_name__ with this account.").replace("__product_name__",ne),actionLabel:cjBasics.lang.i18n("cj_i18n_01543","Switch account"),action:function(){s.pageManager.navigate("accountchooser")}});a.appendChild(e)}cjBasics.webRequest.handleIframeHeaders([ae+"/*bm_iid="+B+"*"],{disableOgs:ae,handleFirefoxInject:!0,handleSecVariables:!0,handleSwCache:!0}),t=cjce.createElement("bm-ogb",{loading:!e,drawer:f,navigator:w&&{onClick:J},serviceIcon:"classroom",serviceLabel:ne,pageLabel:e?cjBasics.lang.i18n("cj_i18n_00291","Home"):te,bmApis:s,onBack:function(){h.cjceSendFrameCommand({method:"bmCstNavigateBack"},ae)},onNewTab:Z}),s.darkMode&&v&&t.classList.add("cjmd--dark"),a.appendChild(t),C&&(i=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:add",label:cjBasics.lang.i18n("cj_i18n_06579","Create or join a class"),onClick:function(){E||N("h"),A("add")}}),t.cjceAppendChild(i),(o=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_06580","Class settings"),onClick:function(){A("settings")}})).hidden=!0,t.cjceAppendChild(o),(d=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:today",label:cjBasics.lang.i18n("cj_i18n_01253","Today"),onClick:function(){N("calendar/this-week/course/all")}})).hidden=!0,t.cjceAppendChild(d),(q=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:tune",onClick:function(){A("filter")}})).hidden=!0,t.cjceAppendChild(q)),x=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:link",label:ie.replace("__link_url__",T),onClick:function(){N("share?url="+encodeURIComponent(T)),setTimeout(function(){x.remove()},200)}}),cjBasics.navigator.getActionableUrl().then(function(e){e?(t.cjceAppendChild(x),T=e.url,x.title=ie.replace("__link_url__",T)):x.remove()}),n=t.cjceDrawerEl,W(),cjBasics.webRequest.catchAndStop([ae+j+"ineligible*"],$,!0),e?(O=cjce.createElement("cjmd-container",{shadow:"thinOnScroll",scrollable:!0}),l=M(),O.appendChild(l),a.appendChild(O)):(v&&(h=Q(),a.appendChild(h)),(b=ee.createElement("div")).classList.add("bm-p-classroom-dummy"),g=cjce.createElement("cjmd-container",{solid:v,scrollable:!0,shadow:"thinOnScroll"}),b.appendChild(g),cjce.applyTemplate(g,"basic-anyclickhandler",{onClick:function(e){var a=ee.activeElement,a=a&&a.dataset.id;a&&N(a,cjBasics.events.hasMeta(e))}}),a.appendChild(b),cjgApis.cache.getItem(s.account,"bm_cache_v33__classroom__courses").then(function(e){e&&(u=e,L())}),D&&(O=s.account,B=cjBasics.urlParams.attach("https://classroom.googleapis.com/v1/courses",{courseStates:["ACTIVE","PROVISIONED","ARCHIVED"],fields:"courses(alternateLink,courseState,creationTime,enrollmentCode,name,section,teacherFolder)",prettyPrint:"false",pageSize:"100"}),cjgApis.request(B,{fetchAs:"json"},{account:O,requiredScopes:ce}).then(function(e){var i,l,o,s,r,e=e.courses;return 0===e.length?null:(i={},l=[],o=[],s=[],r=[],e.sort(function(e,a){return e.creationTime>a.creationTime?-1:1}).forEach(function(e){var a=e.alternateLink.split("c/")[1],c=!e.enrollmentCode,n="ARCHIVED"===e.courseState?o:c?s:r,n=(n.push(a),l.push(a),e.name),t=e.section||null,e=e.teacherFolder;i[a]={teacherFolder:e,enrolled:c,id:a,label:n,section:t,themeColor:c?"#34a853":null}}),{courseDatabase:i,allIds:l,archivedIds:o,enrolledIds:s,teachingIds:r})},F).then(function(e){r=e,L(),v||t.cjceSetLoading(!1)})),v&&V())})}();