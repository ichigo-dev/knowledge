"use strict";!function(){var t=window,_=t.location,e=document,l="undefined"!=typeof chrome&&chrome||{};function n(e){t.open(e,"_blank","noopener")}function i(e){if(e){if("object"==typeof l.tabs)try{return void l.tabs.create({url:e},function(){l.runtime.lastError&&n(e)})}catch(e){}n(e)}}function R(){var e;l.runtime.openOptionsPage?l.runtime.openOptionsPage():(e=(e=l.runtime.getManifest()).options_page||(e.options_ui||{}).page||"/views/app.html?environment=options&page=extensionsettings")&&i(e)}function r(e){e=e||{};e.view="cm",e.tf="0",l.windows.create({url:cjBasics.urlParams.attach("https://mail.google.com/mail",e),width:500,height:516,type:"panel"})}var a=l.action||l.browserAction||l.pageAction,o=l.runtime.getURL("PATH/").replace("/PATH/",""),F=o.startsWith("moz-extension://");function s(e){var t,e="/pages/wei_"+e+"/"+e+"-",n=F?".svg":".png";t={16:e+"16"+n,19:e+"19"+n,32:e+"32"+n,38:e+"38"+n},a.setIcon({path:t},function(){l.runtime.lastError&&a.setIcon({path:t[32]||t[16]})})}function c(e){t.open(e,"_blank","noopener")}var p=l.action||l.browserAction||l.pageAction,u=l.notifications,W=l.runtime.getURL("PATH").replace("/PATH","");function f(e){e=e.split(".");return e[0]+"."+e[1]}function d(e){t.open(e,"_blank","noopener")}var m,g,b,h,v,w,y,j,x,T,B,k,P,O,C,A,V=l.runtime.id;function H(e){var t=h[e];v.create({contexts:t.contexts||["page"],id:e,title:t.label})}function L(e,t){h[e.menuItemId].onClick(e,t),U()}function U(){v.onClicked.hasListener(L)||v.onClicked.addListener(L)}function I(e){if(e){if("object"==typeof l.tabs)try{return void l.tabs.create({url:e},function(){l.runtime.lastError&&d(e)})}catch(e){}d(e)}}function M(e){p.setPopup({popup:e||""})}function E(){y&&(y=null,I(O),l.storage.local.remove("cj_landing_lastupdated"),w.onExecute&&w.onExecute(),C)&&(p.onClicked.removeListener(E),k&&M(k),!0===C)&&p.setBadgeText({text:""})}function N(e,t){return e&&l.i18n&&l.i18n.getMessage&&l.i18n.getMessage(e)||t||""}function S(){u.create("cj_landing_update_notification",{type:"basic",requireInteraction:!0,title:N("cj_i18n_06288","__app_name__ has been updated").replace("__app_name__",x.name),message:N("cj_i18n_06287","Click to view changelog"),iconUrl:function(){var e=x.icons;if(e)return e[160]||e[80]||e[128]||e[48]||e[Object.keys(e)[0]]}()}),u.onClicked.addListener(function(e){"cj_landing_update_notification"===e&&(E(),u.clear("cj_landing_update_notification"))})}function q(){function e(){E(),l.windows.onFocusChanged.removeListener(e),l.tabs.onCreated.removeListener(e)}l.windows.onFocusChanged.addListener(e),l.tabs.onCreated.addListener(e)}function D(e){C&&(k&&M(),!0===C)&&(p.setBadgeBackgroundColor({color:"#EA4335"}),p.setBadgeText({text:j?"*":"âœµ"})),w.onUpdateAvailable&&w.onUpdateAvailable(),A<e-y&&q()}setTimeout(function(){_.reload()},4e7),l.storage&&l.storage.local&&(l.storage.local.get(null,function(e){e=Object.keys(e).filter(function(e){return-1===e.indexOf("bm_pref")&&-1===e.indexOf("bm_cache_v33")&&!e.startsWith("cj_landing_")&&!e.startsWith("__sync_storage__")&&"__sync_fallback__"!==e&&!e.endsWith("bm_cache_v32__bookmarks__bookmarks")});0<e.length&&l.storage.local.remove(e)}),l.storage.sync)&&(m={prefTasksDueDate:"bm_pref__tasks__duedate",prefDriveThumbnailView:"bm_pref__drive__thumbs",prefatariThumbnailView:"bm_pref__atari__thumbs",prefatariFilterBy:"bm_pref__atari__filter",prefatariOrderBy:"bm_pref__atari__order",prefdatastudioFilterBy:"bm_pref__datastudio__filter",prefdatastudioOrderBy:"bm_pref__datastudio__order",prefdocsThumbnailView:"bm_pref__docs__thumbs",prefdocsFilterBy:"bm_pref__docs__filter",prefdocsOrderBy:"bm_pref__docs__order",prefdrawingsThumbnailView:"bm_pref__drawings__thumbs",prefdrawingsFilterBy:"bm_pref__drawings__filter",prefdrawingsOrderBy:"bm_pref__drawings__order",prefformsThumbnailView:"bm_pref__forms__thumbs",prefformsFilterBy:"bm_pref__forms__filter",prefformsOrderBy:"bm_pref__forms__order",prefjamboardThumbnailView:"bm_pref__jamboard__thumbs",prefjamboardFilterBy:"bm_pref__jamboard__filter",prefjamboardOrderBy:"bm_pref__jamboard__order",prefmymapsThumbnailView:"bm_pref__mymaps__thumbs",prefmymapsFilterBy:"bm_pref__mymaps__filter",prefmymapsOrderBy:"bm_pref__mymaps__order",prefscriptFilterBy:"bm_pref__script__filter",prefscriptOrderBy:"bm_pref__script__order",prefsheetsThumbnailView:"bm_pref__sheets__thumbs",prefsheetsFilterBy:"bm_pref__sheets__filter",prefsheetsOrderBy:"bm_pref__sheets__order",prefslidesThumbnailView:"bm_pref__slides__thumbs",prefslidesFilterBy:"bm_pref__slides__filter",prefslidesOrderBy:"bm_pref__slides__order","dense-mode":"bm_pref__main__densemode","selected-services":"bm_pref__portal__services",serviceClicks:"bm_pref__applauncher__clicks","news-edition":"bm_pref__news__edition",prefTrendsHottrendsEdition:"bm_pref__trends__edition"},l.storage.sync.get(null,function(n){var i=Object.keys(n),r=[],a={},o=!1;i.forEach(function(e){var t;e.startsWith("bm_pref")||(r.push(e),(t=m[e])&&-1===i.indexOf(t)&&(o=!0,a[t]=n[e]))}),o&&l.storage.sync.set(a),0<r.length&&l.storage.sync.remove(r)})),(v=l.contextMenus||l.menus)&&(B=l.runtime.getURL("PATH/").replace("/PATH/",""),g=B.startsWith("moz-extension://"),b=B.startsWith("safari-web-extension://"),B=function(){var e=[],t=l.contextMenus.ContextType;if(!t)return["browser_action"];for(var n=["ACTION","BROWSER_ACTION","PAGE_ACTION"],i=0;i<n.length;i++){var r=t[n[i]];r&&e.push(r)}return e}(),h={openPreferences:{limitToPages:["extensionsettings"],contexts:B,label:cjBasics.lang.i18n("cj_i18n_01440","Preferences"),onClick:R},openInTab:{limitToPages:["extensionsettings"],contexts:B,label:cjBasics.lang.i18n("cj_i18n_01545","Open in a new tab"),onClick:function(){i("/views/app.html")}},openInPanel:{limitToPages:["extensionsettings"],contexts:B,label:cjBasics.lang.i18n("cj_i18n_01546","Open in a panel"),onClick:function(){setTimeout(function(){l.windows.create({url:"/views/app.html",width:600,height:596,type:"panel",focused:!0})})}},translateSelection:{limitToPages:["translate"],contexts:["selection"],label:cjBasics.lang.i18n("cj_i18n_01547","Translate text"),onClick:function(e){l.windows.create({url:"https://translate.google.com/#"+cjBasics.urlParams.create({view:"home",op:"translate",sl:"auto",tl:navigator.language.split("-")[0].split("_")[0],text:e.selectionText}),width:500,height:516,type:"panel"})}},emailSelection:{limitToPages:["gmail","inbox"],contexts:["selection"],label:cjBasics.lang.i18n("cj_i18n_01548","Mail this text"),onClick:function(e){r({body:e.selectionText+"\n\nSource: "+e.pageUrl})}},emailToSelection:{limitToPages:["gmail","inbox"],contexts:["selection"],label:cjBasics.lang.i18n("cj_i18n_01549","Write mail to address"),onClick:function(e){r({to:e.selectionText})}},gmailThisPage:{limitToPages:["gmail","inbox"],contexts:["page"],label:cjBasics.lang.i18n("cj_i18n_01552","Mail this page"),onClick:function(e,t){r({su:t.title,body:e.pageUrl})}},translateThisPage:{limitToPages:["translate"],contexts:["page"],label:cjBasics.lang.i18n("cj_i18n_07195","Translate this page"),onClick:function(e,t){var n="https://translate.google.com/website?u="+encodeURIComponent(t.url);l.tabs.update(t.id,{url:n})}}},cjBasics.ajax("/pages.json",{fetchAs:"json"}).then(function(e){return Object.keys(e)}).then(function(i){var e,t=Object.keys(h).filter(function(e){if("openPreferences"===e)return b||g;var t=h[e].limitToPages;if(!Array.isArray(t))return!0;for(var n=0;n<t.length;n++)if(-1!==i.indexOf(t[n]))return!0;return!1});e=t,v&&(v.removeAll(function(){(e||Object.keys(h)).forEach(H)}),U())}),U()),l.runtime.getManifest().chrome_url_overrides&&(a.onClicked.addListener(function(){var e=o+"/views/app.html?environment=newtab";if(e){if("object"==typeof l.tabs)try{return void l.tabs.create({url:e},function(){l.runtime.lastError&&c(e)})}catch(e){}c(e)}}),s("newtab")),browserStorage.sync.getItem("bm_pref__main__extensionicon").then(function(e){"gsa_nobg"===e&&s("gsa_nobg")}),l.runtime.onMessage.addListener(function(e,t,n){if(t.id===V){var s,c;if(!e.createNewPopup)return e.listAccounts?(cjgApis.account.list(e.listAccounts).then(function(e){n({error:!1,response:e})},function(e){n({error:!0,response:e})}),!0):void 0;s=e.createNewPopup,c=l.webRequest,l.windows.create({type:"popup",url:s.requestUrl,height:600,width:600,left:s.leftPosition||3e3,top:s.topPosition||64},function(e){var n=e.tabs[0].id,t=e.id;function i(e){var t;if(!cjBasics.navigator.firefox)return t=(e=new URL(e.url)).hash||"#","signin"===s.method?t="#signin":"signout"===s.method&&(t="#signout"),cjBasics.navigator.mac&&(t+="--macpopup"),e=_.origin+"/views/cjg-popup.html"+e.search+t,l.tabs.update(n,{url:e}),{redirectUrl:e}}function r(){l.tabs.onRemoved.removeListener(o),l.runtime.onMessage.removeListener(a),"object"==typeof c&&c.onBeforeRequest.removeListener(i)}function a(e){e.closeAuthPopup&&(l.windows.remove(t),r())}function o(e){e===n&&r()}l.runtime.onMessage.addListener(a),l.tabs.onRemoved.addListener(o),"object"==typeof c&&c.onBeforeRequest.addListener(i,{tabId:n,urls:[s.redirectUrl],types:["main_frame"]},["blocking"])})}}),w={updateBadge:"custom",websitePath:"black-menu-for-google",onExecute:function(){s("blackmenu")},onUpdateAvailable:function(){s("blackmenubadge")}},j=W.startsWith("safari-web-extension://"),x=l.runtime.getManifest(),T=x.version,B=x.browser_action||x.action,k=B&&B.default_popup,P=(B=(w.origin||"https://apps.jeurissen.co")+"/"+(w.websitePath||"")+"/")+"installed",O=B+"whatsnew?installed=1",C=w.updateBadge,A=864e5*(w.passiveActionButton?1.5:4.5),l.runtime.setUninstallURL(B+"uninstalled"),l.storage.local.get(["cj_landing_lastupdated","cj_landing_versionnumber"],function(e){var t,n=Date.now();y=e.cj_landing_lastupdated,"string"!=typeof(e=e.cj_landing_versionnumber)?I(P):y||(t=f(e),f(T)!==t&&(y=n,l.storage.local.set({cj_landing_lastupdated:n}))),y&&!w.noUpdateNotice&&(w.useNotification&&u?S():C?D(n):q(),w.handleTrigger)&&l.runtime.onMessage.addListener(function e(t){t&&"object"==typeof t&&t.cjLandingOpen&&(E(),l.runtime.onMessage.removeListener(e))}),e!==T&&l.storage.local.set({cj_landing_versionnumber:T})}),p.onClicked.addListener(E),l.runtime.onInstalled.addListener(function(){}),void 0!==e&&(e.body.textContent="")}();