# コンピュータと離散数学

（最終更新： 2023-01-09）


## 目次

1. [離散数学](#離散数学)
1. [基数の基本](#基数の基本)
	1. [アナログとデジタル](#アナログとデジタル)
	1. [位取り記数法](#位取り記数法)
	1. [基数](#基数)
	1. [10進数](#10進数)
	1. [2進数](#2進数)
	1. [8進数](#8進数)
	1. [16進数](#16進数)
	1. [位取り記数法の対応表](#位取り記数法の対応表)
	1. [基数変換](#基数変換)
1. [コンピュータとデータ](#コンピュータとデータ)
	1. [データの単位](#データの単位)
1. [2進数による数の表現](#2進数による数の表現)
	1. [数の正負](#数の正負)
	1. [補数表現](#補数表現)
	1. [固定少数点数](#固定少数点数)
	1. [浮動少数点数](#浮動少数点数)
1. [誤差](#誤差)
	1. [桁落ち](#桁落ち)
	1. [情報落ち](#情報落ち)
	1. [丸め誤差](#丸め誤差)
	1. [打ち切り誤差](#丸め誤差)
	1. [オーバフロー](#オーバフロー)
	1. [アンダーフロー](#アンダーフロー)
1. [10進数の表現](#10進数の表現)
	1. [BCDコード](#bcdコード)


## 離散数学

**離散数学**とは有限で離散的な値を扱う数学のうち、非計算の分野を対象としたもの。コンピュータでは主に離散値を扱うため、離散数学の考え方が基本となる。コンピュータの分野で重要となる離散数学の範囲は、基数や集合、論理演算などである。


## 基数の基本

### アナログとデジタル

**アナログ**はデータを連続的に変化していく量（連続値）で表したもの。区切られることなく緩やかに変化していくものはアナログ値として記録することができる。アナログデータは通信の際にノイズの影響を受けやすく、完全な複製を行うことができないために時間の経過やコピーによって情報が劣化するという欠点がある。

**デジタル**は連続しているデータを一定の値で区切って離散値として表したもの。ある瞬間のアナログ値を、その値に最も近い離散値に置き換えて記録する（**量子化**）。デジタルデータはコンピュータによる処理がしやすく、通信時のノイズによる情報の劣化にも強い。ただし値を近似値として記録しているため正確な値をデータにすることができない。

![アナログとデジタル](../assets/images/analog_and_digital.jpg)

### 位取り記数法

**位取り記数法**とはあらかじめ決められたn種類の記号（数字）により数を表現する方法のこと。一般的には記号としてアラビア数字やアルファベットを使用するが、それ以外のもの（漢数字など）を用いてもよい。

---
基数となる自然数nに対して

$0, 1, \cdots, n-1$

の数字に任意の記号を対応させる。これを

$a_m a_{m-1} \cdots a_0.b_1 b_2 \cdots b_k$

という数値列で表現すると、この基数で表される数字列は

$a_m \times n^m + a_{m-1} \times n^{m-1} + \cdots + a_1 \times n + a_0 + \frac{b_1}{n} + \frac{b_2}{n^2} + \cdots + \frac{b_k}{n^k}$

という数を表す。

---

位取り記数法では[基数](#基数)が異なると、表記上は同じ数であっても実際に表す大きさが異なる。そのため、数の右側に基数を「下付き」あるいは「下付き括弧付き」で明記する場合がある。

$123.456_{10}$

$123.456_{(10)}$

$(123.456)_{10}$

### 基数

**基数**は[位取り記数法](#位取り記数法)で数を表現する際に各桁の重み付けの基本となる数のことで、位が上がるたびに何倍になるかを表す。

位取り記数法で表された数の各桁には記数による桁の重みがかかっており、n進数においては1桁目から順番に $n^0, n^1, n^2 \cdots$ という重みになる。ある桁の1つ上の桁の重みはn倍となり、1つ下の桁の重みは1/nとなる。

### 10進数

**10進数**は最も身近な[位取り記数法](#位取り記数法)で、0から9までの10つの数字を用いて数を表す。1つの桁は10になると位が上がる。ある桁の1つ上の桁は10倍になり、1つ下の桁は1/10倍になる。

$123.456_{10}$は次の数を表している。

$1 \times 10^2 + 2 \times 10^1 + 3 \times 10^0 + 4 \times 10^{-1} + 5 \times 10^{-2} + 6 \times 10^{-3} = 123.456$

### 2進数

**2進数**はコンピュータ内部でデータを表現するために使用されている[位取り記数法](#位取り記数法)で、0と1の2つの数字を用いて数を表す。1つの桁は2になると位が上がる。ある桁の1つ上の桁は2倍になり、1つ下の桁は1/2倍になる。

2進数n桁で表現できる数は $2^n$ 通りとなる。1桁なら2通り、2桁なら4通り、3桁なら8通り、8桁なら256通りといった具合。

2進数で表されたデータ形式のことを**バイナリ**という。

$101.001_2$は10進数で次の数を表している。

$1 \times 2^2 + 0 \times 2^1 + 1 \times 2^0 + 0 \times 2^{-1} + 0 \times 2^{-2} + 1 \times 2^{-3} = 5.125$

### 8進数

**8進数**はコンピュータ内部のデータを表現するために使用されることのある[位取り記数法](#位取り記数法)で、0から8までの8つの数字を用いて数を表す。1つの桁は8になると位が上がる。ある桁の1つ上の桁は8倍になり、1つ下の桁は1/8倍になる。

2進数の3桁を1つにまとめたものと等価となり、2進数との相互変換が容易である。

$123.456_8$は10進数で次の数を表している。

$1 \times 8^2 + 2 \times 8^1 + 3 \times 8^0 + 4 \times 8^{-1} + 5 \times 8^{-2} + 6 \times 8^{-3} \simeq 83.590$

### 16進数

**16進数**はコンピュータ内部のデータを表現するために使用されることのある[位取り記数法](#位取り記数法)で、0から9までの10つの数字とAからFまでのアルファベットを用いて数を表す。1つの桁は16になると位が上がる。ある桁の1つ上の桁は16倍になり、1つ下の桁は1/16倍になる。

2進数の4桁を1つにまとめたものと等価となり、2進数との相互変換が容易である。

$123.ABC_{16}$は10進数で次の数を表している。

$1 \times 16^2 + 2 \times 16^1 + 3 \times 16^0 + 10 \times 16^{-1} + 11 \times 16^{-2} + 12 \times 16^{-3} \simeq 291.671$

### 位取り記数法の対応表

|  2進数 |  8進数 | 10進数 | 16進数 |  2進数 |  8進数 | 10進数 | 16進数 |
|--------|--------|--------|--------|--------|--------|--------|--------|
|      0 |      0 |      0 |      0 |  10001 |     21 |     17 |     11 |
|      1 |      1 |      1 |      1 |  10010 |     22 |     18 |     12 |
|     10 |      2 |      2 |      2 |  10011 |     23 |     19 |     13 |
|     11 |      3 |      3 |      3 |  10100 |     24 |     20 |     14 |
|    100 |      4 |      4 |      4 |  10101 |     25 |     21 |     15 |
|    101 |      5 |      5 |      5 |  10110 |     26 |     22 |     16 |
|    110 |      6 |      6 |      6 |  10111 |     27 |     23 |     17 |
|    111 |      7 |      7 |      7 |  11000 |     30 |     24 |     18 |
|   1000 |     10 |      8 |      8 |  11001 |     31 |     25 |     19 |
|   1001 |     11 |      9 |      9 |  11010 |     32 |     26 |     1A |
|   1010 |     12 |     10 |      A |  11011 |     33 |     27 |     1B |
|   1011 |     13 |     11 |      B |  11100 |     34 |     28 |     1C |
|   1100 |     14 |     12 |      C |  11101 |     35 |     29 |     1D |
|   1101 |     15 |     13 |      D |  11110 |     36 |     30 |     1E |
|   1110 |     16 |     14 |      E |  11111 |     37 |     31 |     1F |
|   1111 |     17 |     15 |      F | 100000 |     40 |     32 |     20 |
|  10000 |     20 |     16 |     10 | 100001 |     41 |     33 |     21 |

### 基数変換

ある基数で表された数を別の基数で表現することを**基数変換**という。一般的に数は10進数で表現されることが多く、人間にとっても理解しやすいため、10進数とn進数との変換が重要となる。

- n進数から10進数への変換

n進数で表された数の各桁に重みをかけて足し合わせると、10進数に変換することができる。変換式の定義は[位取り記数法](#位取り記数法)に、具体的な変換の例は[2進数](#2進数)、[8進数](#8進数)、[16進数](#16進数)にそれぞれ示す。

- 10進数からn進数への変換

まずは10進数の値を整数部と小数部に分ける。

整数部については、10進数で表された数を任意の基数nで繰り返し割り続け、それ以上割り切れなくなった時点で最後の商と各回の余りを逆順に並べる。

小数部については、10進数で表された数に任意の記数nをかけ続け、小数部が0になった時点で各回の整数部の値を順番に並べる。ただし小数部は無限少数となることがある。

整数部と小数部で得られた数値列がそれぞれ変換後の基数における整数部と小数部となる。

- 2進数から8進数、16進数への変換

8進数、16進数はそれぞれ2進数の3桁、4桁と等価であるため、2進数の数を3桁あるいは4桁づつ区切って読み替えることで容易に変換することができる。


## コンピュータとデータ

コンピュータは多くの電子回路から構成されており、スイッチのON/OFFや電圧の高低により信号を伝達している。これらの信号を0と1に対応させる（ONなら1でOFFなら0、5V（電圧高）なら1で0V（電圧低）なら0など）ことで、コンピュータ内部では情報を2進数として扱っている。コンピュータが扱う情報は数字であろうと文字であろうと命令であろうとすべて2進数で表現することができる。また2進数で様々な情報を表現しようとすると桁数が大きくなるため、2進数との基数変換が容易な8進数や16進数（これらは2のべき乗が基数となっているため）もコンピュータの世界ではよく使用されている。

一般的な数は10進数で扱われているため、2進数や8進数、16進数との相互変換がよく行われる。

### データの単位

コンピュータ内部で扱われるデータの最小単位は2進数で表された数の1桁で、これを**ビット**(bit)という。

複数のビットを集めたデータ量の単位を**バイト**(byte)といい、一般的には1バイトは8ビットと等価である。1バイトは256通りの情報を表現することができる。

複数のビットを集めたデータ量の単位としては他にも**ワード**があり、これはコンピュータ内部でCPUやメモリによって処理されるときのデータの単位を表している。ワードサイズはコンピュータやOSによって異るが、4バイトや8バイトが一般的。

ビット列のまとまりにおいて一番左側のビットのことを**最上位ビット**(**MSB**: Most Significant Bit)、一番右側のビットのことを**最下位ビット**(**LSB**: Least Significant Bit)という。


## 2進数による数の表現

### 数の正負

2進数で表された数において最上位ビットを**符号ビット**として扱うことで数の正負を表現することができる。符号ビットが0ならば正の数、1ならば負の数として扱う。また、負の数の表現方法としては補数表現を用いる。

### 補数表現

**補数**とはn進数のある数に対して補うことで、ちょうどnのべき乗（あるいはnのべき乗から1を引いたもの）になる自然数のうち最小のもののこと。言い換えると、ある数に対して足し合わせることで桁が1つ上がる数のこと。例として $560_{10}$ に対する補数は $440_{10}$ （ $560_{10} + 440_{10} = 1000_{10}$ となるため ）となる。

**2の補数**は2進数において負の数を表現する際に用いられる。これは、符号ビットを含めたすべてのビットを反転したもの（**1の補数**）に1を加算することで求めることができる。2の補数においてnビットで表現できる数の範囲は $-(2^{n-1}) ~ (2^{n-1} - 1)$ となる。これに対して1の補数では $-(2^{n-1} - 1) ~ (2^{n-1} - 1)$ となり、表現できる範囲が1少なくなる（0が正と負で2種類存在してしまうため）。

補数を用いた場合、減算は加算として扱うことができる。例として $01100100_2 (=100_{10})$ から $11101111_2 (=-17_{10})$ を引いた結果は次のようにして求められる（溢れた桁は無視して良い）。

```
    0 1 1 0 0 1 0 0
+   1 1 1 0 1 1 1 1
-------------------
  1 0 1 0 1 0 0 1 1
```

### 固定小数点数

**固定少数点数**ではどのビットを小数点とするかをあらかじめ決めておき小数を表現する。データの解析は容易であるが、表現できる数値の範囲が限定されてしまうため浮動小数点数を用いる場合が多い。

### 浮動小数点数

**浮動小数点数**は限られたバイト数の中で効率よく実数を表現する方法で、[IEEE 754](https://ja.wikipedia.org/wiki/IEEE_754)によって規定された浮動小数点方式と呼ばれる方式を用いる。浮動小数点数の基本は指数表現で、実数を $数値 = 仮数部 \times 基数部^{指数部}$ の形式で表す。

- **基数部**は2進数であれば必ず2となる
- **指数部**には基数に対する指数部分を2進数で表記したものを格納する（指数部が負の場合は2の補数表現を使用）
- **仮数部**には正規化した小数点数以下の値を格納する

小数点数の演算では制度が重要になるため、仮数部で有効桁数を確保して指数部で数の大きさを表現する。仮数部の最上位ビットが0にならないように仮数部と指数部を調整することで有効桁数を最大にすることを、**正規化**という。

浮動小数点数には単精度と倍精度があり、**単精度**では32ビット（符号部1ビット、指数部8ビット、仮数部23ビット）、**倍精度**では64ビット（符号部1ビット、指数部11ビット、仮数部52ビット）で表現する。


## 誤差

**誤差**とは限られた桁数で表現された値と真の値との差。

固定小数点数では限られた範囲の中であれば誤差なく計算することができるが、範囲内すべての値を正確に表現できない（近似値を用いる場合がある）ため、誤差が生じる可能性がある。10進数で表したときに有限小数であっても、2進数で表すと無限小数となる場合もあるので注意が必要（ $0.01$ など）。

### 桁落ち

**桁落ち**は値がほぼ等しい2つの数値の差を求めたときに、有効桁数が減ってしまう誤差。次の例では、もともとの値の有効桁数は10桁であるが、計算後の値の有効桁数は2桁になってしまう。

```
1.110100101 \times 2^3 - 1.110100010 \times 2^3 = 0.000000011 \times 2^3 = 1.100000000 \times 2^{-5}
```

### 情報落ち

**情報落ち**は絶対値が非常に大きい数値と小さい数値で加算や減算を行ったときに、小さい数値が計算結果に反映されない誤差。下記の例で有効桁数が8桁であるとすると、計算結果に小さい方の数値が反映されない。

```
1234.5678 + 0.0000001 = 1234.5678001 \simeq 1234.5678
```

### 丸め誤差

**丸め誤差**は数値の有効桁数の関係で切り捨て、切り上げ、四捨五入などによって下位の桁を削除することで発生する誤差。

### 打ち切り誤差

**打ち切り誤差**は無限少数などの桁が無限に続く数値を途中で打ち切ることによって発生する誤差。

### オーバフロー

**オーバフロー**は演算結果が桁内で表すことができる数値の範囲を超えることで発生する誤差。例えば1バイトの整数データであれば表現できる範囲は `-128 ~ 127` であるが、上限である127を超える数値になるような演算を行うと発生する。

### アンダーフロー

**アンダーフロー**は浮動小数点数の演算において、演算結果の指数部が小さくなりすぎることで数値を表現できなくなるような誤差。浮動小数点数の指数部で表現可能な範囲の最小値よりも小さい数となった場合に発生する。


## 10進数の表現

コンピュータが計算を行う際は数を2進数として扱うが、キーボードから入力された数字はそのまま10進数の文字として表現され、計算に使うときに2進数に変換される。コンピュータが10進数を表現する一般的な方法として、BCDコード、ゾーン10進数、パック10進数がある。

### BCDコード

**BCDコード**(Binary Coded Decimal)は10進数の1桁を2進数4桁（1ビット）に対応させて表現したもので、数字を表すコードの基本となる。

| 10進数 | BCDコード |
|--------|-----------|
|      0 |      0000 |
|      1 |      0001 |
|      2 |      0010 |
|      3 |      0011 |
|      4 |      0100 |
|      5 |      0101 |
|      6 |      0110 |
|      7 |      0111 |
|      8 |      1000 |
|      9 |      1001 |

### ゾーン10進数

**ゾーン10進数**（**アンパック10進数**）は10進数を1バイトで表現する方法で、上位4ビット（**ゾーン部**）は文字コードの種類を表し、下位4ビットは数値を表すBCDコードが入る。また、最下位桁のゾーン部は符号部として使用する。

JISコード形式では数字を表す文字の上位4ビットを0011としている。また符号部は数が正の場合は1100、負の場合は1101となる。

```
# JISコード形式で表した987
00111001 00111000 11000111

# JISコード形式で表した-987
00111001 00111000 11010111
```

### パック10進数

**パック10進数**は10進数1桁をBCDコードで表現し、最下位の4ビットに符号を付加する。バイト単位で扱うため偶数桁の場合は符号部を含めて8ビットの倍数にならないため先頭に0000を追加する。

```
# パック10進数で表した-6078
0000 0110 0000 0111 1000 1101
```
