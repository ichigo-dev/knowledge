# 『算術演算と精度』

（最終更新： 2023-01-09）


## 目次

1. [シフト演算](#シフト演算)
	1. [論理シフト](#論理シフト)
	1. [算術シフト](#算術シフト)
1. [誤差](#誤差)
	1. [桁落ち](#桁落ち)
	1. [情報落ち](#情報落ち)
	1. [丸め誤差](#丸め誤差)
	1. [打ち切り誤差](#打ち切り誤差)
	1. [オーバフロー](#オーバフロー)
	1. [アンダーフロー](#アンダーフロー)


## シフト演算

**シフト演算**は桁を移動することでべき乗を計算する方法。n進法において桁を左へシフトすると数は元のn倍に、右へシフトすると筋は元の1/n倍になる。

2進数で表された数は左にkビットシフトすることで元の数の $2^k$ 倍に、右にkビットシフトすることで元の数の $2^{-k}$ 倍になる。ただしあふれたビットは捨てられるため、必ず正しい結果になるとは限らない。

### 論理シフト

**論理シフト**は最上位ビットを符号ビットとして扱わずにシフト演算を行う。符号ビットが存在しないため、負の数を扱うことはできない。

**論理右シフト**は2進数の数字列の全てのビットをそのまま右へ移動し、空いた左端のビットには0を埋める。

**論理左シフト**は2進数の数字列の全てのビットをそのまま左へ移動し、空いた右端のビットには0を埋める。

### 算術演算

**算術演算**は最上位ビットを符号ビットとして固定してシフト演算を行う。

**算術右シフト**は符号付き2進数の符号ビット以外の全てのビットをそのまま右へ移動し、空いた左端のビットには符号ビットと同じ値を埋める。

**算術左シフト**は符号付き2進数の符号ビット以外の全てのビットをそのまま左へ移動し、空いた右端のビットには0を埋める。


## 誤差

コンピュータは有限の桁数でしか数値を扱うことができないので、扱える数の範囲が決まっている。コンピュータが内部で扱う数と真の値の間に**誤差**が生じる可能性がある。

浮動小数点数は表現できる範囲の全ての値を正確に表現できるわけではないため、誤差が生じる可能性がある。10進数で表したときに有限小数であっても、2進数に変換すると無限小数となる場合もあるので注意が必要（ $0.01_{10}$ など）。

小数の計算以外でも、四則演算やシフト演算においてもオーバフローなどの誤差が発生する場合があるので注意。

### 桁落ち

**桁落ち**は値がほぼ等しい2つの数値の差を求めたときに、元の数より有効桁数が減ってしまうことで生じる誤差。次の例では、元の数の有効桁数は10桁であるが、計算後の有効桁数は2桁になっている。

```math
1.110100101 \times 2^3 - 1.110100010 \times 2^3 = 0.000000011 \times 2
```

### 情報落ち

**情報落ち**は絶対値が非常に大きい数値と小さい数値で加算や減算を行った時に、小さい数値が計算結果に反映されない誤差。次の例では、有効桁数が8桁であるとすると、計算結果に小さい方の数値が反映されない。

```math
1234.5678 + 0.0000001 = 1234.5678001 \simeq 1234.5678
```

### 丸め誤差

**丸め誤差**は数値の有効桁数の関係で切り捨て、切り上げ、四捨五入などを行うことによって下位の桁を削除することで発生する誤差。

### 打ち切り誤差

**打ち切り誤差**は無限小数などの桁が無限に続く数値を途中で打ち切ることによって八セする誤差。

### オーバフロー

**オーバフロー**（**桁あふれ**）は演算結果が決められた桁数の中で表すことができる数値の範囲を超えることで発生する誤差。例えば1バイトの整数データであれば、表現できる範囲は $-128 \sim 127$ であるが、上限である127を超える結果となるような演算を行うと発生する。

### アンダーフロー

**アンダーフロー**は浮動小数点数の演算において、演算結果の指数部が小さくなりすぎることで数値を表現できなくなるような誤差。浮動小数点数の指数部で表現可能な範囲の最小値よりも小さくなった場合に発生する。
