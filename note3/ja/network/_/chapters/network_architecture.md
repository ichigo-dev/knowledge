# 『ネットワークアーキテクチャ』

（最終更新： 2023-02-05）


## 目次

1. [ネットワークアーキテクチャ](#ネットワークアーキテクチャ)
	1. [プロトコル](#プロトコル)
	1. [インタフェース](#インタフェース)
1. [OSI基本参照モデル](#osi基本参照モデル)
	1. [ISO](#iso)
	1. [アプリケーション層](#アプリケーション層)
	1. [プレゼンテーション層](#プレゼンテーション層)
	1. [セッション層](#セッション層)
	1. [トランスポート層](#トランスポート層)
	1. [ネットワーク層](#ネットワーク層)
	1. [データリンク層](#データリンク層)
	1. [物理層](#物理層)
1. [ネットワークの基本構成要素](#ネットワークの基本構成要素)
	1. [リピータ](#リピータ)
	1. [ブリッジ](#ブリッジ)
	1. [ルータ](#ルータ)
1. [TCP/IP](#tcp-ip)
	1. [IETF](#ietf)
	1. [プロトコルスイート](#プロトコルスイート)
	1. [RFC](#rfc)
	1. [STD](#std)
	1. [FYI](#fyi)
	1. [標準化の流れ](#標準化の流れ)
	1. [アプリケーション層](#アプリケーション層-1)
	1. [トランスポート層](#トランスポート層-1)
	1. [インターネット層](#インターネット層)
	1. [データリンク層](#データリンク層-1)


## ネットワークアーキテクチャ

**ネットワークアーキテクチャ**は、通信のデータ形式やハードウェアの構成などを論理的に捉えて体系化したもの。ネットワークアーキテクチャには、各メーカが独自に用意しているものもあるが、異なる機種間の通信を実現するための標準的なネットワークアーキテクチャとしてOSI基本参照モデルが提唱されている。

### レイヤ

**レイヤ**（層）は、ネットワークアーキテクチャの中で役割をいくつかに分けたもの。

### プロトコル

**プロトコル**は、コンピュータ同士が通信を行う際の決まりごと（手順、規約）のこと。階層化されたネットワークアーキテクチャにおいては、特に通信相手の同じ階層とやり取りする際の規約のことを言う。デファクトスタンダードとなっているプロトコルの実装として、TCP/IPがある。

### インタフェース

**インタフェース**は、階層化されたネットワークアーキテクチャにおいて、上位層と下位層の間でやり取りを行う際の決まりごとのこと。


## OSI基本参照モデル

**OSI参照モデル**(OSI: Open System Interconnection)は、ISOが提唱した通信プロトコルを設計するときの指標となるモデル。通信に必要な機能を7つのレイヤに分けて役割を分担することで、ネットワークプロトコルの単純化を目的としている。

### ISO

**ISO**（International Organization for Standardization: 国際標準化機構）は、国際的な規模で規格の標準化を行うことを目的とした団体。

### アプリケーション層

**アプリケーション層**は、OSI参照モデルにおいて、アプリケーションの中で通信に関係する規約を取り決めたレイヤ。Webやファイル転送、電子メール、遠隔ログイン（仮想端末）等がある。

### プレゼンテーション層

**プレゼンテーション層**は、OSI参照モデルにおいて、アプリケーションが扱う情報を通信に適したデータ形式に変換したり、下位層から来たデータを上位層が処理できるデータ形式にしたりと、データフォーマットに関する責任を負うレイヤ。

例として、コンピュータ内部でデータをメモリ上に配置する方式で、ビッグエンディアン方式とリトルエンディアン方式という異なる表現方式がある。このようなコンピュータ内部での表現と、ネットワーク全体での共通表現を変換する。

また、文字コードも同様で、UTF-8やShift_JIS、EUP-JPなど多くの符号化形式がある。

### セッション層

**セッション層**は、OSI参照モデルにおいて、コネクション（データの流れる通信路）の確立や切断、転送するデータの切れ目の設定など、データの転送に関する管理を担うレイヤ。

セッション層よりも下位の層が実際にネットワークを使ってデータの送信処理を行っている。

### トランスポート層

**トランスポート層**は、OSI参照モデルにおいて、通信相手のアプリケーションに対して、確実にデータを届ける責任を負うレイヤ。データが正しく届いているかを確認したり、届かなかったデータを再送したりする。

### ネットワーク層

**ネットワーク層**は、OSI参照モデルにおいて、通信相手までデータを届ける役割を担うレイヤ。このレイヤでは、どのコンピュータにデータを送ったらよいのかを決定する。

### データリンク層

**データリンク層**は、OSI参照モデルにおいて、物理層で直接接続されたノード間での通信を可能にするレイヤ。直接接続された機器間でのデータのやり取りを実現する。

### 物理層

**物理層**は、OSI参照モデルにおいて、ビット列と電圧の高低や光の点滅との相互変換などを行うレイヤ。通信回線に流れる電気信号の取り決めや、接続用のケーブルやコネクタのピン形状などを規定する。


## ネットワークの基本構成要素

| 機器の名称                         | 役割                                                     |
|------------------------------------|----------------------------------------------------------|
| ネットワークインターフェース       | コンピュータをネットワークに接続するための装置           |
| リピーター(Repeater)               | ネットワークを物理層で延長する装置                       |
| ブリッジ(Bridge) レイヤ2スイッチ   | ネットワークをデータリンク層で延長する装置               |
| ルーター(Router) レイヤ3スイッチ   | ネットワーク層によってパケットを転送する装置             |
| レイヤ4-7スイッチ                  | トランスポート層より上の情報でトラフィックを処理する装置 |
| ゲートウェイ(Gateway)              | プロトコルの変換をする装置                               |

### NIC

**NIC**(Network Interface Card)は、コンピュータをネットワークに接続するときに使う部品で、MACアドレスが定められている。

### リピータ

**リピータ**は、OSI参照モデルの物理層でネットワークを延長する装置。ケーブル上を流れてきた電気信号の増幅や整形などを行う。

### ブリッジ

**ブリッジ**は、OSI参照モデルのデータリンク層でネットワークを延長する装置。アドレスの学習機能を備えたブリッジを**ラーニングブリッジ**という。

### ルータ

**ルータ**は、OSI参照モデルのネットワーク層でパケットを中継する装置。イーサネットとイーサネットや、イーサネットと無線LANといった、異なるデータリンクを相互に接続できる。ネットワークの負荷を仕切る役割や、セキュリティ機能を備えたものもある。

### レイヤ4-7スイッチ

**レイヤ4-7スイッチ**は、OSI参照モデルのトランスポート層からアプリケーションそうの情報に基づいた配送処理を行う装置。負荷分散のために複数のサーバを設置してリクエストをさばいているシステムでは、レイヤ4-7スイッチの一種であるロードバランサが利用されている。また、インターネットを経由した外部からの不正アクセスを防止するためのファイアウォールもレイヤ4-7スイッチである。

### ゲートウェイ

**ゲートウェイ**は、OSI参照モデルのトランスポート層からアプリケーション層までの階層で、データを変換して中継する装置。2つの異なるプロトコル間での翻訳作業を行う。また、ネットワークトラフィックの軽減やセキュリティ強化のために利用されるプロキシサーバは、**アプリケーションゲートウェイ**とも呼ばれる。


## TCP/IP

**TCP/IP**(Transmission Control Protocol/Internet Protocol)は、IETFで標準化されている、インターネットで使われているプロトコルスイート。TCP/IPは、OSI基本参照モデルによく似たレイヤ構造でプロトコルを体系化している。

TCP/IPは「実装すること」を念頭に作業が進められ、その方針から素早くプロトコルを完成させることができた。そのため、ISOのOSIよりも先に動作するプロトコルを作り上げることができ、世の中に普及していくこととなった。

TCP/IPでは、インターネット層とトランスポート層がOSに組み込まれていることを想定しており、その上でアプリケーションがインターネットに接続されているような構成となっている。

### IETF

**IETF**(Internet Engineering Task Force)は、インターネットやTCP/IPの技術面に関する標準化団体。

### プロトコルスイート

**プロトコルスイート**は、複数のプロトコルを一式で提供したパッケージ。

### RFC

**RFC**(Request For COmments)は、IETFによって議論されて標準化されているTCP/IPのプロトコルの仕様に関するドキュメント。一度RFCになったものは、後からその内容を改定することはできない。そのため同じプロトコルでも、内容を更新するたびに新しいRFCを発行する必要がある。

- [RFCのホームページ](https://www.rfc-editor.org/)

### STD

**STD**(Standard)は、TCP/IPの主要なプロトコルや標準に対して割り当てられた、変化しない番号のこと。RFCはプロトコルの仕様が変更されるたびに番号が変わってしまい不便であるという意見から用意された。

### FYI

**FYI**(For Your Information)は、インターネットのユーザや管理者に向けて有益な情報を提供するためのRFCドキュメント。

### 標準化の流れ

TCP/IPの標準化作業は、まず、仕様を煮詰める**インターネットドラフト**(I-D: Internet-Draft)から始まる。そして、標準化したほうが良いと認められるとRFCになり、**提案標準**(Proposed Standard)になる。次に標準の草案である**ドラフト標準**(Draft Standard)になり、最後に**標準**(Standard)となる。

### アプリケーション層

**アプリケーション層**には、標準で様々なプロトコルが規定されており、アプリケーションごとに独自のプロトコルを実装することも可能である。TCP/IPのアプリケーションの多くは、クライアント/サーバーモデルで作られている。 サービスを提供するプログラムをサーバ、サービスを受けるプログラムをクライアントとして、サーバはいつでもクライアントの要求を受け取れるように常に起動しておく（このような常に起動して用いるプログラムをデーモンと呼ぶ）。

WWWは、インターネットが一般に普及する原動力となったアプリケーションで、Webブラウザと呼ばれるソフトウェアを通して、ネットワークの中にある様々な情報を閲覧することができる。ここで、ブラウザとサーバの間の通信に用いられるプロトコルはHTTPで、送信に用いられる主なデータフォーマットはHTMLである。

電子メールは、ネットワーク上で郵便の仕組みを再現したものである。SMTPやPOP3といったプロトコルが用いられている。もともとはテキスト形式での電子メールが一般的であったが、現在は電子メールで送信できるデータ形式を拡張するMIMEの仕様が整えられた。

ファイル転送は、異なるコンピュータのハードディスク上に存在するファイルを相互に転送することができるアプリケーション。FTPというプロトコルが用いられ、ファイルの転送を指示するための制御コネクションと、実際にデータを転送するためのデータコネクションという2つのTCPコネクションを確立する。

遠隔ログインは、遠く離れたコンピュータにログインして、そのコンピュータでプログラムを走らせることができるようにするための機能。TELNETやSSHといったプロトコルがよく用いられる。また、リモートデスクトップなどを用いる際はRDPがプロトコルとして用いられる。

ネットワーク管理には、SNMPが用いられる。SNMPで管理されるルーターやブリッジ、ホストなどをエージェントといい、これらを管理するプログラムをマネージャという。エージェントは様々な情報をMIBという構造によって管理する。

### トランスポート層

**トランスポート層**は、アプリケーションプログラム間の通信を実現する役割があるレイヤ。そのため、どのプログラムがどのプログラムと通信しているかを識別するために、ポート番号と呼ばれる識別子を用いる。トランスポート層では以下の2つの代表的なプロトコルが用いられる。

TCPは、コネクション型で信頼性のある通信を実現するために用いられる。両端のホスト間でのデータの到達性を保証する。経路の途中でパケットが失われたり順番が入れ替わったりしても、TCPがそれを解決する。コネクションの確立・切断をするだけで制御のために7回もパケットをやり取りするため、データの転送量が少ない場合は無駄が多くなる。

UDPは、コネクションレス型でデータの到達に関して信頼性のないプロトコルである。送信したデータが相手に届いているかどうかの確認は行わない。パケット数が少ない通信や、ブロードキャストやマルチキャスト通信、ビデオや音声などのマルチメディア通信に向いている。

### インターネット層

**インターネット層**（**ネットワーク層**）の代表的なプロトコルはIPで、IPアドレスをもとにしてパケットを転送する役割を担う。

IPは、ネットワークをまたいでパケットを配送し、インターネット全体にパケットを送り届けるためのプロトコル。それぞれのホストを識別するために、IPアドレスと呼ばれる識別子を用いる。

ICMPは、IPパケットの配送中に何らかの異常が発生してパケットを転送できなくなったときに、送信元に異常を知らせるために用いられるプロトコル。

ARPは、パケットの送り先のMACアドレスをIPアドレスから取得するプロトコル。

### データリンク層

**データリンク層**（**ネットワークインタフェース層**）は、データフレームをネットワーク上で隣接するコンピュータに転送する役割をもつレイヤ。

具体的には、NICを動かすためのデバイスドライバのこと。OSがNICを認識して、そのカードを利用できるように設定する必要がある。
