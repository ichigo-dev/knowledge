# 『関数』

（最終更新： 2023-01-29）


## 目次

1. [関数](#関数)
	1. [引数](#引数)
	1. [戻り値](#戻り値)
	1. [関数定義](#関数定義)
	1. [関数呼び出し](#関数呼び出し)


## 関数

**関数**（**サブルーチン**、**プロシージャ**）は、データを受け取り、定められた特定の処理を実行して、その結果を返す命令ブロックのこと。関数にはプログラマが任意の識別子をつけることができる（ `main` 関数のような特別な意味を持つ関数については除く）。関数につけられた識別子をソースコード中に記すことで、その命令ブロックを呼び出すことができる。

関数を用いることで、プログラムの再利用性やメンテナンス性が向上するという利点がある。

### 引数

**引数**は、関数が呼び出されるときに、関数の呼び出し元から受け取るデータ。関数を定義する際には、受け取る情報に任意の識別子を用いた**仮引数**を用いて処理を記述する。関数呼び出しの際に実際に処理したい情報を**実引数**として関数に渡すことで、仮引数部分がデータに置き替えられて処理が実行される。

引数は複数受け取ることも可能。また、仮引数にデフォルト値を指定しておくことで、関数呼び出しの際に実引数を渡さなかった場合にデフォルト値で置き替えて処理を実行することもできる。このような引数を**オプション引数**（**任意引数**）という。関数定義の際に引数を固定せず、呼び出し側で任意の数の引数を渡して処理を実行するような、**可変長引数**をサポートしている言語もある（文字列のフォーマットなどによく利用される）。

### 戻り値

**戻り値**は、関数の命令ブロックが実行された結果として、関数の呼び出し元に返されるデータ。関数の戻り値は `return` キーワードを用いて記述する。戻り値は通常1つしか返すことができないため、複数の値を返したいような場合には、値をオブジェクトとして返却したり、引数として受け取ったポインタに直接結果を書き込んだりする。

関数内部で宣言されたローカル変数（局所変数）は、関数の処理ブロック内部のみで有効な変数であり、戻り値として使用するには注意が必要となる。戻り値として返却されるデータがプリミティブ型の場合はデータがディープコピーされるが、複合型の値を返却しようとした場合にシャローコピーが発生する可能性がある。このような場合、ローカル変数は関数の実行が終了されると破棄されるため、戻り値がダングリングポインタとなってしまう場合がある。そのため、明示的に確保したメモリに格納したデータのポインタを返却したり、引数として受け取ったポインタに直接データを格納したりといった工夫が必要となる。

### 関数定義

**関数定義**には、関数につけられた識別子、処理内容、仮引数リスト、戻り値を記述する。

```c
// C言語

// 関数定義
int add( int a_, int b_ )
{
    int result = a_ + b_;
    return result;
}
```

```php
<?php

// PHP

// 関数定義
function add( $a_, $b_ )
{
    $result = $a_ + $b_;
    return $result;
}

?>
```

```javascript
// JavaScript

function add( a_, b_ )
{
    let result = a_ + b_;
    return result;
}
```

### 関数呼び出し

**関数呼び出し**（**コール**、**キック**）では、関数の識別子を記述して処理を引用し、仮引数リストに対応した実引数を渡す。

```c
// C言語

// 関数プロトタイプ宣言
int add( int, int );

// メイン関数
int main()
{
    int a = 5;
    int b = 10;

    // 関数呼び出し
    int result = add(a, b);
    printf("Result: %d\n", result);

    return 0;
}

// 関数定義
int add( int a_, int b_ )
{
    int result = a_ + b_;
    return result;
}
```

```php
<?php

// PHP

// 関数定義
function add( $a_, $b_ )
{
    $result = $a_ + $b_;
    return $result;
}

$a = 5;
$b = 10;

// 関数呼び出し
$result = add($a, $b);
echo("Result: " . $result);

?>
```

```javascript
// JavaScript

// 関数定義
function add( a_, b_ )
{
    let result = a_ + b_;
    return result;
}

let a = 5;
let b = 10;

// 関数呼び出し
let result = add(a, b);
console.log("Result: " + result);
```
