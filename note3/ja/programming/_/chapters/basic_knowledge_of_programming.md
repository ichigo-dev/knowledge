# 『プログラミングの基礎知識』

（最終更新： 2023-01-24）


## 目次

1. [プログラミング](#プログラミング)
	1. [ソースコード](#ソースコード)
1. [機械語](#機械語)
	1. [オペコード](#オペコード)
1. [低水準言語](#低水準言語)
	1. [アセンブリ言語](#アセンブリ言語)
	1. [アセンブル](#アセンブル)
	1. [アセンブラ](#アセンブラ)
1. [高水準言語](#高水準言語)
	1. [コンパイル](#コンパイル)
	1. [コンパイラ](#コンパイラ)
	1. [コンパイラ言語](#コンパイラ言語)
	1. [インタプリタ言語](#インタプリタ言語)
	1. [JITコンパイラ](#jitコンパイラ)
	1. [スクリプト言語](#スクリプト言語)
	1. [静的型付け言語](#静的型付け言語)
	1. [動的型付け言語](#動的型付け言語)
1. [プログラムの基礎と文法](#プログラムの基礎と文法)
	1. [文法](#文法)
	1. [コメント](#コメント)
	1. [エラー](#エラー)
	1. [例外](#例外)
	1. [バグ](#バグ)
	1. [デバッグ](#デバッグ)
	1. [未定義動作](#未定義動作)
	1. [識別子](#識別子)
	1. [予約語](#予約語)
1. [プログラムのメモリ管理](#プログラムのメモリ管理)
	1. [ヒープ領域の確保と解放](#ヒープ領域の確保と解放)
	1. [メモリリーク](#メモリリーク)
	1. [ダブルフリー](#ダブルフリー)
	1. [ダングリングポインタ](#ダングリングポインタ)
	1. [ガベージコレクション](#ガベージコレクション)
1. [プログラミングを始める](#プログラミングを始める)


## プログラミング

**プログラミング**は、コンピュータが処理を行う手順や内容を示したもの。プログラムを書く人のことを**プログラマ**、プログラムを実装することを**プログラミング**という。プログラムを記述する際には様々な**プログラミング言語**が用いられる。プログラミング言語に対して、人間が日常生活で用いる言語のことを**自然言語**という。

プログラマには、世の中の様々なタスクや問題をプログラミングによって解決するという役割がある。毎日の単純作業のくり返しを減らしたり（表計算ソフトなど）、ミスが許されない場面で正確に動作することが保証されたシステムを利用したり（銀行のシステムや信号機など）、さらに人間には難しいタスクの解決を行ったり（AIによる異常検知など）と、プログラミングスキルの応用範囲は多岐にわたる。

### ソースコード

**ソースコード**（**ソース**、**コード**）は、プログラミング言語で書かれたプログラムのこと。


## 機械語

**機械語**（**マシン語**、**オブジェクトコード**、**ネイティブコード**）は、コンピュータが直接解釈できるプログラムで、2進数の羅列からなる。機械語は次の例のようなプログラムとなっており、人間が記述したり内容を理解するのには適していない。そのため、人間が理解しやすいようにプログラミング言語を用いてソースコードを作成し、専用のプログラムによってソースコードを機械語の変換するのが一般的。プロセッサごとに対応する機械語も異なるので注意が必要。

```
0111 1111 0100 0101 0100 1100 0100 0101 0000 0010 0000 0001 0000 0001 0000 0000
0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000
0000 0010 0000 0000 0011 1110 0000 0000 0000 0001 0000 0000 0000 0000 0000 0000
0000 0000 0000 0000 0000 0100 0100 0000 0000 0000 0000 0000 0000 0000 0000 0000

...(以下略)
```

### オペコード

**オペコード**は、プロセッサに与える機械語の命令の識別番号。


## 低水準言語

**低水準言語**（**低級言語**）は、プログラミング言語の中でも機械語に近い言語のこと。低水準言語はコンピュータン資源を効率よく使うことができ、高速に動作するという利点があるが、プログラムが長くなりやすく柔軟性が乏しいことから、組込みやファームウェアの分野などの性能を最大限引き出すなどの目的がない限りは高水準言語が用いられることがほとんどとなる。

### アセンブリ言語

**アセンブリ言語**は、ニーモニックという命令を組み合わせて記述するプログラミング言語。**ニーモニック**は、機械語の命令に1対1で対応する、英単語や記号で表記した命令のこと。プロセッサごとに対応するアセンブリ言語も異なるので注意が必要。

アセンブリ言語の一種である**Netwide Assembler**を用いて `Hello, world` を出力するプログラムを以下に示す。

```asm
section .data
    msg db      "Hello, world"      ; データセクションで文字列を宣言

section .text
    global _start                   ; プログラムのエントリポイントとして_startを呼び出し

_start:
    mov     rax, 1                  ; sys_writeシステムコール(1)をraxレジスタにセット
    mov     rdi, 1                  ; 第一引数（ファイルディスクリプタ、1は標準出力）をrdiレジスタにセット
    mov     rsi, msg                ; 第二引数（出力したい文字列）をrsiレジスタにセット
    mov     rdx, 12                 ; 第三引数（データのサイズ）をrdxレジスタにセット
    syscall                         ; システムコールを発行
    mov     rax, 60                 ; exitシステムコール(60)をraxレジスタにセット
    mov     rdi, 0                  ; 第一引数（終了コード、0は正常終了）をrdiレジスタにセット
    syscall                         ; システムコールを発行
```

### アセンブル

**アセンブル**は、アセンブリ言語で書かれたプログラムを機械語に変換する操作。

### アセンブラ

**アセンブラ**は、アセンブルを行うためのソフトウェア。


## 高水準言語

**高水準言語**（**高級言語**）は、低水準言語に比べて抽象度が高く、人間にとってわかりやすいプログラミング言語のこと。機械語を意識することなく記述することができ、プロセッサに依存しないプログラム（機械語への変換の段階で様々なプロセッサに対応させることができるため）を作ることができる。

代表的な高水準言語としては、C系言語（C, C#, C++等）やJava、Python、PHP、JavaScriptなどがある。それぞれの言語には得手不得手があり、C言語であれば処理速度が高速であることからCPUやサーバなどの低レイヤの実装に向いており、JavaScriptであれば一般的なWebブラウザで動作することからWebフロントエンド向けとなっている。

高水準言語は種類が多く、ソースコードのコンパイル・実行方式や、データ型の決定方式などによって分類することができる。

### コンパイル

**コンパイル**は、高水準言語で書かれたソースコードを機械語に変換する操作。

### コンパイラ

**コンパイラ**は、コンパイルを行うためのソフトウェア。

### コンパイラ言語

**コンパイラ言語**は、プログラムを実行する前にあらかじめコンパイルを行う方式の言語。プログラムを利用する際には、機械語に変換された実行ファイルを実行する。

事前にコンパイルを済ませているため、実行前に不具合を発見できたり、実行時のコンパイルコストがないため実行速度が速いといった利点がある。一方で、実行時に起こりうる様々なパターンに対応できるようにプログラミングする必要があり、インタプリタ言語と比較しても難易度が高い言語が多い。また、コンパイル済みの実行ファイルはプロセッサに依存するため、マルチプラットフォームに対応できないという欠点もある（それぞれのプラットフォーム用にコンパイルする必要がある）。

代表的なコンパイラ言語には、C言語やSwift、Go、Rustといったものがある。

### インタプリタ言語

**インタプリタ言語**は、プログラムの実行時にソースコードを1行ずつコンパイルしながら処理を進める方式の言語。実行時に毎回コンパイルを行うコストが発生するため、実行速度はコンパイラ言語に劣る。しかし、コンパイルを行わずに実行結果をすぐに確認できるため、デバッグが容易で、開発にかかるコストは小さくなる。

代表的なインタプリタ言語には、PythonやPHP、JavaScript、Rubyなどがある。

### JITコンパイラ

**JITコンパイラ**(Just-In Time Compiler)は、ソースコードを環境に依存しない**中間コード**（**バイトコード**）に変換しておき、実行時にバイトコードをコンパイルして実行する方式をとる。実行時にコンパイルする点ではインタプリタ言語と似ているが、インタプリタ言語より高速に動作する。また、コンパイラ言語では直接機械語のコードを生成するため、プログラムが実行環境に依存してしまうが、この方式ではプログラムの実行機であるランタイム（フレームワーク）が利用できる環境であればひとつの中間コードで実行できるというメリットもある。

JITコンパイラを用いる代表的な言語には、JavaやC#などがある。

### スクリプト言語

**スクリプト言語**は、プログラミング言語のうち比較的容易に記述・実行ができる言語。定義は曖昧であるが、プログラミングの初級者にとっても学びやすく、開発スピードが早いため小規模な開発に向いている。インタプリタ言語はスクリプト言語に分類されることが多く、PythonやPHP、JavaScript、Rubyなどがインタプリタ言語に含まれる。

### 静的型付け言語

**静的型付け言語**は、実行前にデータの型を決定する方式の言語。コンパイラ言語の多くは静的型付け言語となっており、プログラム中で使用するデータに対して、そのデータをどの型として扱うかを明示（**型注釈**）する必要がある。事前にデータの型を確定させておくことで、想定外の処理が行われることによる不具合を減らすことができるなど、プログラムの信頼性が向上する。

また、RustやGoのような新しい静的型付け言語では、ソースコード中に型を明示せずとも、コンパイラが文脈から自動的に型を判断する**型推論**の機能が搭載されているものもあり、ソースコードの記述量が増え冗長になるという静的型付け言語の欠点を軽減できる。

### 動的型付け言語

**動的型付け言語**は、実行時にデータの型を決定する方式の言語。型を明示する必要はなく、コンパイラが文脈から全てのデータの型を自動的に判断する。ソースコードがシンプルになり読みやすくなる一方で、データが読み込まれるたびにそのデータの型を推測する必要があるため、実行速度は静的型付け言語に劣る。また、データが想定していない型として扱われる可能性もあるため注意する必要がある。

実行時に型を決定するという抽象化の性質から、関数がとる引数の型も柔軟に判断することができるため、同じインタフェースを持つ異なるオブジェクトをひとつの関数で扱える。これを利用したプログラミングスタイルとしてダックタイピングがある。

### 汎用プログラミング言語

**汎用プログラミング言語**は、広い用途で利用される高水準言語。

### 専用プログラミング言語

**専用プログラミング言語**は、限られた分野で活躍する高水準言語。


## プログラムの基礎と文法

### 文法

**文法**（**シンタックス**）は、各プログラミング言語が規定しているプログラムの書き方。文法が誤っていると、コンパイラがソースコードを正しく解析できず、エラーとなる。プログラミング言語の文法は、自然言語の文法に比べて非常に厳密であるため、プログラミングを行うときには常に正しい文法を心掛けなくてはならない。

文法は言語ごとに様々であるが、例として次のようなものがある。

- プログラムは半角アルファベットと数字、各種記号によって記述する
- `{` と `}` は対応しており、 `{}` で囲まれた部分は処理のひとつのまとまりを表す
- ひとつの文は `;` で終わらなければならない
- プログラムは上から下へと順次実行される

### コメント

**コメント**（注釈）は、ソースコード中でコンパイル時に無視される部分のこと。プログラムの内容や補足を記述したり、一時的に無効化したいプログラムを**コメントアウト**したりといった使い方がある。

一般的なプログラミング言語におけるコメントの書き方は次のようになっている。

```
; アセンブリ言語などで用いられる1行のコメント

// 高水準言語で良く用いられる1行のコメント

/*

    高水準言語でよく用いられる
    複数行に対応したコメント

*/
```

### エラー

**エラー**は、コンパイル時・実行時にプログラムが正常に処理を続行できなくなるような致命的な問題の発生により中断・終了されることを指す。シンタックスの誤りや、アルゴリズムのバグ（プログラムの欠陥）等により発生する。

代表的なエラーには次のようなものがある。

- **ゼロ除算**（整数を0で割るような演算を試みた）
- 配列の要素数より大きいインデックスにアクセスを試みた
- 存在しないファイルを参照しようとした
- ユーザが想定外の入力を行った
- データベースやサーバへの接続に失敗した

### 例外

**例外**は、プログラミング言語が想定可能なエラーのことで、例外発生時の処理をソースコード中に記述しておくことができる。プログラムが想定できないエラーが発生した場合は、プログラムがOSによって強制的に終了される。

### バグ

**バグ**は、プログラム上の誤りや不具合。文法上のエラーや、エラーではないもののプログラムが仕様通りに動作しないような欠陥のことをいう。

### デバッグ

**デバッグ**は、プログラムのバグを見つけて修正すること。

### 未定義動作

**未定義動作**は、プログラミング言語の仕様において動作が予測できないと規定されているプログラムを実行した結果のことで、C言語やC++といった言語ではいくつかの未定義動作が定められている。未定義動作を設けることにより、パフォーマンスの高いコンパイラを作成することが容易になる。一方で、未定義動作はプログラムのバグである可能性が高く、実行環境によって結果が変わることもあるため発見が難しい。

### 識別子

**識別子**は、ソースコード中でデータや処理のまとまりに対してプログラマがつける名前のこと。識別子には、そのデータの性質や状態、役割を表す名前をつけるのが一般的。

識別子の命名に関しては、各プログラミング言語ごとにルールが存在する。次に示すのは、多くのプログラミング言語に共通しているルールの一部。

- 変数名にはアルファベット、数字、アンダースコアが使用できる
- アルファベットの大文字と小文字は区別される
- 1文字目はアルファベットかアンダースコアが使用できる（数字から始まる変数名は使用できない）
- 予約語は使用できない（予約語を含む変数名は使用できる）
- 識別子中にスペースを含むことはできない（複数の単語からなる識別子において、単語間にスペースを用いるなど）

プログラミングにおいて良い識別子を命名することは、ソースコードの可読性やメンテナンス性を向上させるために非常に重要である。言語ごとのコミュニティや開発チームごとのルール・文化に従い、一般的な単語を用いた、誰が見てもわかりやすい識別子を心掛けるべきである。

### 予約語

**予約語**は、各プログラミング言語において規定されている、識別子として利用できない文字列。データの型や制御構文に用いられる単語などがこれにあたり、プログラムの構文解析の妨げになるなどの理由から使用できなくなっている。また、将来的にプログラミング言語に取り入れられる予定の機能に関するキーワードも予約語となっている場合もある。

予約語ではなくとも、他のプログラミング言語で予約語になっているものや、将来的に使用できなくなる可能性のある文字列は識別子としてふさわしくないので、避けた方がよい。

以下に示すのは、C言語の予約語の一部。

```c
auto, break, case, char, const, continue, default, do, double, else, enum,
extern, float, for, goto, if, int, long, register, return, signed, sizeof,
...
```


## プログラムのメモリ管理

プログラム中で用いられる変数や関数は、プログラムに割り当てられたメモリ領域内に格納される。グローバル変数は静的領域に、関数内で使用されるローカル変数はスタック領域に、配列やオブジェクトといった可変長のデータの実体はヒープ領域に格納される。

### ヒープ領域の確保と解放

スタック領域に格納された変数は、関数の実行が完了すると自動的に解放されるが、ヒープ領域に格納したデータは別の手段により解放する必要がある。ヒープ領域のデータを解放する手段はプログラミング言語によって異なる。C言語やC++では、プログラマが明示的にソースコード中でヒープ領域の確保・解放を宣言する必要があり、そのほかのほとんどのプログラミング言語ではガベージコレクションを用いる。また、Rust言語ではガベージコレクションを用いずにメモリの解放に関する一定のルールを設けることで、プログラマがメモリ管理に関する責任を負わなくてよいようにしている。

### メモリリーク

**メモリリーク**は、プログラムが使い終わったメモリの解放を忘れることで、使用できなくなるメモリ領域ができてしまうこと。メモリ管理に関するバグの一種。

### ダブルフリー

**ダブルフリー**（メモリの二重解放）は、既に解放されたヒープ領域のメモリを、再度解放しようとすること。メモリ管理に関するバグの一種。

### ダングリングポインタ

**ダングリングポインタ**は、ヒープ領域に格納されたデータのアドレスを格納したスタック領域のポインタにおいて、既に解放されたヒープ領域を指し示すポインタのこと。メモリ管理に関するバグの一種。

### ガベージコレクション

**ガベージコレクション**（**GC**）は、ヒープ領域のデータを定期的に確認し、不要になったデータを解放するプログラム。ガベージコレクションを用いる場合、ソースコード中でヒープ領域の解放を明示する必要はない。

メモリリークやダブルフリー、ダングリングポインタといったメモリに関するバグを回避するこおとができる。ただし、プログラマ自身がメモリ管理をするプログラミング言語に比べてパフォーマンスは低く、プログラムの実行に関係のないソフトウェア（ガベージコレクション）を動作させる必要があるというデメリットがある。また、ガベージコレクションが動くタイミングでソフトウェアの動作が遅くなる可能性がある。


## プログラミングを始める

プログラミングを始めるために必要なものは、各種プログラミング言語の実行環境と、プログラムを記述するためのテキストエディタのみで、基本的には特別なものは必要としない。**実行環境**は、プログラムをコンパイルして実行するための環境のこと。**テキストエディタ**には、プログラミングを便利に行うための補助機能を提供するものや、実行環境が搭載された**統合開発環境**など様々なものがあるが、PCにデフォルトでインストールされているようなもの（Windowsのメモ帳など）でも問題ない。代表的なテキストエディタには次のようなものがある。

- [サクラエディタ](https://sakura-editor.github.io/)
- [秀丸エディタ（有料）](https://hide.maruo.co.jp/software/hidemaru.html)
- [Visual Studio Code](https://code.visualstudio.com/)
- [Neovim](https://neovim.io/)
