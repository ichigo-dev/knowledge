# 『Gitの基礎知識』

（最終更新： 2023-02-01）


## 目次

1. [バージョン管理システム](#バージョン管理システム)
	1. [集中管理方式](#集中管理方式)
	1. [分散管理方式](#分散管理方式)
1. [Git](#git)
	1. [作業の流れ](#作業の流れ)
	1. [ワーキングディレクトリ](#ワーキングディレクトリ)
	1. [ステージング](#ステージングワーキングディレクトリ)
	1. [ローカルリポジトリ](#ローカルリポジトリ)
	1. [リモートリポジトリ](#リモートリポジトリ)
1. [基本用語](#基本用語)
	1. [リポジトリ](#リポジトリ)
	1. [ベアリポジトリ](#ベアリポジトリ)
	1. [ノンベアリポジトリ](#ノンベアリポジトリ)


## バージョン管理システム

**バージョン管理システム**(**VCS**: Version Control System)は、ファイルの変更履歴を管理するためのシステム。プログラムのソースコードやドキュメントなどの電子ファイルは、通常は段階を経て編集されていく。バージョン管理システムを用いることで、ファイルの編集の過程を履歴として記録し、ファイルの過去の状態を確認したり、その時の状態に戻したりすることができるようになる。また複数人で同じファイルを編集したいような場合に、ファイルの同じ行を変更してしまうことによる競合などの問題が発生する可能性があるが、バージョン管理システムはこのような状況を解決する仕組みも持っているものも多い。バージョン管理システムはプログラムの開発にとどまらず、電子データを扱う全てのケースで活用できるツールである。

### 集中管理方式

**集中管理方式**（**集中型**）のバージョン管理システムでは、バージョン管理のための専用サーバにリポジトリを用意しておき、そのサーバ上で履歴を一元管理する。ユーザはサーバから自身のコンピュータにファイルのコピーをダウンロードし、変更を加えたらその変更をサーバ上のリポジトリに記録する。

ユーザはネットワークに繋がっていない状態だと、変更を記録することができない。また、サーバが単一障害点となっており、サーバ上のリポジトリが破損するとデータが復旧できない可能性がある。

集中管理方式のバージョン管理システムとしては、**CVS**や**SVN**が代表的。

### 分散管理方式

**分散管理方式**（**分散型**）のバージョン管理システムでは、全ユーザの変更を集約する中央サーバにリポジトリを設置し、個々の作業用コンピュータには疎のリポジトリの複製（ローカルリポジトリ）を作成する。変更履歴の管理は各々のローカルリポジトリ上で行われ、リモートリポジトリと同期することで変更内容を共有する。

ユーザはネットワークに接続されていなくてもローカルリポジトリ上でほとんどの操作を行うことができる。また、各コンピュータ上にリポジトリの複製が存在するため、中央サーバのリポジトリが破損した場合の復旧が容易である。

分散管理方式のバージョン管理システムとしては、**Git**や**Mercurial**が代表的。


## Git

**Git**は、開発におけるデファクトスタンダードとなっている分散型バージョン管理システム。もともとはLinuxの開発のためにLinus Torvaldsによって実装され、巨大なソースコードであっても変更点の抽出やリポジトリ操作が高速にできるように工夫されている。

### 作業の流れ

Gitを用いたバージョン管理の一般的な流れは次の通り。

1. 中央サーバに全体の履歴を集約するリポジトリを作成する
1. リモートリポジトリの複製をローカルリポジトリとして各ユーザの作業コンピュータに作成する
1. ローカル環境にてファイルの修正や追加、削除などを行い、ローカルリポジトリに変更履歴を記録する
1. ローカルリポジトリの変更履歴をリモートリポジトリに反映する
1. 他のユーザがリモートリポジトリに加えた変更内容をローカルリポジトリに反映し、最新の状態にする
1. 3～5を繰り返し、バージョン管理を行う

### ワーキングディレクトリ

**ワーキングディレクトリ**（**ワーキングツリー**）は、ファイルの編集作業を行うディレクトリ。この領域での変更内容はまだリポジトリに記録されていない状態となる。

### ステージング

**ステージングエリア**（**インデックス**）は、変更履歴を作成するための中間領域。コミットに含めたいファイルやディレクトリは一時的にステージングエリアに移動する必要がある。

### ローカルリポジトリ

**ローカルリポジトリ**は、実際にコミット履歴が記録される領域。コミットしただけではリモートリポジトリには反映されず、あくまで自身のローカル環境でのみ履歴として追加される。また、複数のリモートリポジトリと紐づけることも可能。基本的にはノンベアリポジトリで運用される。

### リモートリポジトリ

**リモートリポジトリ**は、各ユーザのローカルリポジトリの変更を集約し、全体のコミット履歴を管理する領域。インターネットやサーバ上に用意するリポジトリで、開発者間で変更内容を共有したり、開発したプログラムをOSSとして公開するために用いられる。基本的にはベアリポジトリで運用される。


## 基本用語

### リポジトリ

**リポジトリ**は、コミットの履歴を管理する場所（ディレクトリ）や、履歴管理のデータ構造のこと。リポジトリ配下に設置されたファイルやディレクトリは、変更の履歴が記録されるようになる。

### ベアリポジトリ

**ベアリポジトリ**は、ワーキングディレクトリを持たず、更新履歴だけを持っているリポジトリのこと。

### ノンベアリポジトリ

**ノンベアリポジトリ**は、ワーキングディレクトリを持つ作業用のリポジトリのこと。

### ハンク

**ハンク**は、ファイル内の変更を加えた差分ブロックのこと。

### コミット

**コミット**は、ファイルやディレクトリの変更履歴を記録する操作、あるいはその変更履歴のこと。リポジトリの変更履歴は**リビジョン**と呼ぶ場合もある。Gitではコミットごとの差分のみを記録するのではなく、毎回全てのファイルの**スナップショット**（ある時点でのソースコードやファイル、ディレクトリなどの状態を抜き出したもの）を作成しているため、古いリビジョンのファイルでも高速に再現することができる。

### クローン

**クローン**は、リモートリポジトリの複製をローカルに作成する操作のこと。基本的にはプロジェクトに加わった際に、最初に1度だけ実行する操作であり、それ以降のリモートリポジトリからの差分の取得にはフェッチやプルを用いる。

また、クローン元となったリモートリポジトリは、ローカルリポジトリに `origin` というエイリアスで登録される。
