# 『2進数による数値の表現』ノート

（最終更新： 2023-09-29）


## 目次

1. [数の正負](#数の正負)
	1. [符号ビット](#符号ビット)
	1. [補数](#補数)
	1. [2の補数](#2の補数)
	1. [補数の減算](#補数の減算)
1. [小数](#小数)
	1. [固定小数点数](#固定小数点数)
	1. [浮動小数点数](#浮動小数点数)
1. [10進数の表現](#10進数の表現)
	1. [BCDコード](#bcdコード)
	1. [ゾーン10進数](#ゾーン10進数)
	1. [パック10進数](#パック10進数)


## 数の正負

### 符号ビット

**符号ビット**は、[2進数](./radix.md#2進数)で表された数において数の正負を意味する[ビット](../../../_/chapters/computer_and_number.md#ビット)。一般的には、[最上位ビット](../../../_/chapters/computer_and_number.md#msb)を符号ビットとし、符号ビットが $0$ ならば正の数、 $1$ ならば負の数として扱う。

### 補数

**補数**は、[n進数](./radix.md#基数)のある数に対して足し合わせることでちょうど $n$ のべき乗（あるいは $n$ のべき乗から1を引いたもの）になる自然数のうち、最小のもの。言い換えると、ある数に足し合わせることで桁が1つ上がる最小の数。例として、 $560_{10}$ に対する補数は $440_{10}$ （ $560_{10} + 440_{10} = 1000_{10}$ となるため）となる。

補数を使用することで、負の数の表現や演算が容易になるため、[コンピュータ](../../../../computer/_/chapters/computer.md#コンピュータ)の[プログラム](../../../../programming/_/chapters/programming.md#プログラム)や回路設計において重要な概念となっている。

### 2の補数

**2の補数**は、[2進数](./radix.md#2進数)において負の数を表現する際に用いられる表現方法。[2進数](./radix.md#2進数)では、[符号ビット](#符号ビット)を含めた全ての[ビット](../../../_/chapters/computer_and_number.md#ビット)を反転したものが**1の補数**（ある数に対して足し合わせても桁が上がらない最大の数）となるので、それに1を加算することで求めることができる。

2の補数を使用する理由は、1の補数を用いるよりも表現できる数の範囲が $1$ 広いためである。n[ビット](../../../_/chapters/computer_and_number.md#ビット)の[2進数](./radix.md#2進数)が表現できる数の範囲は、1の補数を用いた場合は $-(2^{n-1} - 1) \sim (2^{n-1} - 1)$ 、2の補数を用いた場合は $-2^{n-1} \sim (2^{n-1} - 1)$ となる。これは1の補数では $0$ が正と負の2種類存在してしまうためであり、通常はこれらを区別する必要はないため、2の補数が利用される。

### 補数の減算

[補数](#補数)を用いた場合、減算を加算により表現することができる。例えば次のような[10進数](./radix.md#10進数)の減算を考える。

$$
900_{10} - 350_{10} = 550_{10}
$$

$350_{10}$ の[補数](#補数)は $650_{10}$ なので、 $900_{10}$ に[補数](#補数)を加算してみる。

$$
900_{10} + 650_{10} = 1550_{10}
$$

この結果から最上位の桁を取り除くと、減算と同じ結果が得られることがわかる。このような性質は[2進数](./radix.md#2進数)であっても同様に成り立つ。

前の例を[2進数](./radix.md#2進数)で考える。それぞれの数を[2進数](./radix.md#2進数)12桁で表すと、 $900_{10} = 001110000100_2, 350_{10} = 000101011110_2$ となる。 $350_{10} = 000101011110_2$ の各[ビット](../../../_/chapters/computer_and_number.md#ビット)を反転すると $111010100001_2$ （[1の補数](#2の補数)）となり、これに $1$ を加えると $111010100010_2$ （[2の補数](#2の補数)）となる。 $900_{10} = 001110000100_2$ に $350_{10} = 000101011110_2$ の[2の補数](#2の補数)を加えると次のようになる。

$$
\begin{array}{rr}
  &  001110000100 \\
+ &  111010100010 \\
\hline
  & 1001000100110
\end{array}
$$

得られた結果の[最上位ビット](../../../_/chapters/computer_and_number.md#msb)を無視した $001000100110_2$ は、[10進数](./radix.md#10進数)の $550_{10}$ であるから正しく減算できていることがわかる。


## 小数

### 固定小数点数

**固定小数点数**は、[コンピュータ](../../../../computer/_/chapters/computer.md#コンピュータ)上で小数を表現する方法のひとつで、整数部と小数部の桁数をあらかじめ決めておいて、それぞれを固定した[ビット](../../../_/chapters/computer_and_number.md#ビット)幅で表現する数値。あらかじめ小数点の位置を決めておくので扱いやすい一方で、表現できる数値の範囲が限定されてしまう。一方で、[浮動小数点数](#浮動小数点数)よりも高速で処理できるという利点がある。

### 浮動小数点数

**浮動小数点数**は、[コンピュータ](../../../../computer/_/chapters/computer.md#コンピュータ)上で小数を表現する方法のひとつで、桁の並びを表す仮数部と、小数点の位置を表す指数部を用いて数を表現する。限られた[バイト](../../../_/chapters/computer_and_number.md#バイト)数の中で効率よく小数を表現するための方法で、[固定小数点数](#固定小数点数)に比べて同じ[ビット](../../../_/chapters/computer_and_number.md#ビット)数でも広い範囲の数を表すことができる。

浮動小数点数では数を $\rm{数値} = (\rm{符号部}) \rm{仮数部} \times \rm{基数部}^{\rm{指数部}}$ の形式で考える。

- **基数部**は[2進数](./radix.md#2進数)であれば必ず $2$ となる（[n進数](./radix.md#基数)では $n$ となる）
- **符号部**は[数の正負](#数の正負)を表す
- **指数部**には[基数](./radix.md#基数)に対する指数部分を[2進数](./radix.md#2進数)で表記したものを格納する
- **仮数部**には正規化した小数点数以下の値を格納する

小数点数の演算では精度が重要になるため、仮数部で有効桁数を確保して指数部で大きさを表現する。仮数部の[最上位ビット](../../../_/chapters/computer_and_number.md#msb)が $0$ にならないように仮数部と指数部を調整することで有効桁数を最大にすることを、**正規化**という。

[IEEE754](https://ja.wikipedia.org/wiki/IEEE_754)によって規定された浮動小数点数には単精度形式と倍精度形式があり、**単精度形式**では32[ビット](../../../_/chapters/computer_and_number.md#ビット)（符号部1[ビット](../../../_/chapters/computer_and_number.md#ビット)、指数部8[ビット](../../../_/chapters/computer_and_number.md#ビット)、仮数部23[ビット](../../../_/chapters/computer_and_number.md#ビット)）、**倍精度形式**では64[ビット](../../../_/chapters/computer_and_number.md#ビット)（符号部1[ビット](../../../_/chapters/computer_and_number.md#ビット)、指数部11[ビット](../../../_/chapters/computer_and_number.md#ビット)、仮数部52[ビット](../../../_/chapters/computer_and_number.md#ビット)）で表現する。


## 10進数の表現

[コンピュータ](../../../../computer/_/chapters/computer.md#コンピュータ)では通常、[キーボード](../../../../computer/hardware/_/chapters/io_unit.md#キーボード)から入力される数字は文字として認識される。これを数値として扱う場合、[2進数](./radix.md#2進数)の数値に変換するのが一般的であるが、変換の際に生じる[誤差](./arithmetic_operation_and_precision.md#誤差)が許されないような高い精度が求められる計算では、[パック10進数](#パック10進数)等のより精密な表現方法が選択されることがある。

### BCDコード

**BCDコード**(Binary Coded Decimal)は、[10進数](./radix.md#10進数)の1桁を[2進数](./radix.md#2進数)の4桁（1[ビット](../../../_/chapters/computer_and_number.md#ビット)=1ニブル）に対応させて表現する符号化形式。これは、数字を表すコードの基本となっている。

BCDコードは[10進数](./radix.md#10進数)を直接扱うことができるため、[10進数](./radix.md#10進数)の計算を行う際に、[丸め誤差](./arithmetic_operation_and_precision.md#丸め誤差)を気にする必要がなくなる。

| 10進数 | BCDコード |
| -----: | --------: |
|    $0$ |    $0000$ |
|    $1$ |    $0001$ |
|    $2$ |    $0010$ |
|    $3$ |    $0011$ |
|    $4$ |    $0100$ |
|    $5$ |    $0101$ |
|    $6$ |    $0110$ |
|    $7$ |    $0111$ |
|    $8$ |    $1000$ |
|    $9$ |    $1001$ |

### ゾーン10進数

**ゾーン10進数**（**アンパック10進数**）は、[10進数](./radix.md#10進数)を1[バイト](../../../_/chapters/computer_and_number.md#バイト)で表現する方法で、上位4[ビット](../../../_/chapters/computer_and_number.md#ビット)（**ゾーン部**）は文字コードの種類や特別な情報を表し、下位4[ビット](../../../_/chapters/computer_and_number.md#ビット)は数値を表す[BCDコード](#bcdコード)が入る。また、最下位桁のゾーン部は符号部として使用される。

[JISコード](../../../information_theory/_/chapters/character_representation.md#jisコード)形式では数字を表す文字の上位4[ビット](../../../_/chapters/computer_and_number.md#ビット)を $0011$ としている。また符号部は数が正の場合は $1100$ (C)、負の場合は $1101$ (D)となる。

```
# JISコード形式で表した987
00111001 00111000 11000111

# JISコード形式で表した-987
00111001 00111000 11010111
```

### パック10進数

**パック10進数**は、[10進数](./radix.md#10進数)1桁を[BCDコード](#bcdコード)で表現し、最下位の4[ビット](../../../_/chapters/computer_and_number.md#ビット)に符号を付加する。パック10進数は必ず[バイト](../../../_/chapters/computer_and_number.md#バイト)単位で扱われ、偶数桁の場合は符号部を含めて8[ビット](../../../_/chapters/computer_and_number.md#ビット)の倍数にならないため、先頭に $0000$ を追加する。

```
# パック10進数で表した-6078
0000 0110 0000 0111 1000 1101
```


## 参考文献

- [角谷一成.令和05年 基本情報技術者合格教本.株式会社技術評論社, 2022, 575](https://gihyo.jp/book/2022/978-4-297-13164-7)
- [瀬戸美月.徹底攻略 応用情報技術者教科書 令和4年度.株式会社インプレス, 2021, 814](https://book.impress.co.jp/books/1121101057)
