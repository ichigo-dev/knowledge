# AWSの基礎知識

（最終更新： 2022/12/23）


## 目次

1. [AWS](#aws)
	1. [クラウド設計のポイント](#クラウド設計のポイント)
1. [AWSの基本的な仕組み](#awsの基本的な仕組み)
1. [AWSのコアサービス](#awsのコアサービス)
	1. [最重要サービス](#最重要サービス)
	1. [重要なサービス](#重要なサービス)
1. [リージョンとAZ](#リージョンとaz)
1. [マルチAZ](#マルチaz)


## AWS

**AWS**（Amazon Web Service）は、Amazonが提供する**クラウドコンピューティングサービス**で、インターネットを介して、サーバやストレージ、データベース、ソフトウェアなどを利用することができる。AWSのようなクラウドコンピューティングサービスを利用することにより、従来の**オンプレミス**（コンピュータの実体を企業や団体の元で管理する方式）に比べて低いコストでサービスを運用できたり、障害への対策や負荷分散が手軽に行えるといった利点がある。

### クラウド設計のポイント

**信頼性**(Reliability)は障害の発生のしにくさのことで、システムやサービスが使用できなくなる頻度やその間隔を表す指標。システムの連続稼働時間が長いほど信頼性が高く、**平均故障間隔**が短くなるようにしなければならない。

**可用性**(Availability)あるいは**稼働率**はシステムやサービスが利用できる時間の割合のこと。システムの停止時間が少ないほど可用性が高い。

**耐久性・永続性**(Durability)あるいは**データ持続性**はデータが失われない確率のことで、1から**AFR**（年間故障率）を引いた確率で表される。

**耐障害性**（**フォールトトレランス**、fault tolerance）は問題が起こった場合に自動で復旧する仕組み。**単一障害点**(**SPOF**: Single Point Of Failure)を排除することで耐障害性を向上させることができる。復旧後に復旧前よりもシステムが使いづらくなるようであれば、耐障害性はないと言える。

**障害回避**（**フォールトアボイダンス**、fault avoidance）は問題を発生させないための仕組み。

**冗長性**(Redundancy)あるいは**多重性**はシステムに障害が発生した場合に備えて冗長な呼び装置を運用する仕組み。メインのサーバに加えて予備のサーバを用意した場合は、冗長性があるといえる。システムに冗長性を持たせることを**冗長化**という。

**堅牢性**はハードウェアが丈夫で壊れにくい設計になっていることや、予期しないエラーや障害に柔軟に対応できることなどを指す幅広い概念。信頼性や可用性、耐障害性が総じて高いことを表現している。

**保守性**(Serviceability)あるいは**平均修理時間**はメンテナンスの用意さを表す概念。保守性が高いほど可用性が高く保たれる。

**保守性・安全性**(Integrity)は情報が矛盾を起こさずに一貫性を保てる度合いを表す概念。

**安全性・機密性**(Security)は情報の外部流失の起きにくさの度合いを表す概念。

**結果整合性**は更新が反映されるまでに時間がかかる場合、保存前や変更前の状態が見える可能性があるという性質のこと。一貫性を保とうとした場合、あるユーザが操作中のデータに他のユーザが一時的にアクセスできなくなるため、可用性を犠牲にすることとなる。

**一貫性**(Consistency)はあるデータが更新された場合に必ず変更後の状態を取得できる性質のこと。

**再現性**は別の環境や手法を用いても同じ、あるいは近い結果が得られる性質のこと。エラーやトラブルについて再現性が低い場合、その原因を特定することが難しく解決されにくい。

**冪等性**はある操作を繰り返し行っても得られる結果が同じであるという性質のこと。

### ホットスタンバイとコールドスタンバイ

### フェイルオーバー


## AWSの基本的な仕組み

クラウドコンピューティングサービスの役割は、コンピュータや通信機器を設置することに特化した施設（**データセンター**）のハードウェア資源をインターネットを介してユーザに提供することである。AWSは単一のデータセンターではなく、複数の地域にまたがったデータセンターから構成されている。

### リージョンとAZ

**リージョン**はデータセンターが設置されている地域を指し、日本であれば東京リージョンと大阪リージョン、海外ではロンドンやパリ、バーレーンなど様々な地域にリージョンがある。各地のリージョンは相互に高速回線で接続されている。

**アベイラビリティゾーン**（**AZ**）は1つのリージョン内に複数あり、それぞれ物理的に切り離されており、電力やネットワークなどについて冗長化されている。

### マルチAZ

システムのインフラを構築する際には、複数のAZをまたいだ**マルチAZ**の構成を意識することで高い耐障害性や可用性を実現できる。


## AWSのコアサービス

### 最重要サービス

AWSで提供される数あるサービスの中でも、最も基本的で重要なサービスをいくつか示す。

**IAM**（AWS Identity and Access Management）は、ポリシーの作成やユーザに対する権限の付与などといった、権限管理のサービス。

**VPC**（Amazon Virtual Private Cloud）は、仮想ネットワーク環境におけるリソースの配置、接続性、セキュリティなどを制御するためのサービス。

**EC2**（Amazon Elastic Computing Cloud）は、Webサーバやバッチサーバなど様々な役割を持ったサーバを構築できるサービス。ディスク領域として**EBS**（Amazon Elastic Block Store）を使用するので、併せて理解を深めるとよい。**ECS**（Amazon Elastic Container Service）や**Lambda**との違いを意識して使い分けることがポイント。

**ELB**（Elastic Load balancing）は、EC2をWebサーバとして使用する際に、負荷分散の役割を果たすロードバランサのサービス。EC2のインスタンスを複数台配置してサーバの停止に備えるなど、可用性の高い設計を目指したときに必須となる。また、動的にサーバの数を増減させる**Auto Scaling**も、コスト最適化や可用性向上といった目的で重要なサービスとなる。

**RDS**（Amazon Relational Database Service）は、リレーショナルデータベースマネージドサービス（RDBMS）。中でもAWSが独自に開発したデータベースエンジンである**Aurora**は重要なので押さえておく。

**S3**（Amazon Simple Storage Service）は、オブジェクトストレージサービスである。ファイルが置かれたことをトリガーに後続の処理が動いたり、他のシステムとのファイル連携に利用したり、サーバログの定期的な退避先に使われたりと、広いユースケースのあるサービスである。

### 重要なサービス

続いて重要度が比較的高いサービスについて見ていく。

**Route53**は、AWSのDNSサービスである。新旧のシステムを入れ替えるブルーグリーンデプロイメントとの相性も良い。

**CloudWatch**は、AWSのリソースの状態や各種ログの監視を行うサービス。

**CloudFormation**は、インフラを自動構築するサービス。また、自動構築を支援するサービスとしては**Elastic Beanstalk**や**OpsWorks**といったサービスもある。


![AWSの構成サンプル](../images/sample_architecture.jpg)
