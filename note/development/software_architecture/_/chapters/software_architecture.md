# 『ソフトウェアアーキテクチャ』ノート

（最終更新： 2023-09-30）


## 目次

1. [ソフトウェアアーキテクチャ](#ソフトウェアアーキテクチャ)
	1. [アーキテクチャスタイル](#アーキテクチャスタイル)
	1. [構造](#構造)
	1. [アーキテクチャ特性](#アーキテクチャ特性)
	1. [アーキテクチャ決定](#アーキテクチャ決定)
	1. [設計指針](#設計指針)
1. [モノリシックアーキテクチャ](#モノリシックアーキテクチャ)
1. [レイヤードアーキテクチャ](#レイヤードアーキテクチャ)
1. [ヘキサゴナルアーキテクチャ](#ヘキサゴナルアーキテクチャ)
	1. [ポート](#ポート)
1. [オニオンアーキテクチャ](#オニオンアーキテクチャ)
1. [クリーンアーキテクチャ](#クリーンアーキテクチャ)


## ソフトウェアアーキテクチャ

**ソフトウェアアーキテクチャ**は、[システム](../../../../system/_/chapters/system.md#システム)の構造や[コンポーネント](../../../../computer/software/_/chapters/package.md#コンポーネント)、それらの構造や相互関係を定義する設計。[ソフトウェア](../../../../computer/software/_/chapters/software.md#ソフトウェア)開発の初期段階で、[ソフトウェア](../../../../computer/software/_/chapters/software.md#ソフトウェア)の全体像を設計するために使用される。ソフトウェアアーキテクチャの目的は、[ソフトウェア](../../../../computer/software/_/chapters/software.md#ソフトウェア)の品質、保守性、拡張性を向上させることで、適切なソフトウェアアーキテクチャを設計することで、[ソフトウェア](../../../../computer/software/_/chapters/software.md#ソフトウェア)の変更や拡張が用意になったり、[バグ](../../../../programming/_/chapters/programming.md#バグ)の発生率を抑えたりすることができる。ソフトウェアアーキテクチャには、いくつかの汎用的に用いられている手法（パターン）が存在する。

ソフトウェアアーキテクチャは、[構造](#構造)、[アーキテクチャ特性](#アーキテクチャ特性)、[アーキテクチャ決定](#アーキテクチャ決定)、[設計指針](#設計指針)の組み合わせで構成される。

### アーキテクチャスタイル

**アーキテクチャスタイル**（**スタイル**）は、[システム](../../../../system/_/chapters/system.md#システム)開発における特定の設計パターンや[アーキテクチャ](#ソフトウェアアーキテクチャ)の形式を表す概念。アーキテクチャスタイルには、[レイヤードアーキテクチャ](#レイヤードアーキテクチャ)や[マイクロカーネルアーキテクチャ](#マイクロカーネルアーキテクチャ)などがある。

### 構造

**構造**は、[システム](../../../../system/_/chapters/system.md#システム)を実装する[アーキテクチャスタイル](#アーキテクチャスタイル)の種類。

### アーキテクチャ特性

**アーキテクチャ特性**は、[システム](../../../../system/_/chapters/system.md#システム)の成功基準を定めるもので、通常[システム](../../../../system/_/chapters/system.md#システム)の機能とは直接関係しない。アーキテクチャ特性には、[可用性](../../../../system/_/chapters/system_performance_evaluation.md#可用性)や[信頼性](../../../../system/_/chapters/system_performance_evaluation.md#信頼性)、テスト容易性、スケーラビリティ、[セキュリティ](../../../../system/security/_/chapters/security.md#セキュリティ)、アジリティ、[耐障害性](../../../../system/_/chapters/reliability_design.md#フォールトトレランス)、弾力性、回復性、パフォーマンス、[デプロイ](../../../management/_/chapters/deployment_strategy.md#デプロイ)容易性、学習容易性などの要素がある。

### アーキテクチャ決定

**アーキテクチャ決定**は、[システム](../../../../system/_/chapters/system.md#システム)をどのように構築すべきかのルールを定めるもの。例えば、[レイヤードアーキテクチャ](#レイヤードアーキテクチャ)上のどの[レイヤ](#レイヤードアーキテクチャ)が[データベース](../../../database/_/chapters/database.md#データベース)にアクセスできるか、といったルールはアーキテクチャ決定にあたる。アーキテクチャ決定は[システム](../../../../system/_/chapters/system.md#システム)の制約であり、何が許されて何が許されないかに関する開発チームの指針となる。

アーキテクチャ決定は**特例**によって破られる場合があり、これはアーキテクチャ審査委員会(ARB: Architecture Review Board)やチーフアーキテクトが使用する特例モデルによって定められる場合が多い。

### 設計指針

**設計指針**は、[アーキテクチャ決定](#アーキテクチャ決定)のような堅苦しいルールではなく、[システム](../../../../system/_/chapters/system.md#システム)開発におけるガイドラインのようなもの。例えば、[マイクロサービスアーキテクチャ](#マイクロサービスアーキテクチャ)を採用した[システム](../../../../system/_/chapters/system.md#システム)開発において、サービス同士は非同期メッセージングを利用してパフォーマンスを向上させると良い、といった設計指針は、必ずしも守られていなければいけないというわけではなく、あくまで推奨されるアプローチに関するガイドである。


## モノリシックアーキテクチャ

**モノリシックアーキテクチャ**は、[システム](../../../../system/_/chapters/system.md#システム)を構成する全ての[コンポーネント](../../../../computer/software/_/chapters/package.md#コンポーネント)が緊密に結合し、相互に依存しながら、単一の統一されたユニットを形成する[ソフトウェアアーキテクチャ](#ソフトウェアアーキテクチャ)。特に小規模なプロジェクトに有効なアプローチであり、シンプルで開発が行いやすいというメリットがある。一方で、大規模なプロジェクトでは[コンポーネント](../../../../computer/software/_/chapters/package.md#コンポーネント)が複雑に絡み合って保守や拡張が困難になり、1つの[コンポーネント](../../../../computer/software/_/chapters/package.md#コンポーネント)を変更するだけでも構造全体に影響する可能性があるといったデメリットもある。

将来的に成長して拡張が必要になる[システム](../../../../system/_/chapters/system.md#システム)については、より機敏で適用性が高くスケーラブルな[ソフトウェアアーキテクチャ](#ソフトウェアアーキテクチャ)が適している。


## レイヤードアーキテクチャ

**レイヤードアーキテクチャ**は、[システム](../../../../system/_/chapters/system.md#システム)をいくつかの層（レイヤ）に分割し、各層に特定の役割を持たせる[ソフトウェアアーキテクチャ](#ソフトウェアアーキテクチャ)。このアーキテクチャでは、上下のレイヤに跨る依存関係の方向性を一方向にすることで、[システム](../../../../system/_/chapters/system.md#システム)の複雑化を防ぐ場合が多い。

一般的によく利用される3層レイヤードアーキテクチャでは、次の3つのレイヤを用いて[システム](../../../../system/_/chapters/system.md#システム)を構築する。

| 名称                 | 役割                                                                                                                                     |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| プレゼンテーション層 | ユーザがシステムとのやり取りを行うためのインタフェースを担う。アプリケーションのUIやAPIのリクエスト/レスポンスモデルなどがこれにあたる。 |
| ビジネスロジック層   | システムで業務を表現する処理やモデル。                                                                                                   |
| データアクセス層     | データアクセスに対する技術的な手段を提供する。主にデータベースや外部サービスを直接的に利用する部分。                                     |

レイヤードアーキテクチャでは、複数のレイヤで同様の機能が実装されてしまい変更に弱くなる、レイヤ間の結合が強くなるとテストが行いにくくなる、といった問題もある。


## ヘキサゴナルアーキテクチャ

**ヘキサゴナルアーキテクチャ**（**ポートアンドアダプタ**）は、[システム](../../../../system/_/chapters/system.md#システム)をコア機能、[データベース](../../../database/_/chapters/database.md#データベース)、[ユーザインタフェース](../../../../computer/software/_/chapters/software.md#ui)などの疎結合な[コンポーネント](../../../../computer/software/_/chapters/package.md#コンポーネント)に分割することを目的とした[ソフトウェアアーキテクチャ](#ソフトウェアアーキテクチャ)。このアーキテクチャでは、[GoFデザインパターン](../../../design_pattern/_/chapters/design_pattern.md#gofデザインパターン)の[Adapter](../../../design_pattern/_/chapters/adapter.md#adapterパターン)を利用しており、コア機能には[ポート](#ポート)を介してのみアクセスすることができる。

基本的な考え方は[レイヤードアーキテクチャ](#レイヤードアーキテクチャ)を継承しており、コア機能と外部要素との結合を疎にすることを目的として設計されている。

### ポート

**ポート**は、[ヘキサゴナルアーキテクチャ](#ヘキサゴナルアーキテクチャ)において、コア機能と外部要素が通信するためのインタフェース。

ユーザがコア機能にアクセスするためのポート（[GUI](../../../../computer/software/_/chapters/software.md#gui)やテストコードなど）を**プライマリポート**、コア機能から外部要素にアクセスするためのポート（[データベース](../../../database/_/chapters/database.md#データベース)や[ストレージ](../../../../computer/hardware/_/chapters/hardware.md#記憶装置)など）を**セカンダリポート**と呼ぶ。


## オニオンアーキテクチャ

**オニオンアーキテクチャ**は、[レイヤードアーキテクチャ](#レイヤードアーキテクチャ)のような階層構造を円で表現し、すべての依存関係が円の中心に対して向かうように[システム](../../../../system/_/chapters/system.md#システム)を構築する[ソフトウェアアーキテクチャ](#ソフトウェアアーキテクチャ)。層の増減は可能であるが、常に中心に[ドメインモデル](../../../management/_/chapters/development_method.md#ドメインモデル)の層が配置され、この層は他の層への依存関係を持たない。

基本的な考え方は[ヘキサゴナルアーキテクチャ](#ヘキサゴナルアーキテクチャ)を継承しており、コア機能の内部のレイヤを細かく分類して具体的な役割を説明している。


## クリーンアーキテクチャ

**クリーンアーキテクチャ**は、[オニオンアーキテクチャ](#オニオンアーキテクチャ)のように階層構造を円で表現し、明示的な[Adapter](../../../design_pattern/_/chapters/adapter.md#adapterパターン)のレイヤを用意した[ソフトウェアアーキテクチャ](#ソフトウェアアーキテクチャ)。

基本的な考え方は[オニオンアーキテクチャ](#オニオンアーキテクチャ)を継承しており、[Adapter](../../../design_pattern/_/chapters/adapter.md#adapterパターン)の層を明確にしたり、依存関係を整えたりしている。
