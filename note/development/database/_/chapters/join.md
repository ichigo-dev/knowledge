# 『JOIN』ノート

（最終更新： 2023-10-13）


## 目次

1. [結合](#結合)
	1. [内部結合](#内部結合)
	1. [外部結合](#外部結合)
	1. [交差結合](#交差結合)


## 結合

**結合**(**JOIN**)は、[RDB](./rdb.md#rdb)において、複数の[テーブル](./rdb.md#テーブル)を結合して新しい[テーブル](./rdb.md#テーブル)を表現する機能。[外部キー](./rdb.md#外部キー)を持つ[テーブル](./rdb.md#テーブル)は、その[カラム](./rdb.md#カラム)に他の[テーブル](./rdb.md#テーブル)の[プライマリキー](./rdb.md#プライマリキー)を格納しており、結合して参照することができる。結合には[内部結合](#内部結合)や[外部結合](#外部結合)といった種類があり、これらにより得られる[レコード](./rdb.md#レコード)の範囲は[ベン図](../../../../basics/discrete_mathematics/_/chapters/set_and_proposition.md#ベン図)を用いて考えるとわかりやすい。

結合は[RDB](./rdb.md#rdb)の中でも最も遅い操作のひとつで、[テーブルスキャン](./index.md#テーブルスキャン)の場合、1,000[レコード](./rdb.md#レコード)のある[テーブル](./rdb.md#テーブル)と1,000[レコード](./rdb.md#レコード)のある[テーブル](./rdb.md#テーブル)の結合では、1,000,000行をスキャンする必要がある。複数の[テーブル](./rdb.md#テーブル)を結合するとスキャンの回数がさらに増え、指数関数的に処理時間が大きくなる。

### 内部結合

**内部結合**(**INNER JOIN**)は、[RDB](./rdb.md#rdb)の[テーブル](./rdb.md#テーブル)の[結合](#結合)のひとつで、指定した結合条件が両方の[テーブル](./rdb.md#テーブル)でマッチする[レコード](./rdb.md#レコード)のみを取得する。これは、[集合](../../../../basics/discrete_mathematics/_/chapters/set_and_proposition.md#集合)で表すと[積集合](../../../../basics/discrete_mathematics/_/chapters/set_and_proposition.md#積集合)を意味する。

### 外部結合

**外部結合**(**OUTER JOIN**)は、[RDB](./rdb.md#rdb)の[テーブル](./rdb.md#テーブル)の[結合](#結合)のひとつで、基準となる方の[テーブル](./rdb.md#テーブル)の[レコード](./rdb.md#レコード)全てと、結合条件にマッチするもう一方の[テーブル](./rdb.md#テーブル)の[レコード](./rdb.md#レコード)を取得する。マッチする[レコード](./rdb.md#レコード)がない場合は、[null](./rdb.md#null)が[結合](#結合)される。

外部結合には、**左外部結合**(**LEFT OUTER JOIN**)、**右外部結合**(**RIGHT OUTER JOIN**)、**完全外部結合**(**FULL OUTER JOIN**)の3種類がある。左外部結合では、[結合](#結合)元となる方の（[FROM](./sql.md#データの取得)句に指定された）[テーブル](./rdb.md#テーブル)を基準とする。右外部結合では、[結合](#結合)先となる方の（[JOIN](./sql.md#外部結合)句に指定された）[テーブル](./rdb.md#テーブル)を基準とする。完全外部結合では、両方の[テーブル](./rdb.md#テーブル)の[レコード](./rdb.md#レコード)を全て取得するように[結合](#結合)される。これは、[集合](../../../../basics/discrete_mathematics/_/chapters/set_and_proposition.md#集合)で表すと[和集合](../../../../basics/discrete_mathematics/_/chapters/set_and_proposition.md#和集合)を意味する。

### 交差結合

**交差結合**（**直積結合**、**CROSS JOIN**）は、[RDB](./rdb.md#rdb)の[テーブル](./rdb.md#テーブル)の[結合](#結合)のひとつで、2つの[テーブル](./rdb.md#テーブル)の[組合せ](../../../../basics/applied_mathematics/_/chapters/probability_and_statistics.md#組合せ)全てを取得する。[内部結合](#内部結合)や[外部結合](#外部結合)は、交差結合の結果から必要なものを抜き出した結果と言える。
