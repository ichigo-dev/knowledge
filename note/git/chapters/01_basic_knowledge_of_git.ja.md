# Gitの基礎知識


## 目次

1. [Gitの概要](#gitの概要)
1. [バージョン管理システム](#バージョン管理システム)
	1. [集中管理方式](#集中管理方式)
	1. [分散管理方式](#分散管理方式)
1. [Gitのインストール](#gitのインストール)
	1. [Gitの初期設定](#gitの初期設定)
	1. [GUIクライアント](#guiクライアント)
1. [Gitの基本](#gitの基本)
	1. [リポジトリ](#リポジトリ)
	1. [クローン](#クローン)
	1. [リポジトリ内の領域](#リポジトリ内の領域)
	1. [コミット](#コミット)
	1. [gitignoreとgitkeep](#gitignoreとgitkeep)


## Gitの概要

**Git**はプログラムのソースコードなどの変更履歴を追跡して管理することができる分散型バージョン管理システムのひとつ。ソフトウェアなどの開発にGitを導入することで、ファイルを過去の状態に戻したり、ファイルの差分を確認したり、複数人で1つのファイルを編集することを容易にすることができる。

GitはもともとLinux開発のために考案され、Linuxの生みの親でもあるリーナス・トーバルズによって2005年に開発された。現在、Gitは数あるバージョン管理システムの中でも事実上のデファクトスタンダードとなっている。


## バージョン管理システム

**バージョン管理システム**（VCS: Version Control System）は、コンピュータ上でファイルの変更履歴を管理するシステム。プログラムのソースコードに限らず、あらゆるファイルのバージョン管理を行うことができる。

バージョン管理システムは、集中管理方式と分散管理方式に分類することができる。

### 集中管理方式

**集中管理方式**のバージョン管理システムでは、バージョン管理のための専用サーバにリポジトリを用意してファイルを一元管理する。ユーザはネットワークにさえ接続されていればどの端末からでもファイルに変更を加えてアップロードすることができる。

一方で、ネットワークに繋がっていない環境ではファイルの変更を反映できないという欠点がある。さらにサーバが単一障害点となっており、サーバが停止すればユーザの作業が一時的に中断され、サーバのリポジトリが破損すれば変更履歴が失われる恐れがある。

集中管理方式のバージョン管理システムとしては、**CVS**や**SVN**が代表的。

### 分散管理方式

**分散管理方式**のバージョン管理システムでは、全てのユーザの変更内容を集約するための中央サーバにリポジトリを用意し、各ユーザのコンピュータ上にリポジトリのコピーを持つ。サーバ上のリポジトリと、各ユーザのコンピュータ上のリポジトリの間で同期をとりながら変更内容の共有を行う。

ネットワークに繋がっていなくてもローカルリポジトリ上でほとんどの操作を行うことができるという利点がある。またサーバのリポジトリが破損した場合でも、ローカルリポジトリをサーバにコピーすれば簡単に復旧ができる。

分散管理方式のバージョン管理システムとしては、Gitが代表的。


## Gitのインストール

何かしらの統合開発環境（IDE）などを導入している場合は、Gitが同梱されている場合もある。Gitが既にコンピュータにインストールされているかを確認するため、ターミナルソフトウェア（Macのターミナル、Windowsのコマンドプロンプトなど）を起動し、次のコマンドを実行する。

```bash
$ git --version
```

Gitのバージョン情報が表示されればGitは既に使用できる状態となっている。コマンドが存在しない旨のエラーが表示される場合、Gitをインストールする必要がある。

- [Gitのダウンロード](https://git-scm.com/download)

上記サイトより自身の環境のOSにあったインストール手順を実施し、改めて `git --version` を実行してバージョンが表示されることを確認する。

### Gitの初期設定

Gitではファイルに対して誰が変更を加えたかを追跡する。そのため、最初に自身の名前とメールアドレスを設定しておく必要がある。ターミナルソフトウェアを開き、次のコマンドを実行する。

```bash
$ git config --global user.name <name>
$ git config --global user.email <email>
```

正しく設定できているかは、それぞれ次のコマンドにより確認できる。

```bash
$ git config --global user.name
$ git config --global user.email
```

また、これら以外の全ての設定値については次のコマンドで確認できるので、必要に応じて適宜変更する。

```bash
$ git config --list
```

### GUIクライアント

Gitの操作はCUI(Character User Interface)により行うことができ、ターミナルソフトウェア上でコマンドを通して実行できる。Gitをインストールすると、併せてGit Bashというターミナル・シェルのエミュレータがインストールされる。Git Bashやコンピュータにデフォルトでインストールされているターミナルソフトウェアを通してGitを操作することもできるが、コマンドによる操作が慣れていない場合はGit用のGUI(Graphical User Interface)ソフトウェアを導入することもできる。

代表的なGitのGUIクライアントソフトウェアは以下の通り。

- [SourceTree](https://www.sourcetreeapp.com/)
- [Git Fork](https://git-fork.com/)
- [GitKraken](https://www.gitkraken.com/)


## Gitの基本

### リポジトリ

**リポジトリ**はバージョン管理システムにおいてバージョン管理の対象となるディレクトリ。自身のコンピュータ上のリポジトリを**ローカルリポジトリ**、他のコンピュータ上のリポジトリを**リモートリポジトリ**という。多くの場合、全てのユーザの変更を集約するための**中央サーバ**のリポジトリを中心として各ユーザのコンピュータ上にリポジトリを複製する。

Gitではローカルリポジトリをリモートリポジトリと接続して変更内容を同期したり、リポジトリ同士の接続を解除したりすることができる。接続先は複数登録することができ、それぞれの接続先には任意の名前をつけることができる。リモートリポジトリとの同期の際には、接続先を明示する必要がある。

中央サーバからリポジトリをクローンしてきた場合には、中央サーバのリポジトリに対する接続が `origin` という名前で自動的に作成される。

### クローン

リモートリポジトリの複製を自身のコンピュータ上に作成することを**クローン**という。

### リポジトリ内の領域
 
Gitにはワークツリー、ステージ（インデックス）、コミット履歴という3つの領域がある。**ワークツリー**は現在作業中の領域で、この領域でのファイルの変更内容はGitには保存されていない。**ステージ**（**インデックス**）はコミットの対象とするファイルを保持するための領域で、コミットを作成するとステージにある変更内容がGitに保存される。**コミット履歴**はコミットされたファイルの変更履歴を保存・管理する領域。

ワークツリーでのファイルの変更内容をステージに移動することを**ステージング**という。Gitに変更内容を保存する場合はステージングを行ってからコミットを作成する必要がある。

### コミット

**コミット**（**リビジョン**）を作成することで現在ステージングされている変更のスナップショットをキャプチャし、変更履歴に追加することができる。Gitはコミットごとの差分のみを記録するのではなく、毎回全てのファイルのスナップショットを作成しているため、古いリビジョンのファイルでも高速に再現することができる。

コミットの際には**コミットメッセージ**に変更内容などを記載する。コミットメッセージの書き方は開発チームごとに文化やルールを遵守する。次のようなフォーマットでメッセージを記述することが一般的。

- 1行目にコミットの概要を50文字以内で記述
- 2行目は空行
- 3行目以降にコミットの詳細説明を記述
- コミットメッセージを英語で記述する場合、現在形を使用

また、現在のブランチにおける最新のコミットのことを**HEAD**という。

### gitignoreとgitkeep

`.gitignore` はGitで管理する対象から外したいファイルやディレクトリを指定するために設置するファイル。自身の環境に関する個人的な設定ファイルやパスワードが記載されたファイル、共有の必要のないログファイル、パッケージマネージャが生成する依存関係のキャッシュ、ビルドディレクトリなどはGitの監視対象から無視したい場合が多い。 `.gitignore` は基本的にGitの最上位のディレクトリに設置し、その中で無視する対象のファイルやディレクトリを指定する。各ディレクトリ内にそれぞれ `.gitignore` を設置することもでき、デフォルトでは空のディレクトリに `.gitignore` を設置しておくことで将来的にそのディレクトリに追加されるファイルを無視することができる。

`.gitkeep` は空のディレクトリをGitの管理対象に含めたい場合に設置するファイル。基本的にはGitでは空のディレクトリはコミットに含まれないが、ログ出力のためのディレクトリなどは監視対象に含めたい場合がある。そういったディレクトリに `.gitkeep` を設置することでコミットに含めることができる。　
