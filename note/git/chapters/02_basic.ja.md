# Git基本編


## 目次

1. [リポジトリの作成](#リポジトリの作成)
1. [リポジトリの接続](#リポジトリの接続)
1. [変更の保存](#変更の保存)
	1. [ステージング](#ステージング)
	1. [コミットの作成](#コミットの作成)
	1. [変更の比較](#変更の比較)


## リポジトリの作成

**リポジトリ**はバージョン管理システムにおいてバージョン管理の対象となるディレクトリ。自身のコンピュータ上のリポジトリを**ローカルリポジトリ**、他のコンピュータ上のリポジトリを**リモートリポジトリ**という。多くの場合、全てのユーザの変更を集約するための**中央サーバ**のリポジトリを中心として各ユーザのコンピュータ上にリポジトリを複製する。

Gitによるバージョン管理を始めるためには、まずはリポジトリを作成（もしくは既存のリポジトリをクローン）する必要がある。**クローン**とは、あるコンピュータ上のGitリポジトリのコピーを別のコンピュータ上に作成する操作。

---

ターミナルソフトウェアからGitによる管理対象としたいディレクトリに移動し、 `git init` を実行する。

```bash
$ git init
```

もしくは、既存のGitリポジトリを自身の環境にクローンする場合は `git clone` を実行する。サーバからリポジトリをクローンする際、セキュリティの観点からSSHによる認証が必要となる場合がある。SSHによる認証では、SSHキーペアを作成してサーバに公開鍵をアップロードし、ローカルのコンピュータには秘密鍵を保存しておく。

```bash
$ git clone [リポジトリURL]
```


## リポジトリの接続

Gitでは、ローカルリポジトリをリモートリポジトリと接続して変更内容を同期したり、リポジトリ同士の接続を解除したりすることができる。接続先は複数登録することができ、それぞれの接続先には任意の名前をつけることができる。リモートリポジトリとの同期の際には、接続先を明示する必要がある。

中央サーバからリポジトリをクローンしてきた場合には、中央サーバのリポジトリに対する接続が `origin` という名前で自動的に作成される。

---

接続先に関する操作には `git remote` を使用する。

```bash
# 接続先の一覧を確認
$ git remote

# 接続先の一覧を確認（詳細）
$ git remote -v

# 新しい接続先の追加
$ git remote add <name> <url>

# 接続先を削除
$ git remote rm <name>

# 接続先の名前を変更
$ git remote rename <old-name> <new-name>
```


## 変更の保存

Gitではコミットを作成することでその時のファイルの変更内容を記録することができる。

Gitにはワークツリー、ステージ（インデックス）、コミット履歴という3つの領域がある。**ワークツリー**は現在作業中の領域で、この領域でのファイルの変更内容はGitには保存されていない。**ステージ**（**インデックス**）はコミットの対象とするファイルを保持するための領域で、コミットを作成するとステージにある変更内容がGitに保存される。**コミット履歴**はコミットされたファイルの変更履歴を保存・管理する領域。

### ステージング

ワークツリーでのファイルの変更内容をステージに移動することを**ステージング**という。Gitに変更内容を保存する場合はステージングを行ってからコミットを作成する必要がある。

---

ファイルの変更をステージングするには `git add` を使用する。

```bash
# 全てのファイルをステージング
$ git add .

# ファイル、ディレクトリを指定してステージング
$ git add <file>
$ git add <directory>
```

### コミットの作成

**コミット**（**リビジョン**）を作成することで現在ステージングされている変更のスナップショットをキャプチャし、変更履歴に追加することができる。Gitはコミットごとの差分のみを記録するのではなく、毎回全てのファイルのスナップショットを作成しているため、古いリビジョンのファイルでも高速に再現することができる。

コミットの際には**コミットメッセージ**に変更内容などを記載する。コミットメッセージの書き方は開発チームごとに文化やルールを遵守する。次のようなフォーマットでメッセージを記述することが一般的。

- 1行目にコミットの概要を50文字以内で記述
- 2行目は空行
- 3行目以降にコミットの詳細説明を記述
- コミットメッセージを英語で記述する場合、現在形を使用

また、現在のブランチにおける最新のコミットのことを**HEAD**という。

---

コミットを作成するためには `git commit` を使用する。このコマンドを使用すると `core.editor` 設定値に登録されたエディタを開き、コミットメッセージの入力を行う。

```bash
$ git commit
```

`-m` オプションを追加することで、コミットメッセージをコマンド中に直接含めることもできる。

```bash
$ git commit -m "commit message"
```

### 変更の比較

Gitは2つのコミットやブランチ、ファイルなどの差分を比較するためのツールを備えている。
