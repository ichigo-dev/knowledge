# プログラミングの基礎知識


## 目次

1. [プログラミングの概要](#プログラミングの概要)
1. [2進数とプログラミング](#2進数とプログラミング)
	1. [データの単位](#データの単位)
1. [プログラムが動く仕組み](#プログラムが動く仕組み)
	1. [記憶装置](#記憶装置)
	1. [メモリとアドレス](#メモリとアドレス)
	1. [プログラムの処理の実行](#プログラムの処理の実行)
1. [アセンブリ言語](#アセンブリ言語)
1. [高水準言語](#高水準言語)
	1. [コンパイラ言語](#コンパイラ言語)
	1. [インタプリタ言語](#インタプリタ言語)
	1. [JITコンパイラ](#jitコンパイラ)
1. [型システムによる分類](#型システムによる分類)
	1. [動的型付け言語](#動的型付け言語)
	1. [静的型付け言語](#静的型付け言語)
1. [プログラミングの準備](#プログラミングの準備)


## プログラミングの概要

**コンピュータ**とは、電気信号により計算を行う機械のことである。コンピュータの処理の手順や内容を示したものを**プログラム**と呼ぶ。**プログラム**を書く人を**プログラマ**と呼び、プログラムを実装することを**プログラミング**という。プログラムを記述する際には、様々な**プログラミング言語**が用いられる。目的となるタスクを解決するための処理手順のことを**アルゴリズム**といい、良いアルゴリズムで書かれたプログラムは良いプログラム（不具合がなく、処理が高速）であるといえる。

プログラマには、世の中の様々なタスクや問題をプログラミングによって解決するという役割がある。毎日の単純作業のくり返しを減らしたり（表計算ソフトなど）、ミスが許されない場面で正確に動作することが保証されたシステムを利用したり（銀行のシステムや信号機など）、さらに人間には難しいタスクの解決を行ったり（AIによる異常検知など）と、応用範囲は多岐にわたる。


## 2進数とプログラミング

コンピュータは様々な電子部品から構成されており、これらの電子部品が電気信号を高速で伝達することで処理を行う。コンピュータの中で扱われる電気信号は、**閾値**を超えているか超えていないかの2種類しかない。そのため、閾値を超えていれば1、超えていなければ0という2つの数字でデータを表現することができる。このように0と1のみを用いて数字を表現する方法を**2進数**という。一方で、一般的に普及している0~9までの10つの数字を用いる方法を**10進数**という。その他にも、**8進数**や**16進数**などは2進数との相互変換が容易であるため、コンピュータの世界で頻繁に利用されている。

先述の通り、コンピュータが理解して処理できる信号（**機械語**）は2進数で表すことができるデータに限られるため、プログラムも最終的には2進数で記述しなければならない。例えば、次のC言語ソースコードは標準出力に `Hello, world` を表示して終了するという単純なものである。

```c
#include <stdio.h>

int main()
{
    printf("Hello, world\n");
    return 0;
}
```

これをコンピュータが処理できる実行ファイルに変換して、2進数で出力すると次のようになる。

```
01111111 01000101 01001100 01000110 00000010 00000001
00000001 00000000 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000010 00000000
00111110 00000000 00000001 00000000 00000000 00000000
00000000 00000100 01000000 00000000 00000000 00000000
(...以下略)
```

機械語で人間がプログラムを記述することは非常に複雑で可読性に乏しいことがわかる。そのため先の例のように、人間が理解しやすいようにプログラミング言語を用いてプログラムを作成し、これを機械語に変換してコンピュータが処理できるようにする。

### データの単位

コンピュータが扱うデータの最小単位は2進数の1桁（0か1か）となっており、これを**ビット**という単位で表す。また、8ビットのデータをまとめたものを**バイト**という単位で表す。


## プログラムが動く仕組み

### 記憶装置

コンピュータの構成要素の1つである**記憶装置**は、プログラムやデータを保存しておくためのもので、役割によってレジスタやメモリ、ストレージなどに分類される。

**レジスタ**はプロセッサ内における記憶装置であり、論理回路が処理や演算に直接用いることからコンピュータの中でもっとも高速に動作するが、容量は少ない。プロセッサは他にも、直近に使用したデータや使用頻度の高いデータを保持しておくための**キャッシュメモリ**を持つものもある。

**メインメモリ（主記憶装置）**はCPUがアクセスする記憶領域で、実行中のプログラムやそのプログラムが用いるデータなどを保持する。また、コンピュータの電源を落とすと保持していた内容が失われる**揮発性メモリ**のため、永続的に残したいデータについてはストレージに書き込む必要がある。プログラムの実行にかかわる部分なので高速に動作する**RAM**(Random Access Memory)が用いられることが多い。

**ストレージ**はコンピュータの電源が切れても内容を保持し続ける**不揮発性メモリ**で、CPUから直接アクセスすることはできない。磁気ディスクを用いた**HDD**(Hard Disk Drive)やフラッシュメモリを用いた**SSD**(Solid State Drive)などの種類がある。

### メモリとアドレス

プログラムがアクセスできる記憶媒体はメモリにあり、メモリ上のデータをレジスタに読み込んだり、レジスタの計算結果をメモリに書き出したりすることで処理を進める。メモリ上に存在するデータを指し示すために、メモリ上には1バイトごとに**アドレス**が割り振られている。

### プログラムの処理の実行

プロセッサが実行する1つの命令パターンを2進数で表したものを**オペコード**といい、その操作対象を**オペランド**という。

実行されるプログラムはストレージからメモリに読み込まれ、CPUが機械語を解釈しながら処理を実行していく。次に処理する命令が書かれているアドレスを保持ししておくレジスタを**プログラムカウンタ**といい、プログラムカウンタが示すアドレスの命令を**命令レジスタ**に読み込むことで処理が実行される。プログラムカウンタから機械語コードを読み取ることを**フェッチ**、その意味を解析することを**デコード**、解析した命令を実行することを**エグゼキュート**、結果をメモリに書き込むことを**ストア**という。フェッチの後にプログラムカウンタを1つ進めることで、命令が順次実行されていくという流れとなる。


## アセンブリ言語

オペコードを簡略化した英単語や記号と1対1で対応させたものを**ニーモニック**といい、これを組み合わせて記述するプログラミング言語を**アセンブリ言語**という。アセンブリ言語を機械語に変換する操作を**アセンブル**といい、この操作を行うプログラムを**アセンブラ**という。

コンピュータには様々な装置が付属しているが、その中でも実際にプログラムを実行する**処理装置**のことを**プロセッサ**という。**CPU（中央演算装置）**などがこれにあたり、インテルやAMDといったメーカーのものが一般的に流通している。CPUが異なれば使用できるアセンブリ言語も異なるので注意が必要である。

アセンブリ言語の一種である**Netwide Assembler**を用いて `Hello, world` を出力するプログラムを以下に示す。

```asm
section .data
    msg db      "Hello, world"      ; データセクションで文字列を宣言

section .text
    global _start                   ; プログラムのエントリポイントとして_startを呼び出し

_start:
    mov     rax, 1                  ; sys_writeシステムコールをraxレジスタにセット
    mov     rdi, 1                  ; 第一引数（ファイルディスクリプタ、1は標準出力）をrdiレジスタにセット
    mov     rsi, msg                ; 第二引数（出力したい文字列）をrsiレジスタにセット
    mov     rdx, 12                 ; 第三引数（データのサイズ）をrdxレジスタにセット
    syscall                         ; システムコールを発行
    mov     rax, 60                 ; exitシステムコールをraxレジスタにセット
    mov     rdi, 0                  ; 第一引数（終了コード、0は正常終了）をrdiレジスタにセット
    syscall                         ; システムコールを発行
```

プログラミング言語の中でも機械語に近い言語を**低水準言語**（低級言語）と呼び、アセンブリ言語もこれに属する。


## 高水準言語

世の中の多くのプログラミング言語は、機械語を意識することなく記述できるようになっている。このように、低水準言語に比べて抽象度が高く人間にとって分かりやすい言語のことを**高水準言語**（高級言語）と呼ぶ。高水準言語には、プロセッサに依存したプログラムを書かなくてよい（機械語への変換の段階で様々なプロセッサに対応させることができる）というメリットもある。代表的な高水準言語には、C系言語（C, C#, C++）、Java、PHP、Python、JavaScriptなどがある。高水準言語はそれぞれに特徴があり、活躍する分野が異なる。例えば、C系言語は処理速度が高速であることからCPUやサーバなどの低レイヤの実装に向いており、JavaScriptは一般的なWebブラウザで動作することからWebコンテンツ向けとなる。

高水準言語をコンピュータに処理させるためには、アセンブリ言語と同じく機械語への変換が必要となる。高水準言語を機械語へ変換する操作を**コンパイル**といい、この操作を行うプログラムを**コンパイラ**という。高水準言語は、ソースコードをコンパイルして実行する際の方式によってコンパイラ言語とインタプリタ言語に分類することができる。

### コンパイラ言語

**コンパイラ言語**では、プログラムの処理を実行する前にあらかじめ機械語への変換を行っておくという方式を用いる。実際にプログラムを利用する際には、機械語に変換された**実行ファイル**を実行する。事前に変換処理を済ませているため、実行前に不具合を発見できる、インタプリタ言語に比べて実行速度が高速であるといった利点がある。一方で、実行前に実行時に起こりうる様々なパターンに対応できるようにプログラムを実装しなければならず、スクリプト言語と比較しても難易度が高い言語が多い。コンパイルした実行ファイルはプロセッサに依存するため、マルチプラットフォームに対応できないという欠点もある。

代表的なコンパイラ言語としては、C系言語やGo, Rustなどがある。

### インタプリタ言語

**インタプリタ言語**では、プログラムの実行時にソースコードを1行ずつコンパイルしながら処理を進めるという方式を用いる。実行時に毎回コンパイル作業が必要となるため、実行速度はコンパイラ言語に比べて遅い傾向にある。しかし、コンパイルを行わずにすぐに実行結果を確認できるためデバッグが容易で、実装にかかるコストが小さくなるという利点がある。

代表的なインタプリタ言語としては、PHPやJavaScript、Pythonなどがある。

### JITコンパイラ

**JITコンパイラ**を利用したプログラミング言語としては、Javaが代表的である。

この方式では、ソースコードを環境に依存しない**中間コード（バイトコード）**に変換しておき、実行時にバイトコードをコンパイルして実行する。実行時にコンパイルするという点ではインタプリタ方式と似ているが、インタプリタ方式に比べて高速な動作を実現できる。

コンパイラ言語では直接機械語のコードを生成するため環境に対する依存が発生するが、JavaではJVM（Java仮想マシン）が利用できる環境であればどこでもプログラムを実行できるというメリットがある。


## 型システムによる分類

プログラミングにおいては、使用するデータの型（数値、文字列など）を意識する必要がある。データの型を実行時に決定するか、実行前に決定するかによって、動的型付け言語と静的型付け言語に分類することができる。

### 動的型付け言語

**動的型付け言語**では、実行時にデータの型を決定する方式を用いる。プログラム中にデータ型を記述する必要がないため、ソースコードがシンプルになり見やすくなる。データが読み込まれるたびにそのデータの型を推測する必要があるため、実行速度は静的型付け言語に比べて遅い傾向にある。

また、実行時に型が決定するという抽象化の性質から、ある関数の引数として同じインタフェースを持つ異なるオブジェクトを取ることができるという特徴がある。これを利用したプログラミングスタイルを、**ダックタイピング**という。

### 静的型付け言語

**静的型付け言語**では、実行前にデータの型を決定する方式を用いる。コンパイラ言語の多くは静的片付け言語となっている。プログラム中に登場するデータに対して、そのデータをどの型として扱うかを明示（型注釈）する必要がある。静的型付け言語では、事前にデータの型を確定させておくことで、想定外のデータに対して処理が行われるような不具合を防ぐことができる。


## プログラミングの準備

プログラミングを始めるために必要なものは基本的には、各種プログラムを実行するための**実行環境**と、プログラムを記述するための**テキストエディタ**のみ。実行環境とは、プログラマが記述したプログラムをコンピュータが処理可能な機械語に変換する工程を行うための環境のこと。テキストエディタにはプログラミングを便利に行うための補助機能が搭載されたものなど様々な種類があるが、PCに最初からインストールされている（Windowsのメモ帳など）ようなものでも問題ない。代表的なテキストエディタには次のようなものがある。

- [サクラエディタ](https://sakura-editor.github.io/)
- [秀丸エディタ（有料）](https://hide.maruo.co.jp/software/hidemaru.html)
- [Visual Studio Code](https://code.visualstudio.com/)
- [Neovim](https://neovim.io/)
