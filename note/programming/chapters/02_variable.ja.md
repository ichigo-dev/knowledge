# 変数


## 目次

1. [プログラミングにおける変数](#プログラミングにおける変数)
1. [変数の操作](#変数の操作)
1. [スコープと生存期間](#スコープと生存期間)
1. [変数と定数](#変数と定数)


## プログラミングにおける変数

**変数**はプログラム中で用いるデータの記憶域のことで、固有の名前によって識別される。物理的にはデータはメモリに格納されており、メモリ上のデータにはアドレスを使ってアクセスすることができる。しかし、メモリアドレスは意味を持たない数値の羅列であるため、プログラム中では格納しているデータを表す名前をつけた変数を用いる。


## 変数の操作

変数に対する操作には、宣言、代入、参照がある。

**宣言**ではプログラム中で用いる変数の名前を明示する。静的型付け言語の多くは、宣言時に変数の型を指定する必要がある。プログラミング言語によっては、同じ識別子の変数を複数回宣言しようとするとエラーとなる。一方で、新しい変数で前の変数を上書きする（**シャドーイング**）仕様のプログラミング言語もある。

**代入**では宣言された変数に対してデータを関連付ける。多くのプログラミング言語では変数の宣言と同時に代入を行うことができ、これを**初期化**という。既にデータが紐づけられている変数に対して新しいデータを紐づける（**再代入**）することもできる。また、後から変数に紐づくデータを変更することを許可しないような関連付けのことを**束縛**と呼ぶこともある。代入を表現するために用いられる演算子としては `=` が用いられる場合が多く、数学的な意味である「等価」と意味が異なるので注意が必要である。プログラミングにおいて「等価」であることを表す演算子には `==` が利用されることが多い。

**参照**では変数に紐づくデータの中身を利用する。データが代入されていない変数（**未初期化状態**の変数）を参照することは不正な操作であり、プログラミング言語によっては**未定義動作**となる。また、言語によってはこのような事態を防ぐために宣言時に仮の初期値を関連付ける。


```c
// C言語における変数の操作

int x;              // 宣言
int y = 5;          // 初期化
x = 3;              // 代入
print("%d\n", x);   // 参照
```

```php
<?php

// PHPにおける変数の操作

$x = 5;             // 初期化、代入
echo($x);           // 参照

?>
```

```javascript
// JavaScriptにおける変数の操作

let x;              // 宣言
let y = 5;          // 初期化
x = 3;              // 代入
console.log(x);     // 参照
```


## スコープと生存期間

変数や関数など識別子で表現されるソースコード中のリソースは、プログラムの特定の範囲内からしか参照できない。ソースコード中で `{}` で囲まれた範囲を**ブロック**といい、ブロックの内側で定義した変数はブロックの外側からは参照できない。ソースコード中で変数を参照できる範囲のことを**スコープ**という。

```javascript
// JavaScriptによるスコープの例
{
    let x = 1;

    {
        // 変数を初期化
        let y = 3;

        // 変数x、yのスコープ内なので、問題ない
        console.log(x);
        console.log(y);

        x = x + y;
    }

    // 変数xのスコープ内なので問題ない
    console.log(x);

    // 変数yのスコープの外なのでエラーになる
    console.log(y);
}
```

プログラム全体を指すスコープを**グローバルスコープ**（**ファイルスコープ**）、特定のブロック内を指すスコープを**ローカルスコープ**という。また、グローバルスコープに宣言された変数を**グローバル変数**、ローカルスコープに宣言された変数を**ローカル変数**（**自動変数**）という。

また、同じ識別子の変数を複数回宣言できないプログラミング言語においても、スコープが異なれば同じ識別子を用いることができる。

変数に紐づくデータには**生存期間**（**ライフタイム**、**寿命**）があり、グローバル変数の生存期間はプログラムの実行開始から終了まで、ローカル変数の生存期間はスコープ内となっていることが一般的である。


## 変数と定数

ほとんどのプログラミング言語では、変数だけではなく**定数**が利用できる。変数は宣言後に紐付けるデータを変更することができるが、定数は初期化したあとに紐付けるデータを変更することができない。また、変数は初期化しなくてもあとからデータを紐付けて使用することができるが、定数は必ず初期化する必要がある。定数の初期化には `const` キーワードが用いられる場合が多い。プログラム中で変更されてはいけないデータや、数学的・物理的な定数は、定数として定義される。

```c
// C言語では変数の初期化時にconstキーワードをつけることで定数にすることができる

const int max_cnt = 1000;
const float pi = 3.14159;
```

```javascript
// JavaScriptではletの代わりにconstを用いることで定数を初期化する

const max_cnt = 1000;
const pi = 3.14159;
```

定数は紐づくデータは変わらないが、ポインタ経由などでデータ自体を書き換えることができてしまうため、必ずしも参照した中身が一定であるとは限らない点には注意が必要である。

また `const` 定数と似たような使われ方をする機能として `define` を利用できるプログラミング言語もある。これは一般的にはソースコード中の文字列をコンパイル時に別の値に置き換える機能のことを指す。

```c
// C言語ではdefineマクロを用いて値を定義する

#define MAX_CNT 1000
#define PI 3.14159
```

```php
<?php

// PHPではdefine関数を用いて値を定義する

define("MAX_CNT", 1000);
define("PI", 3.14159);

?>
```
