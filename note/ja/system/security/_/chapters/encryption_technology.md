# 『暗号化技術』ノート

（最終更新： 2023-06-05）


## 目次

1. [共通鍵暗号方式](#共通鍵暗号方式)
	1. [DES](#des)
	1. [AES](#aes)
	1. [RC4](#rc4)
1. [公開鍵暗号方式](#公開鍵暗号方式)
	1. [RSA](#rsa)
	1. [ECC](#ecc)
	1. [DSA](#dsa)
1. [ハッシュ](#ハッシュ)
	1. [衝突](#衝突)
	1. [MD5](#md5)
	1. [SHA-1](#sah-1)
	1. [SHA-2](#sah-2)
1. [デジタル署名](#デジタル署名)
1. [PKI](#pki)
	1. [認証局](#認証局)
	1. [登録局](#登録局)
	1. [発行局](#発行局)


## 共通鍵暗号方式

**共通鍵暗号方式**は、同じ鍵を使用してデータを暗号化および復号化する暗号化方式。送信者と受信者が事前に同じ鍵を共有する必要がある。共通鍵暗号方式は、高速性と効率性に優れており、暗号化や復号化のプロセスが簡単で計算量が少ないため、処理が迅速に行われる。ただし、共通鍵を安全に共有する必要があり、第三者から鍵を守るためにセキュアな方法で鍵を伝達しなければならない。

### DES

**DES**(Data Encryption Standard)は、アメリカの旧国家暗号規格として用いられていた、共通鍵暗号方式のアルゴリズムのひとつ。56ビットの鍵を用いるが、鍵長が短すぎるため、近年では安全ではないとみなされている。

### AES

**AES**(Advanced Encryption Standard)は、DESの後継として現在広く使用されている、共通鍵暗号方式のアルゴリズムのひとつ。128ビット、192ビット、256ビットの鍵長をサポートしており、DESよりも高いセキュリティレベルが得られる。データを固定サイズのブロックに分割して、ブロックごとに異なる置換操作を行うことで暗号化を行う。

### RC4

**RC4**(Rivest Cipher 4)は、ビット単位で随時暗号化を行う、ストリーム暗号化アルゴリズムのひとつ。非常に高速な暗号化アルゴリズムであり、リソース効率が高いため、一部のアプリケーションやプロトコルで使用されていたが、セキュリティ上の問題が発見されたため非推奨となっている。


## 公開鍵暗号方式

**公開鍵暗号方式**は、異なる鍵のペアである公開鍵と秘密鍵を使用してデータを暗号化および復号化する暗号化方式。公開鍵は一般的に公開され、秘密鍵はセキュアに保護される。公開鍵暗号方式は、セキュリティと鍵共有の容易さの点で優れている。

### RSA

**RSA**(Rivest Shamir Adleman)は、公開鍵暗号方化アルゴリズムのひとつで、大きい数に対する素因数分解の困難さを安全性の根拠とした方式となっている。

鍵を生成する手順は以下の通り。

- 異なる2つの大きな素数 $p, q$ を生成する
- $n = pq$ とする
- $(p - 1)(q - 1)$ と互いに素な整数 $k_1$ をとる
- $k_1 k_2 \equiv 1 (mod (p - 1)(q - 1))$ となる $k_2$ をとる
- $n$ と $k_1$ を公開鍵として公開して、 $k_2$ は秘密鍵として公開しない

また、これらの鍵を用いて暗号化および復号化する手順は以下の通り。

- 送りたいメッセージを $m$ とする
- 公開鍵を用いて $m$ を $k_1$ 乗した後に、割った余りを $C$ （暗号文）とする
- 受信者は $C$ を $k_2$ 乗した後に、 $n$ で割ることで $m$ を復号できる

このような仕組みにより、送信者のメッセージは受信者にしか復号できない。

また、秘密鍵を用いて暗号化したメッセージを公開鍵で復号するということもできる。この場合、公開鍵は公開されている前提のため、機密性の確保はできないが、発信元の完全性・真正性は証明できるため、デジタル署名などに用いられる。

### ECC

**ECC**（**楕円曲線暗号**: Elliptic Curve Cryptography）は、公開鍵暗号方式の一種で、RSAと同じレベルのセキュリティを実現するためにより短い鍵長を使用できるという特徴がある。ECCは、楕円曲線上の数学的な操作を元に暗号化を行う。鍵長が短いため、高いセキュリティレベルを維持しながら、処理速度の向上やリソース使用量の削減が可能となる。

### DSA

**DSA**(Digital Signature Algorithm)は、公開鍵暗号方式の一種で、デジタル署名アルゴリズムとして用いられる。データの改ざん検知や送信者の身元確認というデジタル署名において重要な機能を提供する。暗号化機能自体は持たないので、別の共通鍵暗号方式と併用されることが一般的。


## ハッシュ

**ハッシュ**は、任意長の入力データを固定長のデジタル指紋（ハッシュ値）に変換する数学的な関数。ハッシュ関数は入力データからハッシュ値を生成することは容易であるが、ハッシュ値から入力データを復元することは困難であり、異なる入力に対しては異なるハッシュ値が、同じ入力に対しては同じハッシュ値が生成される、という特徴がある。パスワード保存時にハッシュ値を保存したり、ファイルのダウンロード時にハッシュ値を提供してそのファイルの正当性を証明したりする、といった目的で使用される。

### 衝突

**衝突**は、ハッシュ関数において、異なる入力値に対して同じハッシュ値を出力してしまう問題。強力なハッシュ関数は衝突が非常に低い確率で起こるように設計されている。

### MD5

**MD5**(Message Digest Algorithm 5)は、ハッシュ関数の一種で、128ビットの固定長ハッシュ値を生成する。元々はメッセージの整合性チェックやデータの一意性の確認など、データのハッシュ化に広く使用されていたが、セキュリテイl上の脆弱性が見つかったため、現在では非推奨となっている。具体的には、衝突抵抗性が低く、非常に高速で多数のハッシュ値を計算できるため攻撃者が容易に事前計算やレインボーテーブルの作成を行えてしまう、という欠点がある。

### SHA-1

**SHA-1**(Secure Hash Algorithm 1)は、ハッシュ関数の一種で、デジタル署名やデータの整合性確認に使用されていた。現在はセキュリティ上の脆弱性が見つかっているため非推奨となっている。具体的にはMD5と同じく、衝突抵抗性が低く、非常に高速で多数のハッシュ値を計算できるため攻撃者が容易に事前計算やレインボーテーブルの作成を行えてしまう、という欠点がある。

### SHA-2

**SHA-2**(Secure Hash Algorithm 2)は、SHA-1の後継として開発されたハッシュ関数で、セキュリティ上の脆弱性を改善したより強力なハッシュ関数として現在も広く採用されている。SHA-224、SHA-256、SHA-384、SHA-512などの異なるビット長のハッシュ関数が含むファミリーの総称で、強力なセキュリティと高速な計算性能を持つ。


## デジタル署名

**デジタル署名**は、公開鍵暗号方式を利用して、電子的な文書やデータが改ざんされることを防止し、送信者の身元を証明する技術。

デジタル署名の流れは以下の通り。

- 署名者はキーペアを作成し、公開鍵を公開する
- 暗号化データの圧縮のため、ハッシュ関数を用いてデータのハッシュ値を算出する
- 秘密鍵を用いて、ハッシュ値を暗号化する
- 暗号化したハッシュ値とデータを受信者に送信する
- 受信者は公開鍵を使用してハッシュ値を復号する
- 受信者はハッシュ関数を使用して受信したデータをハッシュ化し、受け取ったハッシュ値と同じ値になるか照合することで、データに改ざんがないことを確認する


## PKI

**PKI**（公開鍵基盤: Public Key Infrastructure）は、公開鍵暗号方式において、公開鍵が送信者の正当なものであることを、第三者機関が保証する仕組み。

PKIにより公開鍵の正当性を保証するための流れは以下の通り。

- 送信者は公開鍵と身分証明書を登録局に登録する
- 登録局は発行局に電子証明書の発行を依頼する
- 認証局は、登録局と発行局を経てデジタル証明書を認証局が発行した秘密鍵を用いて暗号化し、デジタル署名を作成する
- 送信者は認証局が作成したデジタル署名を受け取り、これを受信者に送る
- 受信者は認証局から公開鍵を受け取る
- 受信者は送信者から受け取ったデジタル署名を公開鍵で復号する
- デジタル署名に含まれている送信者が発行した公開鍵と送信者の情報により、これが正当な公開鍵であることが確認できる

### 認証局

**認証局**(**CA**: Certificate Authority)は、PKIにおいて公開鍵が送信者の正当なものであることを保証する、政府などの信頼できる第三者機関。登録局と発行局を合わせたものを指す。申請者の身元確認を行い、デジタル証明書を発行して署名を行い、証明書の信頼性と正当性を保証する役割を持つ。

### 登録局

**登録局**(**RA**: Registration Authority)は、認証局の補助的な役割を担い、申請者の身元確認と、発行局への証明書の発行依頼を行う。

### 発行局

**発行局**(**IA**: Issuing AUthority)は、認証局の補助的な役割を担い、登録局からの申請を受けて証明書の発行を行う。
