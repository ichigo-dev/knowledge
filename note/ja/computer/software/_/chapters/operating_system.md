# 『オペレーティングシステム』ノート

（最終更新： 2023-03-07）


## 目次

1. [オペレーティングシステム](#オペレーティングシステム)
1. [OSの種類](#osの種類)
	1. [Windows](#windows)
	1. [macOS](#macos)
	1. [UNIX](#unix)
	1. [Linux](#linux)
	1. [Android](#android)
	1. [iOS](#ios)
1. [カーネル](#カーネル)
	1. [マイクロカーネル](#マイクロカーネル)
	1. [モノリシックカーネル](#モノリシックカーネル)
	1. [カーネルモード](#カーネルモード)
	1. [ユーザモード](#ユーザモード)
1. [OSの起動](#osの起動)
	1. [BIOS](#bios)
	1. [UEFI](#uefi)
	1. [ブートローダ](#ブートローダ)
	1. [ネットワークブート](#ネットワークブート)
	1. [マルチブート](#マルチブート)
	1. [フラッシュブートローダ](#フラッシュブートローダ)
1. [ジョブ](#ジョブ)
	1. [ジョブ管理システム](#ジョブ管理システム)
	1. [JCL](#jcl)
	1. [マスタスケジューラ](#マスタスケジューラ)
	1. [スプーリング](#スプーリング)
1. [プロセス](#プロセス)
	1. [タスク管理システム](#タスク管理システム)
	1. [プロセスの状態遷移](#プロセスの状態遷移)
	1. [到着順方式](#到着順方式)
	1. [処理時間方式](#処理時間方式)
	1. [優先度順方式](#優先度順方式)
	1. [ラウンドロビン方式](#ラウンドロビン方式)
	1. [プリエンプション方式](#プリエンプション方式)
	1. [多段フィードバック待ち行列](#多段フィードバック待ち行列)
	1. [イベントドリブンプリエンプション方式](#イベントドリブンプリエンプション方式)
	1. [ディスパッチャ](#ディスパッチャ)
	1. [スレッド](#スレッド)
1. [記憶管理](#記憶管理)
	1. [オーバレイ](#オーバレイ)
	1. [スワッピング](#スワッピング)
1. [仮想記憶管理](#仮想記憶管理)
	1. [ページング方式](#ページング方式)
	1. [FIFO](#fifo)
	1. [LRU](#lju)
	1. [LFU](#lfu)
	1. [セグメント方式](#セグメント方式)


## オペレーティングシステム

**オペレーティングシステム**(**OS**: Operating system)は、アプリケーションソフトウェアにハードウェア資源を分配したり、ユーザや他のプログラムに対して使いやすいユーティリティプログラムを提供したり、コンピュータ全体の制御を行うプログラム。


## OSの種類

### Windows

**Windows**は、Microsoftが提供するオペレーティングシステムで、個人利用のOSとしては世界で最も利用者数が多い。技術的な知識を有さないユーザ数も多いため、攻撃者からも狙われやすく、ウィルスの種類も多い。

### macOS

**macOS**は、Appleが提供するオペレーティングシステムで、高いユーザエクスペリエンスが特徴。一般ビジネスや個人利用においてはWindowsに及ばないものの、クリエイティブな分野で活躍している。

### UNIX

**UNIX**は、1960年代にアメリカのAT&T社のベル研究所で誕生したOSで、同研究所でもともと開発されていたMULTICSというOSがあったが、多機能なOSを目指したことで研究が頓挫し、その片隅で開発されていたミニマルなOSであるUNIXが様々な実験プロジェクトに用いられるようになった。当時UNIXは商用として考えられていなかったため、ライセンスが無料で自由に利用でき、ソースコードも配布されていたことから多くのユーザが研究や開発に利用できた。

このような背景から多くの企業や団体が独自実装したUNIXが登場したため、AT&Tが正式にライセンス契約を始めることとなった。AT&TのUNIXを**System V**と呼び、正式なライセンス契約を結んだ組織のみが自社のOSをUNIXと宣言できるようになった。一方でAT&Tとライセンス契約を結ばなかった組織のOSは**UNIX互換OS**と呼ばれるようになった。

様々な種類のUNIXが広まる中、**BSD**（Berkeley Software Distribution, バークレー版UNIX）は初めて本格的にTCP/IPによる通信をサポートしたことで広く知られるようになった。

UNIXは現在でも、ITやサーバといった分野においては一定のシェアを有している。基本的にはCUIによる操作となっているが、GUI環境の導入も可能。

### Linux

**Linux**は、Linuxカーネル（狭義のLinux）と、GNUが提供するソフトウェア群などから構成されるOS。UNIXを模倣して作られているが、全く別のOSとして設計されており、オープンソースソフトウェアとして提供されている。基本的にはCUIによる操作となっているが、GUI環境の導入も可能。

### Android

**Android**は、Googleが開発したモバイル用のOS。LinuxやOSSをベースとしており、主にスマートフォンやタブレットなどのタッチスクリーンモバイルデバイス向けに設計されている。そのほか、IoTデバイスにも組み込まれることが多い。

### iOS

**iOS**は、Appleが開発しているモバイル用のOS。スマートフォンのiPhoneシリーズに搭載されているOSで、Androidと比べるとカスタマイズ性やコスト面では劣るものの、アプリケーションのセキュリティが高いという利点がある。


## カーネル

**カーネル**とは、OSの最も核となる機能の部分のこと。個々のアプリケーションからカーネルの機能を使用するにはAPI（システムコール、SVC=スーパバイザコール）を利用する。

### マイクロカーネル

**マイクロカーネル**は、OSの機能の中でも最小限の機能だけを有するカーネル。他の機能はサービスとして実行する。

### モノリシックカーネル

**モノリシックカーネル**は、OSの機能の多くをカーネルに含み、カーネルだけで豊富な機能を提供できるもの。

### カーネルモード

**カーネルモード**（**スーパバイザモード**）は、コンピュータに対する高い権限を持って処理を実行するモード。コンピュータ資源のあらゆる部分にアクセスが可能で、実行する命令も優先度が高くなっている。

### ユーザモード

**ユーザモード**は、アプリケーションソフトウェアを実行するためのモードで、比較的権限が低く、アプリケーションに必要な資源だけにアクセスできる。


## OSの起動

コンピュータの電源を入れると、CPUはマザーボード上のROMに記憶されているBIOSやUEFIといったファームウェアインタフェースプログラムを実行する。その後、ファームウェインタフェースによって読み込まれたブートローダを用いてオペレーティングシステムが起動される。

### BIOS

**BIOS**(Basic Input/Output System)は、正常起動に要するハードウェアが揃っているかを確認し、ブートローダを立ち上げてコンピュータを起動するファームウェアインタフェース。

### UEFI

**UEFI**(Unified Extensible Firmware Interface)は、近年主流となっているファームウェアインタフェース。ファームウェアをコンピュータに接続し、ハードウェアコンポーネントの初期化とオペレーティングシステムの起動に使用される。

### ブートローダ

**ブートローダ**（**ブートストラップ**）は、コンピュータにOSを読み込ませるために用いるプログラムのことで、OS自身に組み込まれている。ブートローダとしては、Linuxに付属していた**LILO**(Linux Loader)や、UNIX系OSで使われる**GRUB**(Grand Unified Bootloader)といったものが代表的。

### ネットワークブート

**ネットワークブート**は、ネットワーク上の他のコンピュータからOSを取り込んで起動する仕組み。

### マルチブート

**マルチブート**（**デュアルブート**、**トリプルブート**...）は、1台のコンピュータに複数のOSを組み込む機能。BIOSの設定によってブートローダの起動優先順位を入れ替えたり、マルチブート対応のブートローダによって起動時にどのOSを読み込むか選択したりする。

### フラッシュブートローダ

**フラッシュブートローダ**は、書き換え可能なフラッシュメモリのブートローダ領域に配置されたブートローダ。


## ジョブ

**ジョブ**は、ユーザがコンピュータに依頼した仕事の単位のこと。

### ジョブ管理システム

**ジョブ管理システム**（**ジョブスケジューラ**）は、複数のジョブの起動や終了を制御したり、ジョブの実行・終了状態の監視などを行うソフトウェア。以下のプログラムから構成される。

- **リーダ**（ジョブ読み取り）: ジョブの入力、入力待ち行列を作成する
- **イニシエータ**（ジョブ開始）: 待ち行列のジョブの優先度を考慮して実行するジョブを選択し、資源を割り当てる
- **ターミネータ**（ジョブ終了）: 実行終了したジョブステップが使用していた主記憶領域を解放し、入出力ファイルの後始末を行ったりする
- **ライタ**（ジョブ書き出し）: 出力ジョブ待ち行列に登録されているジョブの女王から、出力するべき情報を決定する

ジョブの実行順序を決定することを**スケジューリング**という。

### JCL

**JCL**（**ジョブ制御言語**: Job Control Language）は、ジョブステップを指定するための言語。JCLによってプログラムの実行順序、ジョブの実行に必要な資源などを記述する。ジョブを構成する1つ1つの処理単位を**ジョブステップ**という。

### マスタスケジューラ

**マスタスケジューラ**は、オペレータからの指示を解釈してジョブスケジューラへ指示を出したり、メッセージを返す役割を担うスケジューラで、メモリ上に常駐する。

### スプーリング

**スプーリング**（**スプール**）は、プリンタなどの低速の装置にジョブの結果を出力する場合に、一時的にデータを書き込んでおくこと、あるいはその領域。CPUを素早く解放し、出力装置がデータを受け付ける準備ができてから処理を行うことで、資源の無駄をなくす。


## プロセス

**プロセス**（**タスク**）は、コンピュータから見た仕事の単位（OSの元で実行される内部処理の単位）のこと。ジョブ（ジョブステップ）をCPUが実行するのに適した単位に分割したもの。

### タスク管理システム

**タスク管理システム**（**タスクスケジューラ**）は、複数のタスクの実行順を決定するプログラム。

### プロセスの状態

生成されたプロセスは、**実行可能状態**、**実行状態**、**待ち状態**の3つの状態を遷移させながら実行を進めていく。

タスクは生成されるとまず実行可能状態となる。そこでCPUに空きができると実行状態に移り、処理を実行する。実行が完了するとタスクが消滅し、実行中に入出力が必要な処理などのCPU以外を使用する処理が発生すると、待ち状態に移る。入出力などの処理が完了すると、待ち状態から実行可能状態に移行する。

実行状態のタスクを実行中に**タイムクォンタム**（ひとつのタスクに割り当てられた時間）を使い切ると、実行可能状態に戻る。また、実行状態のタスクを中断させる**プリエンプション**が発生した場合も実行可能状態に戻る。プリエンプションは、他に優先度が高いタスクが生成された場合や、割込みが起こった場合に発生する。

### 到着順方式

**到着順方式**（**ノンプリエンプション方式**）は、タスクを到着順で処理する。**FIFO**(First In First Out)とも呼ばれる。

### 処理時間順方式

**処理時間方式**は、タスクの処理時間が短いものから順に処理を行う。

### 優先度順方式

**優先度順方式**は、タスクを優先度順で処理する。

### ラウンドロビン方式

**ラウンドロビン方式**は、ひとつひとつのタスクに同じタイムクォンタムを割り当て、一定時間ごとに順番に処理を回していく方式。

### プリエンプション方式

**プリエンプション方式**（**プリエンプティブ方式**）は、タスクに優先度を付け、優先度の高いタスクが実行可能状態になるとプリエンプションを発生させる方式。

### 多段フィードバック待ち行列

**多段フィードバック待ち行列**は、複数の優先度待ち行列を持ち、高い優先度の待ち行列から順次処理していく方式。低い優先度で長時間待っているタスクは優先度を上げ、一度実行したタスクの優先度を下げるといったフィードバック調整を行う。

### イベントドリブンプリエンプション方式

**イベントドリブンプリエンプション方式**は、割込みによってタスクの切り替えを行うイベントドリブン方式と、優先度の高いタスクを実行させるプリエンプション方式を組み合わせた方式。**イベント**は、タスクの状態を、入出力の終了や外部からのコマンド入力などで割込みにより通知する仕組みのこと。

### ディスパッチャ

**ディスパッチャ**（**タスク指名ルーチン**）は、実行可能状態のタスクを調べ、最も優先度の高いタスクを実行状態にしたり、実行状態のタスクを中断したりするプログラム。

### スレッド

**スレッド**は、プロセス中で生成された子プロセスのこと。


## 記憶管理

**記憶管理**は、主記憶に配置するプログラムを効率的に配置し、主記憶を有効に利用するための機能。

### ロード

**ロード**は、プログラムを実行するために、補助記憶装置から主記憶装置に読み込むこと。

### オーバレイ

**オーバレイ**は、あらかじめプログラムを分けて補助記憶装置に格納しておき、必要なプログラムだけを主記憶装置にロードする方式。

### スワッピング

**スワッピング**は、メモリの内容を補助記憶装置のスワップファイルに書き出して、他のタスクがメモリを使えるように解放する方式。メモリからスワップに取り出すことを**スワップアウト**、スワップからメモリに戻すことを**スワップイン**という。


## 仮想記憶管理

**仮想記憶**は、主記憶装置よりも大きな領域をメモリ空間として利用できるようにする技術。補助記憶上に仮想記憶領域を用意し、OSが自動的にデータを出し入れすることで主記憶装置を仮想的に拡張する。

### ページング方式

**ページング方式**は、プログラムを固定長の**ページ**という単位に分けて、ページごとに補助記憶装置の仮想記憶領域に取り出す方式。メモリから仮想記憶に取り出すことを**ページアウト**、仮想記憶からメモリに戻すことを**ページイン**という。

メモリ上に必要なページがない状態を**ページフォールト**といい、ページフォールトが頻繁に起こってページインとページアウトが繰り返されることを**スラッシング**という。スラッシングが発生すると著しくシステムの応答速度が低下する。

ページの内容が必要となった時点で仮想記憶の内容を主記憶にロードする**デマンドページング方式**と、将来必要とされそうな仮想記憶の内容をあらかじめ主記憶にロードしておく**プリページング方式**がある。

### FIFO

**FIFO**(First In First Out)はページングのページ置き換えアルゴリズムのひとつで、最初にページインしたページを最初にページアウトする方式。

### LRU

**LRU**(Least Recently Used)はページングのページ置き換えアルゴリズムのひとつで、最後に使用されてからの経過時間が最も長いページを最初にページアウトする方式。

### LFU

**LFU**(Least Frequently Used)はページングのページ置き換えアルゴリズムのひとつで、使用頻度が最も低いページを最初にページアウトする方式。

### セグメント方式

**セグメント方式**は、プログラムを可変長の**セグメント**という単位に分けて、セグメントごとに補助記憶装置の仮想記憶領域に取り出す方式。メモリから仮想菊に取り出すことを**ロールアウト**、仮想記憶からメモリに戻すことを**ロールイン**という。


## 参考文献

- [角谷一成.令和05年 基本情報技術者合格教本.株式会社技術評論社, 2022, 575](https://gihyo.jp/book/2022/978-4-297-13164-7)
- [瀬戸美月.徹底攻略 応用情報技術者教科書 令和4年度.株式会社インプレス, 2021, 814](https://book.impress.co.jp/books/1121101057)
