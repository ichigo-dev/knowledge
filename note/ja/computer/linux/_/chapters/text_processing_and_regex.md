# 『テキスト処理と正規表現』ノート

（最終更新： 2023-03-17）


## 目次

1. [ファイルサイズの確認](#ファイルサイズの確認)
1. [ファイル行のソート](#ファイル行のソート)
1. [重複行の除去](#重複行の除去)
1. [テキストの切り出し](#テキストの切り出し)
1. [文字列の変換と削除](#文字列の変換と削除)
1. [ファイルの差分の確認](#ファイルの差分の確認)
1. [ファイルの差分の適用](#ファイルの差分の適用)


## ファイルサイズの確認

`wc` は、ファイルの行数、単語数、バイト数を数えるコマンド。

コマンドの書式は以下の通り。

```
wc [OPTION]... [FILE]...
```

例えば、 `test.txt` の行数、単語数、バイト数をカウントするには、以下のコマンドを実行する。

```sh
$ wc test.txt
11  31 277 test.txt
```

代表的なオプションは以下の通り。

| オプション | 概要                   |
| ---------- | :--------------------- |
| `-l`       | 行数のみを表示する     |
| `-w`       | 単語数のみを表示する   |
| `-c`       | バイト数のみを表示する |


## ファイル行のソート

`sort` は、テキストの内容を行単位でソートするコマンド。デフォルトでは、辞書順（アルファベット順）でソートを行う。

コマンドの書式は以下の通り。

```
sort [OPTION]... [FILE]...
```

例えば、 `test.txt` の中身をアルファベット順でソートした結果を出力したい場合、以下のコマンドを実行する。

```sh
$ sort test.txt
```

代表的なオプションは以下の通り。

| オプション | 概要                               |
| ---------- | :--------------------------------- |
| `-n`       | 文字列を数値とみなしてソートする。 |
| `-r`       | 逆順にソートする。                 |


## 重複行の除去

`uniq` は、連続した同じ内容の行を省くコマンド。重複する行が連続していない場合は省かれないため、 `sort` コマンドと組み合わせる場合が多い。

コマンドの書式配下の通り。

```
uniq [OPTION]... [INPUT [OUTPUT]]
```

例えば、 `test.txt` の内容から連続する重複行を省きたい場合、以下のコマンドを実行する。

```sh
$ uniq test.txt
```

`-c` オプションを使用すると、重複している行数をカウントすることができる。


## テキストの切り出し

`cut` は、入力業の一部分を切り出して出力するコマンド。

コマンドの書式は以下の通り。

```
cut OPTION... [FILE]...
```

例えば、CSVファイル（カンマ区切りのファイル）の3番目のフィールドだけを出力したい場合は、以下のコマンドを実行する。

```sh
$ cut -d , -f 3 test.csv
```

`-d` オプションは入力行を分割するための区切り文字の指定に、 `-f` は取り出すフィールド番号の指定に用いる。


## 文字列の変換と削除

`tr` は、入力テキストの内容から、特定の文字を置き換えるためのコマンド。

コマンドの書式配下の通り。

```
tr [OPTION]... STRING1 [STRING2]
```

例えば、セミコロン区切りでデータが記載された `data.txt` をCSVとして出力したい場合は、以下のコマンドを実行する。

```sh
$ cat data.txt | tr ; ,
```

`-d` オプションを使用すると、指定された文字を削除することができる。


## ファイルの差分の確認

`diff` は、2つのファイルの差分を表示するためのコマンド。例えば、編集前後のプログラムのソースコードや設定ファイルの差分を確認するために使用される。

コマンドの書式は以下の通り。

```
diff [OPTION]... FILES
```

例えば、 `test1.txt` と `test2.txt` の差分を確認したい場合は、以下のコマンドを実行する。

```sh
$ diff test1.txt test2.txt
```

`diff` の出力は、以下の3つの変更種別がある。

| 記号              | 内容                                                                       |
| ----------------- | :------------------------------------------------------------------------- |
| `<範囲1>a<範囲2>` | 1つ目のファイルの範囲1の後に、2つ目のファイルの範囲2の内容が追加された。   |
| `<範囲1>c<範囲2>` | 1つ目のファイルの範囲1の箇所に、2つ目のファイルの範囲2の内容が変更された。 |
| `<範囲1>d<範囲2>` | 1つ目のファイルの範囲1の箇所が削除された。                                 |

`-u` オプションを付与すると、ファイルの差分をユニファイド出力形式で出力する。


## ファイルの差分の適用

`patch` は、ファイルの差分を適用するためのコマンド。

コマンドの書式は以下の通り。

```
patch [OPTION]... [ORIGINAL_FILE [PATCH_FILE]]
```

例えば、 `old.txt` と `new.txt` の差分をパッチとして `new.txt` に適用したい場合は、以下のコマンドを実行する。

```sh
$ diff old.txt new.txt | patch new.txt
```


## 正規表現

**正規表現**は、文字列のパターンを表現するための方法。
