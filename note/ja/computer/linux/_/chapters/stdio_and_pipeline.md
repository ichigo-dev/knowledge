# 『標準入出力とパイプライン』ノート

（最終更新： 2023-03-28）


## 目次

1. [標準入出力](#標準入出力)
	1. [標準入力](#標準入力)
	1. [標準出力](#標準出力)
	1. [標準エラー出力](#標準エラー出力)
1. [リダイレクト](#リダイレクト)
	1. [nullデバイス](#nullデバイス)
1. [パイプライン](#パイプライン)
1. [フィルタ](#フィルタ)


## 標準入出力

**標準入出力**(stdio: standard input/output)は、[標準入力](#標準入力)、[標準出力](#標準出力)、[標準エラー出力](#標準エラー出力)を合わせたもの。[OS](../../../software/_/chapters/operating_system.md#オペレーティングシステム)によって最初に用意される。

### 標準入力

**標準入力**(stdin: standard input)は、[プログラム](../../../../programming/_/chapters/programming.md#プログラム)のデフォルトのデータ入力元。通常は[キーボード](../../../hardware/_/chapters/io_unit.md#キーボード)が使用される。[ファイルディスクリプタ](./file.md#ファイルディスクリプタ)の $0$ に割り当てられる。

### 標準出力

**標準出力**(stdout: standard output)は、[プログラム](../../../../programming/_/chapters/programming.md#プログラム)のデフォルトのデータ出力先。通常は[端末ディスプレイ](./shell_and_terminal.md#ターミナル)が使用される。[ファイルディスクリプタ](./file.md#ファイルディスクリプタ)の $1$ に割り当てられる。

### 標準エラー出力

**標準エラー出力**(stderr: standard error output)は、[プログラム](../../../../programming/_/chapters/programming.md#プログラム)の[エラー](../../../../programming/_/chapters/programming.md#エラー)メッセージを出力するためのデフォルトの出力先。通常は[端末ディスプレイ](./shell_and_terminal.md#ターミナル)が使用される。[ファイルディスクリプタ](./file.md#ファイルディスクリプタ)の $2$ に割り当てられる。


## リダイレクト

**リダイレクト**は、[標準入出力](#標準入出力)先をデフォルトのものから切り替えるための機能。

[標準入力](#標準入力)先として、[キーボード](../../../hardware/_/chapters/io_unit.md#キーボード)の代わりに[ファイル](../../../software/_/chapters/file_system.md#ファイル)を使用する場合、 `<` 記号を用いる。以下は、 `cat` [コマンド](./basic_command.md#コマンド)に `test.txt` を入力リダイレクトする例。

```sh
$ cat < file.txt
```

[標準出力](#標準出力)先として、[ターミナル](./shell_and_terminal.md#ターミナル)の画面上ではなく[ファイル](../../../software/_/chapters/file_system.md#ファイル)を使用する場合、 `>` 記号を用いる。以下は、 `ls` [コマンド](./basic_command.md#コマンド)の出力を `test.txt` にリダイレクトする例。

```sh
$ ls > test.txt
```

[標準エラー出力](#標準エラー出力)先として、[ターミナル](./shell_and_terminal.md#ターミナル)の画面上ではなく[ファイル](../../../software/_/chapters/file_system.md#ファイル)を使用する場合、 `2>` 記号を用いる。以下は、 `ls` [コマンド](./basic_command.md#コマンド)の[エラー](../../../../programming/_/chapters/programming.md#エラー)メッセージ出力を `error.txt` にリダイレクトする例。

```sh
$ ls /xxx 2> error.txt
```

[標準出力](#標準出力)と[標準エラー出力](#標準エラー出力)をまとめてリダイレクトするには、[標準出力](#標準出力)をリダイレクトした上で、末尾に `2>&1` 記号を追加する。以下は、 `ls` [コマンド](./basic_command.md#コマンド)の出力と[エラー](../../../../programming/_/chapters/programming.md#エラー)メッセージを `result.txt` にリダイレクトする例。

```sh
$ ls /xxx > result.txt 2>&1
```

出力リダイレクトを用いて[ファイル](../../../software/_/chapters/file_system.md#ファイル)に書き込みを行う場合、元の[ファイル](../../../software/_/chapters/file_system.md#ファイル)が上書きされてしまう。上書きを防止して末尾に追記する場合は、 `>>` 記号を用いる。以下は、 `ls` [コマンド](./basic_command.md#コマンド)の出力を `test.txt` に追記する例。

```sh
$ ls >> test.txt
```

リダイレクトに用いる記号は以下の通り。

| 記号          | 内容                                           |
| ------------- | :--------------------------------------------- |
| `< FILE`      | 標準入力を `FILE` に変更する                   |
| `> FILE`      | 標準出力を `FILE` に変更する                   |
| `>> FILE`     | 標準出力の出力を `FILE` の末尾に追記する       |
| `2> FILE`     | 標準エラー出力を `FILE` に変更する             |
| `2>> FILE`    | 標準エラー出力の出力を `FILE` の末尾に追記する |
| `> FILE 2>&1` | 標準出力と標準エラー出力を `FILE` に変更する   |

### nullデバイス

**nullデバイス**(/dev/null)は、常に空であるという特別なデバイスファイルで、[リダイレクト](#リダイレクト)先としてよく利用される。

nullデバイスを[標準入力](#標準入力)の入力先として用いると、何も内容を返さない。nullデバイスを[標準出力](#標準出力)の出力先として用いると、書き込んだデータはすべて破棄される。


## パイプライン

**パイプライン**は、複数の[コマンド](./basic_command.md#コマンド)を連携させるための仕組みで、[コマンド](./basic_command.md#コマンド)の[標準出力](#標準出力)を別の[コマンド](./basic_command.md#コマンド)の[標準入力](#標準入力)に接続することができる。

以下は、 `ls` [コマンド](./basic_command.md#コマンド)の出力を `less` [コマンド](./basic_command.md#コマンド)に入力する例。

```sh
$ ls -la | less
```

また、パイプラインは3つ以上の[コマンド](./basic_command.md#コマンド)をつなげることもできる。以下は、 `ls` [コマンド](./basic_command.md#コマンド)の出力を `cat` に入力して `cat` で行番号を付け、 `less` に入力する例。

```sh
$ ls -la | cat -n | less
```


## フィルタ

**フィルタ**は、[標準入力](#標準入力)を入力として受け取り[標準出力](#標準出力)に出力する[コマンド](./basic_command.md#コマンド)の総称。代表的なフィルタ[コマンド](./basic_command.md#コマンド)としては、 `cat` や `head` 、 `tail` などがある。
