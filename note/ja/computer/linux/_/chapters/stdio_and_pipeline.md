# 『標準入出力とパイプライン』ノート

（最終更新： 2023-03-17）


## 目次

1. [標準入出力](#標準入出力)
	1. [標準入力](#標準入力)
	1. [標準出力](#標準出力)
	1. [標準エラー出力](#標準エラー出力)
1. [リダイレクト](#リダイレクト)
	1. [nullデバイス](#nullデバイス)
1. [パイプライン](#パイプライン)
1. [フィルタ](#フィルタ)


## 標準入出力

**標準入出力**(stdio: standard input/output)は、標準入力、標準出力、標準エラー出力を合わせたもの。OSによって最初に用意される。

### 標準入力

**標準入力**(stdin: standard input)は、プログラムのデフォルトのデータ入力元。通常はキーボードが使用される。通常はファイルディスクリプタの0に割り当てられる。

### 標準出力

**標準出力**(stdout: standard output)は、プログラムのデフォルトのデータ出力先。通常は端末ディスプレイが使用される。通常はファイルディスクリプタの1に割り当てられる。

### 標準エラー出力

**標準エラー出力**(stderr: standard error output)は、プログラムのエラーメッセージを出力するためのデフォルトの出力先。通常は端末ディスプレイが使用される。通常はファイルディスクリプタの2に割り当てられる。


## リダイレクト

**リダイレクト**は、標準入出力先をデフォルトのものから切り替えるための機能。

標準入力として、キーボードの代わりにファイルを使用する場合、 `<` 記号を用いる。以下は、 `cat` コマンドに `test.txt` を入力リダイレクトする例。

```sh
$ cat < file.txt
```

標準出力として、ターミナルの画面上ではなくファイルを使用する場合、 `>` 記号を用いる。以下は、 `ls` コマンドの出力を `test.txt` にリダイレクトする例。

```sh
$ ls > test.txt
```

標準エラー出力として、ターミナルの画面上ではなくファイルを使用する場合、 `2>` 記号を用いる。以下は、 `ls` コマンドのエラーメッセージ出力を `error.txt` にリダイレクトする例。

```sh
$ ls /xxx 2> error.txt
```

標準出力と標準エラー出力をまとめてリダイレクトするには、標準出力をリダイレクトした上で、末尾に `2>&1` 記号を追加する。以下は、 `ls` コマンドの出力とエラーメッセージを `result.txt` にリダイレクトする例。

```sh
$ ls /xxx > result.txt 2>&1
```

出力リダイレクトを用いてファイルに書き込みを行う場合、元のファイルが上書きされてしまう。上書きを防止して末尾に追記する場合は、 `>>` 記号を用いる。以下は、 `ls` コマンドの出力を `test.txt` に追記する例。

```sh
$ ls >> test.txt
```

リダイレクトに用いる記号は以下の通り。

| 記号          | 内容                                           |
| ------------- | :--------------------------------------------- |
| `< FILE`      | 標準入力を `FILE` に変更する                   |
| `> FILE`      | 標準出力を `FILE` に変更する                   |
| `>> FILE`     | 標準出力の出力を `FILE` の末尾に追記する       |
| `2> FILE`     | 標準エラー出力を `FILE` に変更する             |
| `2>> FILE`    | 標準エラー出力の出力を `FILE` の末尾に追記する |
| `> FILE 2>&1` | 標準出力と標準エラー出力を `FILE` に変更する   |

### nullデバイス

**nullデバイス**(/dev/null)は、常に空であるという特別なデバイスファイルで、リダイレクト先としてよく利用される。

nullデバイスを標準入力の入力先として用いると、何も内容を返さない。nullデバイスを標準出力の出力先として用いると、書き込んだデータはすべて破棄される。


## パイプライン

**パイプライン**は、複数のコマンドを連携させるための仕組みで、コマンドの標準出力を別のコマンドの標準入力に接続することができる。

以下は、 `ls` コマンドの出力を `less` コマンドに入力する例。

```sh
$ ls -la | less
```

また、パイプラインは3つ以上のコマンドをつなげることもできる。以下は、 `ls` コマンドの出力を `cat` に入力して `cat` で行番号を付け、 `less` に入力する例。

```sh
$ ls -la | cat -n | less
```


## フィルタ

**フィルタ**は、標準入力を入力として受け取り標準出力に出力するコマンドの総称。代表的なフィルタコマンドとしては、 `cat` や `head` 、 `tail` などがある。
