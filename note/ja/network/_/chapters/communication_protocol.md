# 『通信プロトコル』ノート

（最終更新： 2023-04-24）


## 目次

1. [TCP/IP](#tcpip)
	1. [プロトコルスイート](#プロトコルスイート)
	1. [アプリケーション層](#アプリケーション層)
	1. [トランスポート層](#トランスポート層)
	1. [インターネット層](#インターネット層)
	1. [データリンク層](#データリンク層)
1. [TCP/IPの標準化](#tcp-ipの標準化)
	1. [IETF](#ietf)
	1. [RFC](#rfc)
	1. [STD](#std)
	1. [FYI](#fyi)
	1. [標準化の流れ](#標準化の流れ)


## TCP/IP

**TCP/IP**(Transmission Control Protocol/Internet Protocol)は、[IETF](#ietf)で標準化されている、[インターネット](./network.md#インターネット)で使われている[プロトコルスイート](#プロトコルスイート)。TCP/IPは、[OSI基本参照モデル](./network_architecture.md#osi基本参照モデル)によく似た[レイヤ](./network_architecture.md#レイヤ)構造で[プロトコル](./network_architecture.md#プロトコル)を体系化している。

TCP/IPは「実装すること」を念頭に作業が進められ、その方針から素早く[プロトコル](./network_architecture.md#プロトコル)を完成させることができた。そのため、[ISO](./network_architecture.md#iso)の[OSI](./network_architecture.md#osi基本参照モデル)よりも先に動作する[プロトコル](./network_architecture.md#プロトコル)を作り上げることができ、世の中に普及していくこととなった。

TCP/IPでは、[インターネット層](#インターネット層)と[トランスポート層](#トランスポート層)が[OS](../../../computer/software/_/chapters/operating_system.md#オペレーティングシステム)に組み込まれていることを想定しており、その上で[アプリケーション](../../../computer/software/_/chapters/software.md#応用ソフトウェア)が[インターネット](./network.md#インターネット)に接続されているような構成となっている。

### プロトコルスイート

**プロトコルスイート**は、複数の[プロトコル](./network_architecture.md#プロトコル)を一式で提供した[パッケージ](../../../computer/software/_/chapters/package.md#パッケージ)。

### アプリケーション層

**アプリケーション層**には、標準で様々なプロトコルが規定されており、アプリケーションごとに独自のプロトコルを実装することも可能である。TCP/IPのアプリケーションの多くは、クライアント/サーバーモデルで作られている。 サービスを提供するプログラムをサーバ、サービスを受けるプログラムをクライアントとして、サーバはいつでもクライアントの要求を受け取れるように常に起動しておく（このような常に起動して用いるプログラムをデーモンと呼ぶ）。

WWWは、インターネットが一般に普及する原動力となったアプリケーションで、Webブラウザと呼ばれるソフトウェアを通して、ネットワークの中にある様々な情報を閲覧することができる。ここで、ブラウザとサーバの間の通信に用いられるプロトコルはHTTPで、送信に用いられる主なデータフォーマットはHTMLである。

電子メールは、ネットワーク上で郵便の仕組みを再現したものである。SMTPやPOP3といったプロトコルが用いられている。もともとはテキスト形式での電子メールが一般的であったが、現在は電子メールで送信できるデータ形式を拡張するMIMEの仕様が整えられた。

ファイル転送は、異なるコンピュータのハードディスク上に存在するファイルを相互に転送することができるアプリケーション。FTPというプロトコルが用いられ、ファイルの転送を指示するための制御コネクションと、実際にデータを転送するためのデータコネクションという2つのTCPコネクションを確立する。

遠隔ログインは、遠く離れたコンピュータにログインして、そのコンピュータでプログラムを走らせることができるようにするための機能。TELNETやSSHといったプロトコルがよく用いられる。また、リモートデスクトップなどを用いる際はRDPがプロトコルとして用いられる。

ネットワーク管理には、SNMPが用いられる。SNMPで管理されるルーターやブリッジ、ホストなどをエージェントといい、これらを管理するプログラムをマネージャという。エージェントは様々な情報をMIBという構造によって管理する。

### トランスポート層

**トランスポート層**は、アプリケーションプログラム間の通信を実現する役割があるレイヤ。そのため、どのプログラムがどのプログラムと通信しているかを識別するために、ポート番号と呼ばれる識別子を用いる。トランスポート層では以下の2つの代表的なプロトコルが用いられる。

TCPは、コネクション型で信頼性のある通信を実現するために用いられる。両端のホスト間でのデータの到達性を保証する。経路の途中でパケットが失われたり順番が入れ替わったりしても、TCPがそれを解決する。コネクションの確立・切断をするだけで制御のために7回もパケットをやり取りするため、データの転送量が少ない場合は無駄が多くなる。

UDPは、コネクションレス型でデータの到達に関して信頼性のないプロトコルである。送信したデータが相手に届いているかどうかの確認は行わない。パケット数が少ない通信や、ブロードキャストやマルチキャスト通信、ビデオや音声などのマルチメディア通信に向いている。

### インターネット層

**インターネット層**（**ネットワーク層**）の代表的なプロトコルはIPで、IPアドレスをもとにしてパケットを転送する役割を担う。

IPは、ネットワークをまたいでパケットを配送し、インターネット全体にパケットを送り届けるためのプロトコル。それぞれのホストを識別するために、IPアドレスと呼ばれる識別子を用いる。

ICMPは、IPパケットの配送中に何らかの異常が発生してパケットを転送できなくなったときに、送信元に異常を知らせるために用いられるプロトコル。

ARPは、パケットの送り先のMACアドレスをIPアドレスから取得するプロトコル。

### データリンク層

**データリンク層**（**ネットワークインタフェース層**）は、データフレームをネットワーク上で隣接するコンピュータに転送する役割をもつレイヤ。

具体的には、NICを動かすためのデバイスドライバのこと。OSがNICを認識して、そのカードを利用できるように設定する必要がある。


## TCP/IPの標準化

### IETF

**IETF**(Internet Engineering Task Force)は、インターネットやTCP/IPの技術面に関する標準化団体。

### RFC

**RFC**(Request For COmments)は、IETFによって議論されて標準化されているTCP/IPのプロトコルの仕様に関するドキュメント。一度RFCになったものは、後からその内容を改定することはできない。そのため同じプロトコルでも、内容を更新するたびに新しいRFCを発行する必要がある。

- [RFCのホームページ](https://www.rfc-editor.org/)

### STD

**STD**(Standard)は、TCP/IPの主要なプロトコルや標準に対して割り当てられた、変化しない番号のこと。RFCはプロトコルの仕様が変更されるたびに番号が変わってしまい不便であるという意見から用意された。

### FYI

**FYI**(For Your Information)は、インターネットのユーザや管理者に向けて有益な情報を提供するためのRFCドキュメント。

### 標準化の流れ

TCP/IPの標準化作業は、まず、仕様を煮詰める**インターネットドラフト**(I-D: Internet-Draft)から始まる。そして、標準化したほうが良いと認められるとRFCになり、**提案標準**(Proposed Standard)になる。次に標準の草案である**ドラフト標準**(Draft Standard)になり、最後に**標準**(Standard)となる。
