# 『Rustの基礎知識』

（最終更新： 2023-02-01）


## 目次

1. [Rust](#rust)
	1. [未定義動作](#未定義動作)
	1. [並列プログラミング](#並列プログラミング)
	1. [実行速度](#実行速度)
1. [Rust開発ツール](#rust開発ツール)
	1. [rustup](#rustup)
	1. [Cargo](#cargo)
	1. [rustc](#rustc)
	1. [rustdoc](#rustdoc)


## Rust

**Rust**はシステムプログラミングのための言語であり、CやC++といった言語を置き替える次世代のプログラミング言語となることを目指している。

### 未定義動作

システムプログラミングにおいて一般的に用いられているCやC++といった言語においては、未定義動作を生じる可能性がある。プログラマは、未定義動作を避けるためのルールを意識しながらプログラムを作成する必要がある。

Rustは、ダングリングポインタやメモリの多重フリー、nullポインタの参照解決といった未定義動作をコンパイル時に検出することができる。そのため、コンパイラのチェックをパスしたプログラムは、未定義動作を引き起こさないことが保証されている。これを実現するために、Rustには多くの制約が設けられており、学習コストは他のプログラミング言語と比較しても非常に高いといえる。

### 並列プログラミング

並列プログラミングは、プログラムの実行プロセス上で複数のスレッドを用いて、高速動作を実現する方法。シングルスレッドコードでは起こりえないような未定義動作に対しても注意を払う必要があり、一般的に非常に難しいことが知られている。

Rustは、安全性のために設けられた制約の副産物として、並列プログラミングにおけるデータ競合を避けられるようになっている。読み込み専用であればデータをスレッド間で共有することが許されているが、変更される可能性があるデータに対しては、排他ロックや条件変数、チャネル、アトミック変数といった同期機構を用いてのみアクセスすることができる。

### 実行速度

C++には**ゼロオーバヘッド原則**という、実行することに対して余計なコード（ガベージコレクションなど）でCPUを消費しない、という考え方がある。

Rustには**ゼロコスト抽象化**という、抽象化の処理に最小限のコストしか払わないという考え方がある。例えば、Rustの抽象型であるtraitはコンパイル時に静的ディスパッチ（具体的な型に変換）されるため、実行時のオーバヘッドがない。

RustはC++と同様に、プログラマがコンピュータの能力を最大限活用できるようなコードを書くことをサポートする言語である。


## Rust開発ツール

Rustは、開発を支える便利なツールが提供している。

### rustup

**rustup**は、Rustのインストールやアップデートを行うためのツール。 `rustup` コマンドで、Rustのコンパイルに必要なツールチェーンやクロスコンパイル環境を構築することができる。

- [rustupのインストール](https://rustup.rs/)

`rustup install` は、Rustのツールチェーンをインストールするコマンド。配布用チャネルとして、安定リリース版の `stable` 、次期バージョンに向けたベータ版の `beta` 、開発版の `nightly` を指定できる。

```sh
# 安定版のRustツールチェーンをインストール
$ rustup install stable
```

`rustup update` は、rustup自身やRustをアップデートするコマンド。

```sh
# rustup自身のアップデートがないかをチェックし、ある場合はアップデート
$ rustup self update

# Rustのアップデートがないかをチェックし、ある場合はアップデート
$ rustup update
```

`rustup component` は、開発時に便利なツールをコンポーネントとして管理するコマンド。

```sh
# コンポーネントを追加
$ rustup component add <name>
```

### Cargo

**Cargo**は、Rustのビルドシステムとパッケージマネージャを兼ね備えたツール。Cargoを用いることで、ソースコードのビルドや、依存しているパッケージのダウンロードなどがコマンドひとつで完結するようになる。

`cargo new` および `cargo init` は、Rustのプロジェクトを作成するためのコマンド。 `cargo new` コマンドは引数にプロジェクト名を指定することで、新しいプロジェクトディレクトリ内に開発のための環境が作成される。一方、 `cargo init` はカレントディレクトリをRustプロジェクトとするためのコマンド。 `--bin` オプションをつけることでバイナリ向けのプロジェクト、 `--lib` オプションをつけることでライブラリ向けのプロジェクトとして初期化される（デフォルトは `--bin` ）。

```sh
# 新しいプロジェクトディレクトリの中に開発の環境を作成
$ cargo new <name>

# カレントディレクトリを新しいプロジェクトとして初期化
$ cargo init

# 新しいライブラリ向けのプロジェクトを作成
$ cargo new <name> --lib
```

`cargo build` は、Cargoが管理するプロジェクトをビルドするコマンド。バイナリプロジェクトの場合、 `target/debug/<name>` に実行可能ファイルが作成される。 `--release` オプションを指定することで、リリース向けに最適化したビルドを実行することができる。

```sh
# デバッグ用にビルド
$ cargo build

# リリース用にビルド
$ cargo build --release
```

`cargo run` は、Cargoが管理するプロジェクトをビルドし、実行を行うコマンド。

```sh
$ cargo run
```

`cargo check` は、Cargoが管理するプロジェクトがコンパイル可能かどうかを確かめるコマンド。 `cargo build` を使用した場合よりも早く確認できるため、開発に便利。

```sh
$cargo check
```

### rustc

**rustc**は、Rustのコンパイラ。ビルドツールとしてCargoを利用しているプロジェクトでは、

### rustdoc

**rustdoc**はRustのドキュメンテーションツールで、ソースコード中のドキュメンテーションコメントを整形してHTMLを生成する。
