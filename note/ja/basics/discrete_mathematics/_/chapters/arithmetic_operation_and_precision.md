# 『算術演算と精度』

（最終更新： 2023-02-18）


## 目次

1. [シフト演算](#シフト演算)
	1. [論理シフト](#論理シフト)
	1. [算術シフト](#算術シフト)
1. [誤差](#誤差)
	1. [桁落ち](#桁落ち)
	1. [情報落ち](#情報落ち)
	1. [丸め誤差](#丸め誤差)
	1. [打ち切り誤差](#打ち切り誤差)
	1. [オーバフロー](#オーバフロー)
	1. [アンダーフロー](#アンダーフロー)


## シフト演算

**シフト演算**は、桁を移動することで数のべき乗を計算する方法。[n進法](./radix.md#基数-1)において桁を左へシフトすると数は元の $n$ 倍に、右へシフトすると数は元の $1/n$ 倍になる。

[2進数](./radix.md#2進数)で表された数は左に $k$ [ビット](../../../_/chapters/computer_and_number.md#ビット)シフトすることで元の数の $2^k$ 倍に、右に $k$ [ビット](../../../_/chapters/computer_and_number.md#ビット)シフトすることで元の数の $2^{-k}$ 倍になる。ただしあふれた[ビット](../../../_/chapters/computer_and_number.md#ビット)は捨てられるため、必ず正しい結果になるとは限らない。

### 論理シフト

**論理シフト**は、[最上位ビット](../../../_/chapters/computer_and_number.md#msb)を[符号ビット](./numeric_representation.md#符号ビット)として扱わずに[シフト演算](#シフト演算)を行う。[符号ビット](./numeric_representation.md#符号ビット)が存在しないため、負の数を扱うことはできない。

**論理右シフト**は、[2進数](./radix.md#2進数)の数字列の全ての[ビット](../../../_/chapters/computer_and_number.md#ビット)をそのまま右へ移動し、空いた左端の[ビット](../../../_/chapters/computer_and_number.md#ビット)には $0$ を埋める。

**論理左シフト**は、[2進数](./radix.md#2進数)の数字列の全ての[ビット](../../../_/chapters/computer_and_number.md#ビット)をそのまま左へ移動し、空いた右端の[ビット](../../../_/chapters/computer_and_number.md#ビット)には $0$ を埋める。

### 算術シフト

**算術シフト**は、[最上位ビット](../../../_/chapters/computer_and_number.md#msb)を[符号ビット](./numeric_representation.md#符号ビット)として固定して[シフト演算](#シフト演算)を行う。

**算術右シフト**は、符号付き[2進数](./radix.md#2進数)の[符号ビット](./numeric_representation.md#符号ビット)以外の全ての[ビット](../../../_/chapters/computer_and_number.md#ビット)をそのまま右へ移動し、空いた左端の[ビット](../../../_/chapters/computer_and_number.md#ビット)には[符号ビット](./numeric_representation.md#符号ビット)と同じ値を埋める。

**算術左シフト**は、符号付き[2進数](./radix.md#2進数)の[符号ビット](./numeric_representation.md#符号ビット)以外の全ての[ビット](../../../_/chapters/computer_and_number.md#ビット)をそのまま左へ移動し、空いた右端の[ビット](../../../_/chapters/computer_and_number.md#ビット)には $0$ を埋める。


## 誤差

コンピュータは有限の桁数でしか数値を扱うことができないので、扱える数の範囲が決まっている。そのため、コンピュータが内部で扱う数と真の値の間には、**誤差**が生じる可能性がある。

特に、[浮動小数点数](./numeric_representation.md#浮動小数点数)は表現できる範囲の全ての値を正確に表現できるわけではないため、誤差を生じる可能性がある。[10進数](./radix.md#10進数)で表したときに有限小数であっても、[2進数](./radix.md#2進数)に変換すると無限小数となる場合もあるので注意が必要（ $0.01_{10}$ など）。

小数の計算以外でも、四則演算や[シフト演算](#シフト演算)においても[オーバフロー](#オーバフロー)などの誤差が発生する場合があるので注意。

### 桁落ち

**桁落ち**は、値がほぼ等しい2つの数値の差を求めたときに、元の数より有効桁数が減ってしまうことで生じる[誤差](#誤差)。次の例では、元の数の有効桁数は10桁であるが、計算後の有効桁数は2桁になっている。

```math
1.110100101_2 \times 2^3 - 1.110100010_2 \times 2^3 = 0.000000011_2 \times 2
```

### 情報落ち

**情報落ち**は、絶対値が非常に大きい数と小さい数で加算や減算を行った時に、小さい方の数が計算結果に反映されない[誤差](#誤差)。次の例では、有効桁数が8桁であるとすると、計算結果に小さい方の数が反映されていない。

```math
1234.5678_{10} + 0.0000001_{10} = 1234.5678001_{10} \simeq 1234.5678_{10}
```

### 丸め誤差

**丸め誤差**は、数値の有効桁数の関係で切り捨て、切り上げ、四捨五入などを行うことによって、下位の桁が削除されて発生する[誤差](#誤差)。

### 打ち切り誤差

**打ち切り誤差**は、無限小数などの桁が無限に続く数を途中で打ち切ることによって発生する[誤差](#誤差)。

### オーバフロー

**オーバフロー**（**桁あふれ**）は、演算の結果が決められた桁数の中で表すことができる数値の範囲を超えることで発生する[誤差](#誤差)。例えば、1[バイト](../../../_/chapters/computer_and_number.md#バイト)の整数データであれば、表現できる範囲は $-128 \sim 127$ であるが、上限である $127$ を超える結果となるような演算を行うと発生する。

### アンダーフロー

**アンダーフロー**は、[浮動小数点数](./numeric_representation.md#浮動小数点数)の演算において、演算結果の[指数部](./numeric_representation.md#浮動小数点数)が小さくなりすぎることで数値を表現できなくなるような[誤差](#誤差)。[浮動小数点数](./numeric_representation.md#浮動小数点数)の[指数部](./numeric_representation.md#浮動小数点数)で表現可能な範囲の最小値よりも小さくなった場合に発生する。


## 参考文献

- [角谷一成.令和05年 基本情報技術者合格教本.株式会社技術評論社, 2022, 575](https://gihyo.jp/book/2022/978-4-297-13164-7)
- [瀬戸美月.徹底攻略 応用情報技術者教科書 令和4年度.株式会社インプレス, 2021, 814](https://book.impress.co.jp/books/1121101057)
